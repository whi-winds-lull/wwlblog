{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-]","pipeline":["stemmer"]},"docs":[{"location":"bigdata/FLINK%E7%9B%91%E6%8E%A7/","title":"FLINK\u200b\u76d1\u63a7","text":"<p>flink\u200b\u76d1\u63a7\u200b\u501f\u52a9\u200b\u7ec4\u4ef6\u200b<code>pushgateway</code>\u3001<code>Pushgateway</code>\u3001<code>Grafana</code>\u200b\u5b8c\u6210\u200b</p>"},{"location":"bigdata/FLINK%E7%9B%91%E6%8E%A7/#1flink","title":"1\u3001\u200b\u914d\u7f6e\u200bflink\u200b\u4efb\u52a1","text":"<p>\u200b\u5176\u4e2d\u200bflink-conf.yaml\u200b\u6587\u4ef6\u5939\u200b\u6dfb\u52a0\u200b\u4ee5\u4e0b\u200b\u914d\u7f6e\u200b:</p> <pre><code>##### \u200b\u4e0e\u200bPrometheus\u200b\u96c6\u6210\u200b\u914d\u7f6e\u200b #####\nmetrics.reporter.promgateway.class: org.apache.flink.metrics.prometheus.PrometheusPushGatewayReporter\nmetrics.reporter.promgateway.host: xxx\nmetrics.reporter.promgateway.port: 9091\nmetrics.reporter.promgateway.jobName: flink-metrics\nmetrics.reporter.promgateway.randomJobNameSuffix: true\nmetrics.reporter.promgateway.deleteOnShutdown: true\nmetrics.reporter.promgateway.interval: 60 SECONDS\n</code></pre> <p>flink\u200b\u542f\u52a8\u200b\u53c2\u6570\u200b\u6dfb\u52a0\u200b\u4ee5\u4e0b\u200b\u51e0\u4e2a\u200b\u53c2\u6570\u200b\uff1a</p> <pre><code>-yD metrics.reporter.promgateway.groupingKey=\"jobname=your job name\" \n-yD metrics.reporter.promgateway.jobName=your job name\n</code></pre> <p>\u200b\u5728\u200bgrafana  dashboards\u200b\u4e2d\u200b\u5c31\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u76f8\u5e94\u200b\u7684\u200bflink\u200b\u4efb\u52a1\u200b</p>"},{"location":"bigdata/FLINK%E7%9B%91%E6%8E%A7/#2","title":"2\u3001\u200b\u914d\u7f6e\u200b\u76d1\u63a7\u200b\u9884\u8b66","text":"<p>\u200b\u5728\u200bgrafana-Alterting\u200b\u4e2d\u200b\u53ef\u4ee5\u200b\u914d\u7f6e\u200b\u9884\u8b66\u200b\u6a21\u677f\u200b\u548c\u200b\u89e6\u53d1\u200b\u9884\u8b66\u200b\u7684\u200b\u6761\u4ef6\u200b\u3002</p> <p>\u200b\u9884\u8b66\u200b\u6a21\u677f\u200b\u914d\u7f6e\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>{{ define \"wechat.default.title\" -}}{{ if gt (len .Alerts.Firing) 0 -}}&lt;font color=\"warning\"&gt;Grafana\u200b\u544a\u8b66\u200b:&lt;/font&gt;{{- end }}{{ if gt (len .Alerts.Resolved) 0 -}}&lt;font color=\"info\"&gt;Grafana\u200b\u544a\u8b66\u200b\u89e3\u9664\u200b:&lt;/font&gt;{{- end }}{{- end }}\n{{ define \"wechat.default.message\" }}{{ if gt (len .Alerts.Firing) 0 -}}{{- range .Alerts -}}&gt;\u200b\u89e6\u53d1\u200b\u8b66\u62a5\u200b: &lt;font color=\"comment\"&gt;{{ .Labels.alertname }}&lt;/font&gt;\n  &gt;\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b: &lt;font color=\"warning\"&gt;{{ .Status }}&lt;/font&gt;\n  &gt;\u200b\u89e6\u53d1\u200b\u65f6\u95f4\u200b: &lt;font color=\"comment\"&gt;{{ .StartsAt.Format \"2006-01-02 15:04:05\" }}&lt;/font&gt;\n  &gt;\u200b\u8b66\u62a5\u200b\u94fe\u63a5\u200b: &lt;font color=\"comment\"&gt;{{ .GeneratorURL }}&lt;/font&gt;\n  &gt;\u200b\u4e8b\u4ef6\u200b\u4fe1\u606f\u200b: {{ range .Annotations.SortedPairs }}\n  {{ .Name }}: {{ .Value }}{{- end }}{{- end }}{{- end }}{{ if gt (len .Alerts.Resolved) 0 -}}{{- range .Alerts -}}&gt;\u200b\u89e6\u53d1\u200b\u8b66\u62a5\u200b: &lt;font color=\"comment\"&gt;{{ .Labels.alertname }}&lt;/font&gt;\n  &gt;\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b: &lt;font color=\"info\"&gt;{{ .Status }}&lt;/font&gt;\n  &gt;\u200b\u89e6\u53d1\u200b\u65f6\u95f4\u200b: &lt;font color=\"comment\"&gt;{{ .StartsAt.Format \"2006-01-02 15:04:05\" }}&lt;/font&gt;\n  &gt;\u200b\u6062\u590d\u200b\u65f6\u95f4\u200b: &lt;font color=\"comment\"&gt;{{ .EndsAt.Format \"2006-01-02 15:04:05\" }}&lt;/font&gt;\n  &gt;\u200b\u4e8b\u4ef6\u200b\u4fe1\u606f\u200b: {{ range .Annotations.SortedPairs }}\n  {{ .Name }}: {{ .Value }}{{- end }} {{- end }}{{- end }}{{- end }}\n</code></pre> <p>\u200b\u5982\u9700\u200b\u6dfb\u52a0\u200b\u989d\u5916\u200b\u4e8b\u4ef6\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200bGo templating language</p> <p>\u200b\u89e6\u53d1\u200b\u9884\u8b66\u200b\u7684\u200b\u6761\u4ef6\u200b\u53ef\u4ee5\u200b\u5728\u200bflink dashboards\u200b\u70b9\u51fb\u200b\u4f60\u200b\u60f3\u200b\u76d1\u63a7\u200b\u7684\u200b\u4e8b\u4ef6\u200b\u56fe\u8868\u200b\uff0c\u200b\u70b9\u51fb\u200bEdit\uff0c\u200b\u5728\u200bAlert\u200b\u521b\u5efa\u200b\u65b0\u200b\u7684\u200brule</p> <p>\u200b\u9009\u62e9\u200b\u60f3\u8981\u200b\u89e6\u53d1\u200b\u7684\u200b\u6307\u6807\u200b\u548c\u200b\u89e6\u53d1\u200b\u65f6\u95f4\u200b\uff0c\u200b\u70b9\u51fb\u200b\u4fdd\u5b58\u200b\u5373\u53ef\u200b\u3002</p>"},{"location":"bigdata/Hudi%E5%90%88%E5%B9%B6%E5%B0%8F%E6%96%87%E4%BB%B6%E6%96%B9%E6%A1%88/","title":"Hudi\u200b\u5408\u5e76\u200b\u5c0f\u200b\u6587\u4ef6\u200b\u65b9\u6848","text":""},{"location":"bigdata/Hudi%E5%90%88%E5%B9%B6%E5%B0%8F%E6%96%87%E4%BB%B6%E6%96%B9%E6%A1%88/#1","title":"1.\u200b\u80cc\u666f","text":"<p>\u200b\u4f7f\u7528\u200bflink\u200b\u5199\u5165\u200b\u65e5\u5fd7\u200b\u6570\u636e\u200b\u65f6\u200b\uff0c\u200b\u4f7f\u7528\u200b\u201cinsert\u201d\u200b\u6a21\u5f0f\u200b\u548c\u200b\u201cCOPY_ON_WRITE\u201d\u200b\u5199\u5165\u200bHudi\u200b\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u66f4\u52a0\u200b\u201cwrite.tasks\u201d\u200b\u53c2\u6570\u200b\u914d\u7f6e\u200b\u7684\u200b\u4e2a\u6570\u200b\uff0c\u200b\u4ea7\u751f\u200b\u5c0f\u200b\u6587\u4ef6\u200b\uff0c\u200b\u6309\u7167\u200b\u5199\u5165\u200b\u914d\u7f6e\u200b1\u200b\u5206\u949f\u200b\u5199\u5165\u200b\u4e00\u6b21\u200b\u201cwrite.tasks\u201d=8\uff0c\u200b\u4e00\u5929\u200b\u4f1a\u200b\u4ea7\u751f\u200b11520\u200b\u4e2a\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4e25\u91cd\u200b\u5f71\u54cd\u200b\u4e86\u200b\u8868\u200b\u7684\u200b\u67e5\u8be2\u200b\u901f\u5ea6\u200b\u3002</p>"},{"location":"bigdata/Hudi%E5%90%88%E5%B9%B6%E5%B0%8F%E6%96%87%E4%BB%B6%E6%96%B9%E6%A1%88/#2","title":"2.\u200b\u89e3\u51b3\u65b9\u6848","text":"<p>Hudi0.13\u200b\u7248\u672c\u200b\u53d1\u5e03\u200b\u4e86\u200bflink\u200b\u5199\u5165\u200bHudi\u200b\u5f02\u6b65\u200b\u5408\u5e76\u200b\u5c0f\u200b\u6587\u4ef6\u200b\u7684\u200b\u529f\u80fd\u200b\uff0c\u200b\u914d\u7f6e\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>'clustering.schedule.enabled'='true' ,\n'clustering.async.enabled'='true' ,\n'clustering.plan.partition.filter.mode'= 'RECENT_DAYS' ,\n'clustering.plan.strategy.daybased.lookback.partitions'='1' ,\n'hoodie.clustering.plan.strategy.small.file.limit'='629145600',\n'hoodie.clustering.plan.strategy.target.file.max.bytes'='1073741824',\n'clustering.delta_commits' = '15'\n</code></pre> <p>\u200b\u901a\u8fc7\u200b'clustering.schedule.enabled'='true' ,'clustering.async.enabled'='true' ,\u200b\u5f00\u542f\u200b\u5f02\u6b65\u200b\u521b\u5efa\u200b\u5408\u5e76\u200b\u8ba1\u5212\u200b\u548c\u200b\u6267\u884c\u200b\u8ba1\u5212\u200b\uff0cclustering.plan.partition.filter.mode\u200b\u548c\u200bclustering.plan.strategy.daybased.lookback.partitions\u200b\u53c2\u6570\u8bbe\u7f6e\u200b\u4ec5\u200b\u5408\u5e76\u200b\u5f53\u5929\u200b\u7684\u200b\u5206\u533a\u200b\u6587\u4ef6\u200b\uff0c'hoodie.clustering.plan.strategy.small.file.limit'\u200b\u914d\u7f6e\u200b\u5c0f\u200b\u6587\u4ef6\u200b\u4e3a\u200b600M\uff0c\u200b\u5f53\u200b\u6587\u4ef6\u200b\u5c0f\u4e8e\u200b600M\u200b\u5c31\u200b\u4f1a\u200b\u88ab\u200b\u521b\u5efa\u200b\u5230\u200b\u5408\u5e76\u200b\u8ba1\u5212\u200b\u91cc\u200b\uff0c'hoodie.clustering.plan.strategy.target.file.max.bytes'\u200b\u53c2\u6570\u8bbe\u7f6e\u200b\u4e3a\u200b\u5408\u5e76\u200b\u540e\u200b\u6700\u5927\u200b\u6587\u4ef6\u5927\u5c0f\u200b\u4e3a\u200b1GB\uff0c'clustering.delta_commits'\u200b\u8bbe\u7f6e\u200b15\u200b\u6b21\u200b\u63d0\u4ea4\u200b\u5408\u5e76\u200b\u4e00\u6b21\u200b\u3002</p> <p>\u200b\u901a\u8fc7\u200b\u4ee5\u4e0a\u200b\u914d\u7f6e\u200b\u53ef\u4ee5\u200b\u5b8c\u6210\u200b\u5355\u8868\u200b\u5199\u5165\u200b\u5e76\u200b\u8fdb\u884c\u200b\u5c0f\u200b\u6587\u4ef6\u200b\u5408\u5e76\u200b\uff0c\u200b\u4f46\u662f\u200b\u5f53\u591a\u200b\u5199\u200b\uff08flink\u200b\u6d88\u8d39\u200bkafka\u3001flink\u200b\u6d88\u8d39\u200bsls\uff09\u200b\u540c\u4e00\u4e2a\u200b\u8868\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u53d1\u751f\u200b\u62a5\u9519\u200b\uff0c\u200b\u50cf\u200bHudi\u200b\u63d0\u4ea4\u200b\u4e86\u200bissue\uff0c\u200b\u5b98\u65b9\u200b\u544a\u77e5\u200b\u6b64\u200bBUG\u200b\u5c06\u200b\u7531\u200b0.14\u200b\u7248\u672c\u200b\u8fdb\u884c\u200b\u4fee\u590d\u200b\u3002 </p> <p>\u200b\u6240\u4ee5\u200b\uff0c\u200b\u76ee\u524d\u200b\u5408\u5e76\u200b\u5c0f\u200b\u6587\u4ef6\u200b\u65b9\u6848\u200b\u4e3a\u200b\u5355\u8868\u200b\u5199\u5165\u200b+\u200b\u5728\u7ebf\u200b\u5408\u5e76\u200b\u3002</p>"},{"location":"bigdata/Linux%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85Python3%E7%8E%AF%E5%A2%83/","title":"[Linux\u200b\u7cfb\u7edf\u200b\u5b89\u88c5\u200b\u9ad8\u200b\u7248\u672c\u200bPython3","text":"<pre><code>1. \u200b\u8fdb\u5165\u200bhttps://www.python.org/downloads/source/\u200b\u4e0b\u8f7d\u200b\u76f8\u5e94\u200b\u7248\u672c\u200b\n</code></pre> <pre><code># \u200b\u5b89\u88c5\u200b\u4f9d\u8d56\u200b\u73af\u5883\u200b\nyum -y install gcc\n\nyum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel libffi-devel openssl libuuid-devel\n\n# \u200b\u89e3\u538b\u200b\u538b\u7f29\u5305\u200b\ntar xvf Python-3.7.3.tar.xz\n\n# \u200b\u7f16\u8bd1\u200b\n./configure --prefix=/usr/local/python3.7\n make &amp;&amp; make install \n\n # \u200b\u65e7\u200b\u7684\u200bpython3.6\u200b\u8f6f\u200b\u8fde\u63a5\u200b\npython3 -&gt; /etc/alternatives/python3\npip3 -&gt; /etc/alternatives/pip3\n # \u200b\u5220\u9664\u200b\u65e7\u200b\u7684\u200b\u8f6f\u200b\u8fde\u63a5\u200b\n rm -rf python3\n rm -rf pip3\n # \u200b\u5efa\u7acb\u200b\u65b0\u200b\u7684\u200b\u8f6f\u200b\u94fe\u63a5\u200b\n ln -s /usr/local/python3.7/bin/python3 /usr/bin/python3\n ln -s /usr/local/python3.7/bin/pip3 /usr/bin/pip3\n</code></pre>"},{"location":"bigdata/SSH%E5%85%8D%E5%AF%86/","title":"SSH\u200b\u514d\u5bc6","text":""},{"location":"bigdata/SSH%E5%85%8D%E5%AF%86/#ssh","title":"SSH\u200b\u514d\u5bc6\u200b\u65b9\u6cd5","text":"<pre><code>ssh-keygen -t rsa (\u200b\u8fde\u7eed\u200b\u56de\u8f66\u200b,\u200b\u5373\u200b\u5728\u200b\u672c\u5730\u200b\u751f\u6210\u200b\u4e86\u200b\u516c\u94a5\u200b\u548c\u200b\u79c1\u94a5\u200b,\u200b\u4e0d\u200b\u8bbe\u7f6e\u200b\u5bc6\u7801\u200b)\n\n\u200b\u76f4\u63a5\u200b\u767b\u5f55\u200b\u5230\u200b\u670d\u52a1\u5668\u200b\u4f7f\u7528\u200b\u547d\u4ee4\u200bcat ~/.ssh/id_rsa.pub\u200b\u67e5\u770b\u200b\u5185\u5bb9\u200b(\u200b\u516c\u94a5\u200b)\uff0c\u200b\u5c06\u200b\u5185\u5bb9\u200b\u590d\u5236\u200b \u200b\u8ffd\u52a0\u200b\u5230\u200b\u4e3b\u673a\u200bB\u3001C\u200b\u7684\u200b\u6587\u4ef6\u200b~/.ssh/authorized_keys\u200b\u4e2d\u200b\uff08 \u200b\u8bf7\u200b\u6ce8\u610f\u200b\u4e0d\u8981\u200b\u5220\u9664\u200b\u6216\u200b\u8986\u76d6\u200b\u8be5\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u5df2\u6709\u200b\u7684\u200b\u5185\u5bb9\u200b\uff09\n</code></pre> <p>\u200b\u6ce8\u610f\u4e8b\u9879\u200b\uff1a</p> <pre><code>\u200b\u62a5\u9519\u200b\uff1a\nRSA host key for [ip] has changed and you have requested strict checking.\nHost key verification failed.\n\nWarning: the ECDSA host key for 'datalab' differs from the key for the IP address '192.168.0.40'\n\n\u200b\u89e3\u51b3\u529e\u6cd5\u200b\u662f\u200b\u5728\u200b\u4e3b\u673a\u200bA\u200b\u8fd0\u884c\u200b\uff1a\nssh-keygen -R BHostIP\n\u200b\u539f\u56e0\u200b\u662f\u200b\uff1a\n\u200b\u6bd4\u5982\u200b\u4e3b\u673a\u200bA\u200b\u548c\u200b\u4e3b\u673a\u200bB\uff0c\u200b\u7528\u6237\u200b\u4e4b\u524d\u200b\u5728\u200b\u4e3b\u673a\u200bA\u200b\u4e0a\u200b\u4f7f\u7528\u200bssh\u200b\u547d\u4ee4\u200b\u767b\u5f55\u200b\u8fc7\u200b\u4e3b\u673a\u200bB\uff0c\u200b\u800c\u540e\u200b\u4e3b\u673a\u200bB\u200b\u88ab\u200b\u91cd\u88c5\u200b\u4f46\u200b\u4fdd\u7559\u200b\u4e86\u200b\u4e3b\u673a\u200bB\u200b\u7684\u200bIP\u3002\u200b\u4e4b\u540e\u200b\u7528\u6237\u200b\u5728\u200b\u4e3b\u673a\u200bA\u200b\u4e0a\u200b\u518d\u200bssh\u200b\u7ee7\u7eed\u200b\u767b\u5f55\u200b\u4e3b\u673a\u200bB\u200b\u65f6\u200b\uff0c\u200b\u5c31\u4f1a\u62a5\u200b\u8fd9\u4e2a\u200b\u9519\u8bef\u200b\u3002\n</code></pre>"},{"location":"bigdata/clickhouse/","title":"clickhouse\u200b\u6307\u5357","text":""},{"location":"bigdata/clickhouse/#join","title":"join\u200b\u4f18\u5316","text":"<p>\u200b\u5728\u200b ClickHouse \u200b\u4e2d\u200b\uff0c\u200b\u5206\u5e03\u5f0f\u200b\u8868\u200b\uff08Distributed Tables\uff09\u200b\u662f\u200b\u7528\u4e8e\u200b\u5206\u5e03\u5f0f\u200b\u96c6\u7fa4\u200b\u4e2d\u200b\u7684\u200b\u4e00\u79cd\u200b\u8868\u200b\u7c7b\u578b\u200b\uff0c\u200b\u5b83\u200b\u5c06\u200b\u6570\u636e\u5206\u5e03\u200b\u5728\u200b\u591a\u4e2a\u200b\u8282\u70b9\u200b\u4e0a\u200b\u3002\u200b\u5f53\u200b\u4f60\u200b\u9700\u8981\u200b\u5728\u200b\u5206\u5e03\u5f0f\u200b\u8868\u200b\u4e4b\u95f4\u200b\u8fdb\u884c\u200b JOIN \u200b\u64cd\u4f5c\u200b\u65f6\u200b\uff0c\u200b\u4e3a\u4e86\u200b\u83b7\u5f97\u6700\u4f73\u200b\u6027\u80fd\u200b\uff0c\u200b\u5fc5\u987b\u200b\u8003\u8651\u200b\u6570\u636e\u200b\u7684\u200b\u5206\u5e03\u200b\u65b9\u5f0f\u200b\u3001\u200b\u5206\u7247\u200b\u952e\u200b\u3001\u200b\u67e5\u8be2\u200b\u4f18\u5316\u200b\u7b49\u200b\u591a\u4e2a\u200b\u56e0\u7d20\u200b  </p>"},{"location":"bigdata/clickhouse/#global-join","title":"\u4f7f\u7528\u200b GLOBAL \u200b\u5173\u952e\u5b57\u200b\u8fdb\u884c\u200b\u8de8\u200b\u8282\u70b9\u200b JOIN","text":"<p>\u200b\u5f53\u200b\u4e24\u4e2a\u200b\u8868\u200b\u7684\u200b\u5206\u5e03\u200b\u952e\u200b\u4e0d\u540c\u200b\uff0c\u200b\u6216\u8005\u200b\u4e00\u4e2a\u200b\u8868\u200b\u7684\u200b\u5927\u5c0f\u200b\u76f8\u5bf9\u200b\u8f83\u200b\u5c0f\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b GLOBAL \u200b\u5173\u952e\u5b57\u200b\u6765\u200b\u4f18\u5316\u200b JOIN \u200b\u64cd\u4f5c\u200b\u3002</p>"},{"location":"bigdata/clickhouse/#global-join_1","title":"GLOBAL JOIN","text":"<p>\u200b\u5f53\u200b JOIN \u200b\u7684\u200b\u4e00\u4e2a\u200b\u8868\u200b\u76f8\u5bf9\u200b\u8f83\u200b\u5c0f\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b GLOBAL \u200b\u5173\u952e\u5b57\u200b\u5c06\u200b\u5c0f\u8868\u200b\u5e7f\u64ad\u200b\u5230\u200b\u6240\u6709\u200b\u8282\u70b9\u200b\u4e0a\u200b\uff0c\u200b\u4ee5\u200b\u51cf\u5c11\u200b\u8de8\u200b\u8282\u70b9\u200b\u7684\u200b JOIN \u200b\u64cd\u4f5c\u200b\u3002GLOBAL \u200b\u4f1a\u200b\u5f3a\u5236\u200b\u5c06\u200b\u5c0f\u8868\u200b\u7684\u200b\u6570\u636e\u200b\u590d\u5236\u5230\u200b\u6bcf\u4e2a\u200b\u5206\u7247\u200b\u4e0a\u200b\uff0c\u200b\u4ece\u800c\u200b\u5728\u200b\u672c\u5730\u200b\u5b8c\u6210\u200b JOIN\u3002 <pre><code>SELECT ...\nFROM orders_distributed AS o\nJOIN GLOBAL customers_distributed AS c ON o.customer_id = c.customer_id\n</code></pre> \u200b\u8fd9\u79cd\u200b\u65b9\u5f0f\u200b\u5728\u200b\u5c0f\u8868\u200b\u548c\u200b\u5927\u8868\u200b JOIN \u200b\u65f6\u200b\u975e\u5e38\u200b\u6709\u6548\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u663e\u8457\u200b\u51cf\u5c11\u200b\u6570\u636e\u4f20\u8f93\u200b\u91cf\u200b\u3002  </p>"},{"location":"bigdata/clickhouse/#join_1","title":"\u4f7f\u7528\u200b JOIN \u200b\u5173\u952e\u5b57\u200b\u7684\u200b\u4f18\u5316","text":"<p>\u200b\u5728\u200b ClickHouse \u200b\u4e2d\u200b\uff0cJOIN \u200b\u7684\u200b\u9ed8\u8ba4\u200b\u65b9\u5f0f\u200b\u4f1a\u200b\u5728\u200b\u6267\u884c\u200b\u524d\u200b\u5c06\u200b\u6574\u4e2a\u200b\u8868\u200b\u52a0\u8f7d\u200b\u5230\u200b\u5185\u5b58\u200b\u4e2d\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u5927\u8868\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u5185\u5b58\u200b\u6d88\u8017\u200b\u8fc7\u9ad8\u200b\u3002\u200b\u901a\u8fc7\u200b\u6307\u5b9a\u200b\u5408\u9002\u200b\u7684\u200b JOIN \u200b\u7c7b\u578b\u200b\u548c\u200b\u4f18\u5316\u200b\u53c2\u6570\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u6539\u5584\u200b\u6027\u80fd\u200b\u3002 - ANY JOIN: \u200b\u5bf9\u4e8e\u200b JOIN \u200b\u7684\u200b\u8868\u200b\uff0c\u200b\u5982\u679c\u200b\u786e\u5b9a\u200b\u53f3\u8868\u200b\u53ea\u6709\u200b\u4e00\u6761\u200b\u5339\u914d\u200b\u8bb0\u5f55\u200b\uff0c\u200b\u4f7f\u7528\u200b ANY JOIN \u200b\u53ef\u4ee5\u200b\u8282\u7701\u200b\u5185\u5b58\u200b\u3002 <pre><code>SELECT ...\nFROM orders_distributed AS o\nANY LEFT JOIN customers_distributed AS c ON o.customer_id = c.customer_id\n</code></pre> - ALL JOIN: \u200b\u5728\u200b\u9700\u8981\u200b\u5339\u914d\u200b\u591a\u6761\u200b\u8bb0\u5f55\u200b\u7684\u200b\u573a\u666f\u200b\u4e0b\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b ALL JOIN\u3002\u200b\u8fd9\u4f1a\u200b\u4fdd\u7559\u200b\u6240\u6709\u200b\u5339\u914d\u200b\u7684\u200b\u884c\u200b\u3002 - SEMI JOIN: \u200b\u5982\u679c\u200b\u4f60\u200b\u53ea\u200b\u5173\u5fc3\u200b\u662f\u5426\u200b\u5b58\u5728\u200b\u5339\u914d\u200b\u9879\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b SEMI JOIN\u3002 <pre><code>SELECT ...\nFROM orders_distributed AS o\nSEMI LEFT JOIN customers_distributed AS c ON o.customer_id = c.customer_id\n</code></pre> - max_bytes_before_external_join\u200b\u53c2\u6570\u200b\uff1a\u200b\u5982\u679c\u200b JOIN \u200b\u64cd\u4f5c\u200b\u7684\u200b\u6570\u636e\u200b\u91cf\u8fc7\u5927\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u8bbe\u7f6e\u200b max_bytes_before_external_join \u200b\u53c2\u6570\u200b\u5c06\u200b\u90e8\u5206\u200b\u6570\u636e\u200b\u5199\u5165\u200b\u78c1\u76d8\u200b\uff0c\u200b\u907f\u514d\u200b\u5185\u5b58\u4e0d\u8db3\u200b\u3002 <pre><code>SET max_bytes_before_external_join = '1G';\n</code></pre></p>"},{"location":"bigdata/clickhouse/#colocate-join","title":"Colocate JOIN","text":"<p>ClickHouse \u200b\u4e2d\u200b\u7684\u200b Colocate JOIN \u200b\u662f\u200b\u4e00\u79cd\u200b\u4f18\u5316\u200b\u5206\u5e03\u5f0f\u200b\u8868\u200b JOIN \u200b\u64cd\u4f5c\u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002\u200b\u5f53\u200b\u4e24\u4e2a\u200b\u5206\u5e03\u5f0f\u200b\u8868\u200b\u4f7f\u7528\u200b\u76f8\u540c\u200b\u7684\u200b\u5206\u5e03\u200b\u952e\u200b\u548c\u200b\u5206\u7247\u200b\u7b56\u7565\u200b\u65f6\u200b\uff0cClickHouse \u200b\u53ef\u4ee5\u200b\u5728\u200b\u540c\u4e00\u4e2a\u200b\u5206\u7247\u200b\u5185\u200b\u8fdb\u884c\u200b JOIN \u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4ece\u800c\u200b\u907f\u514d\u200b\u8de8\u200b\u5206\u7247\u200b\u7684\u200b\u6570\u636e\u4f20\u8f93\u200b\u3002\u200b\u8fd9\u79cd\u200b\u65b9\u5f0f\u200b\u79f0\u4e3a\u200b Colocate JOIN\u3002</p>"},{"location":"bigdata/clickhouse/#colocate-join_1","title":"\u4f7f\u7528\u200b Colocate JOIN \u200b\u7684\u200b\u6761\u4ef6","text":"<p>\u200b\u4e3a\u4e86\u200b\u4f7f\u7528\u200b Colocate JOIN\uff0c\u200b\u9700\u8981\u200b\u6ee1\u8db3\u200b\u4ee5\u4e0b\u200b\u6761\u4ef6\u200b\uff1a 1. \u200b\u76f8\u540c\u200b\u7684\u200b\u5206\u5e03\u200b\u952e\u200b\uff1a\u200b\u4e24\u4e2a\u200b\u53c2\u4e0e\u200b JOIN \u200b\u64cd\u4f5c\u200b\u7684\u200b\u5206\u5e03\u5f0f\u200b\u8868\u200b\u5fc5\u987b\u200b\u4f7f\u7528\u200b\u76f8\u540c\u200b\u7684\u200b\u5206\u5e03\u200b\u952e\u200b\uff08\u200b\u5373\u200b sharding key\uff09\u3002</p> <ol> <li> <p>\u200b\u76f8\u540c\u200b\u7684\u200b\u5206\u7247\u200b\u6570\u91cf\u200b\uff1a\u200b\u4e24\u4e2a\u200b\u8868\u200b\u7684\u200b\u5206\u7247\u200b\u6570\u91cf\u200b\u5fc5\u987b\u200b\u76f8\u540c\u200b\uff0c\u200b\u8fd9\u6837\u200b\u53ef\u4ee5\u200b\u4fdd\u8bc1\u200b\u76f8\u540c\u200b\u7684\u200b\u5206\u7247\u200b\u952e\u503c\u200b\u5bf9\u4f1a\u843d\u200b\u5728\u200b\u76f8\u540c\u200b\u7684\u200b\u5206\u7247\u200b\u4e0a\u200b\u3002</p> </li> <li> <p>\u200b\u76f8\u540c\u200b\u7684\u200b\u5206\u5e03\u200b\u7b56\u7565\u200b\uff1a\u200b\u4e24\u4e2a\u200b\u8868\u200b\u7684\u200b\u5206\u7247\u200b\u7b56\u7565\u200b\uff08\u200b\u5982\u200b\u5206\u5e03\u200b\u51fd\u6570\u200b\u3001\u200b\u5206\u7247\u200b\u903b\u8f91\u200b\u7b49\u200b\uff09\u200b\u5fc5\u987b\u200b\u4e00\u81f4\u200b\u3002</p> </li> </ol>"},{"location":"bigdata/clickhouse/#colocate-join_2","title":"Colocate JOIN \u200b\u7684\u200b\u4f18\u70b9","text":"<ul> <li>\u200b\u51cf\u5c11\u200b\u6570\u636e\u4f20\u8f93\u200b\uff1a\u200b\u56e0\u4e3a\u200b Colocate JOIN \u200b\u4fdd\u8bc1\u200b\u4e86\u200b\u5728\u200b\u540c\u4e00\u200b\u5206\u7247\u200b\u5185\u200b\u5b8c\u6210\u200b JOIN \u200b\u64cd\u4f5c\u200b\uff0c\u200b\u6240\u4ee5\u200b\u907f\u514d\u200b\u4e86\u200b\u5206\u7247\u200b\u4e4b\u95f4\u200b\u7684\u200b\u6570\u636e\u4f20\u8f93\u200b\uff0c\u200b\u964d\u4f4e\u200b\u4e86\u200b\u7f51\u7edc\u200b\u5f00\u9500\u200b\u3002</li> <li>\u200b\u63d0\u9ad8\u200b\u67e5\u8be2\u200b\u6027\u80fd\u200b: \u200b\u901a\u8fc7\u200b\u51cf\u5c11\u200b\u8de8\u200b\u5206\u7247\u200b\u7684\u200b\u6570\u636e\u4f20\u8f93\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u663e\u8457\u200b\u63d0\u9ad8\u200b\u67e5\u8be2\u200b\u7684\u200b\u6027\u80fd\u200b\uff0c\u200b\u7279\u522b\u200b\u662f\u200b\u5728\u200b\u5927\u89c4\u6a21\u200b\u6570\u636e\u200b\u96c6\u200b\u7684\u200b\u573a\u666f\u200b\u4e0b\u200b\u3002</li> </ul>"},{"location":"bigdata/clickhouse/#colocate-join_3","title":"\u5982\u4f55\u200b\u5b9e\u73b0\u200b Colocate JOIN","text":"<p>\u200b\u8981\u200b\u5b9e\u73b0\u200b Colocate JOIN\uff0c\u200b\u53ea\u200b\u9700\u200b\u786e\u4fdd\u200b\u4e24\u4e2a\u200b\u5206\u5e03\u5f0f\u200b\u8868\u200b\u6ee1\u8db3\u200b\u4e0a\u8ff0\u200b\u6761\u4ef6\u200b\u3002ClickHouse \u200b\u4f1a\u200b\u81ea\u52a8\u68c0\u6d4b\u200b\u8fd9\u4e9b\u200b\u6761\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u53ef\u80fd\u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u6267\u884c\u200b Colocate JOIN\u3002</p>"},{"location":"bigdata/clickhouse/#_1","title":"\u521b\u5efa\u200b\u5206\u5e03\u5f0f\u200b\u8868\u200b\u7684\u200b\u793a\u4f8b\u200b\uff1a","text":"<p>\u200b\u5047\u8bbe\u200b\u6709\u200b\u4e24\u4e2a\u200b\u8868\u200b orders \u200b\u548c\u200b customers\uff0c\u200b\u6211\u4eec\u200b\u5e0c\u671b\u200b\u5728\u200b customer_id \u200b\u4e0a\u200b\u8fdb\u884c\u200b JOIN \u200b\u64cd\u4f5c\u200b\u3002 <pre><code>CREATE TABLE orders_local ON CLUSTER 'cluster_name' (\n    order_id UInt32,\n    customer_id UInt32,\n    order_amount Float32,\n    order_date Date\n) ENGINE = MergeTree()\nORDER BY order_id\nPARTITION BY toYYYYMM(order_date);\n\nCREATE TABLE customers_local ON CLUSTER 'cluster_name' (\n    customer_id UInt32,\n    customer_name String,\n    customer_address String\n) ENGINE = MergeTree()\nORDER BY customer_id;\n\n-- \u200b\u521b\u5efa\u200b\u5206\u5e03\u5f0f\u200b\u8868\u200b\uff0c\u200b\u4f7f\u7528\u200b\u76f8\u540c\u200b\u7684\u200b\u5206\u7247\u200b\u952e\u200b\u548c\u200b\u5206\u7247\u200b\u6570\u91cf\u200b\nCREATE TABLE orders_distributed ON CLUSTER 'cluster_name' AS orders_local\nENGINE = Distributed('cluster_name', 'db_name', 'orders_local', customer_id);\n\nCREATE TABLE customers_distributed ON CLUSTER 'cluster_name' AS customers_local\nENGINE = Distributed('cluster_name', 'db_name', 'customers_local', customer_id);\n\nSELECT \n    o.order_id,\n    o.order_date,\n    o.order_amount,\n    c.customer_name,\n    c.customer_address\nFROM \n    orders_distributed AS o\nJOIN \n    customers_local AS c\nON \n    o.customer_id = c.customer_id;\n</code></pre></p>"},{"location":"bigdata/curl%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/","title":"Curl\u200b\u6e90\u7801\u200b\u5b89\u88c5\u200b\u62a5\u9519\u200b\u89e3\u51b3","text":""},{"location":"bigdata/curl%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/#curl","title":"curl\u200b\u6e90\u7801\u200b\u5b89\u88c5\u200b\u62a5\u9519\u200b\u89e3\u51b3\u65b9\u6848","text":""},{"location":"bigdata/curl%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/#_1","title":"\u80cc\u666f","text":"<p>\u200b\u670d\u52a1\u5668\u200b\u7248\u672c\u200b\uff1aCentOS Linux release 8.1.1911 (Core) </p> <p>\u200b\u4f7f\u7528\u200bcurl\u200b\u62a5\u9519\u200b\uff0c\u200b\u5e76\u4e14\u200b\u6e90\u7801\u200b\u5b89\u88c5\u200b\u62a5\u9519\u200b\uff0c\u200b\u7ecf\u200b\u67e5\u8be2\u200b\u548c\u200bopenssl\u200b\u7248\u672c\u200b\u6709\u5173\u200b\uff0c\u200b\u4ee5\u4e0b\u200b\u662f\u200b\u89e3\u51b3\u529e\u6cd5\u200b\u3002</p>"},{"location":"bigdata/curl%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/#curl-761","title":"curl 7.61","text":"<pre><code># \u200b\u5148\u200b\u5378\u8f7d\u200bcurl\nrpm -q curl\nrpm -e --nodeps curl-7.61.1-22.el8.x86_64\n\n# \u200b\u4e0b\u8f7d\u200bcurl 7.61tar\u200b\u5305\u200b,\u200b\u89e3\u538b\u200b\ntar -zxvf curl-7.61.1.tar.gz\ncd curl-7.61.1\n\n# \u200b\u4e0b\u8f7d\u200bopenssl \u200b\u65e7\u7248\u672c\u200bopenssl-1.0.2k.tar.gz\n# \u200b\u89e3\u538b\u200b\u7f16\u8bd1\u200b\uff0c\u200b\u4f4d\u7f6e\u200b\u653e\u5728\u200b\u4e86\u200b/tmp/ssl\n./config shared --prefix=/tmp/ssl\nmake\nmake install\n\n# \u200b\u7f16\u8bd1\u200bcurl,\u200b\u4e00\u5b9a\u200b\u8981\u52a0\u200b--with-ssl\u200b\u6307\u5b9a\u200b openssl-1.0.2k\u200b\u7684\u200b\u4f4d\u7f6e\u200b\n./configure --prefix=/usr/local  --with-ssl=/tmp/ssl\nmake\nmake install\n\n# \u200b\u67e5\u770b\u200b\u662f\u5426\u200b\u5b89\u88c5\u200b\u6210\u529f\u200b\ncurl --version\n</code></pre>"},{"location":"bigdata/es/","title":"es","text":""},{"location":"bigdata/es/#textkeyword","title":"\u7c7b\u578b\u200btext\u200b\u4e0e\u200bkeyword","text":"<p>text\u200b\u7c7b\u578b\u200b\u7684\u200b\u6570\u636e\u200b\u88ab\u200b\u7528\u6765\u200b\u7d22\u5f15\u200b\u957f\u200b\u6587\u672c\u200b\uff0c\u200b\u4f8b\u5982\u200b\u7535\u5b50\u90ae\u4ef6\u200b\u4e3b\u4f53\u200b\u90e8\u5206\u200b\u6216\u8005\u200b\u4e00\u6b3e\u200b\u4ea7\u54c1\u200b\u7684\u200b\u4ecb\u7ecd\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u6587\u672c\u200b\u4f1a\u200b\u88ab\u200b\u5206\u6790\u200b\uff0c\u200b\u5728\u200b\u5efa\u7acb\u200b\u7d22\u5f15\u200b\u6587\u6863\u200b\u4e4b\u524d\u200b\u4f1a\u200b\u88ab\u200b\u5206\u8bcd\u5668\u200b\u8fdb\u884c\u200b\u5206\u8bcd\u200b\uff0c\u200b\u8f6c\u5316\u200b\u4e3a\u200b\u8bcd\u7ec4\u200b\u3002\u200b\u7ecf\u8fc7\u200b\u5206\u8bcd\u200b\u673a\u5236\u200b\u4e4b\u540e\u200bes\u200b\u5141\u8bb8\u200b\u68c0\u7d22\u200b\u5230\u200b\u8be5\u200b\u6587\u672c\u200b\u5207\u5206\u200b\u800c\u6210\u200b\u7684\u200b\u8bcd\u8bed\u200b\uff0c\u200b\u4f46\u662f\u200btext\u200b\u7c7b\u578b\u200b\u7684\u200b\u6570\u636e\u200b\u4e0d\u80fd\u200b\u7528\u6765\u200b\u8fc7\u6ee4\u200b\u3001\u200b\u6392\u5e8f\u200b\u548c\u200b\u805a\u5408\u200b\u7b49\u200b\u64cd\u4f5c\u200b\u3002 keyword\u200b\u7c7b\u578b\u200b\u7684\u200b\u6570\u636e\u200b\u53ef\u4ee5\u200b\u6ee1\u8db3\u200b\u7535\u5b50\u200b\u90ae\u7bb1\u5730\u5740\u200b\u3001\u200b\u4e3b\u673a\u540d\u200b\u3001\u200b\u72b6\u6001\u200b\u7801\u200b\u3001\u200b\u90ae\u653f\u7f16\u7801\u200b\u548c\u200b\u6807\u7b7e\u200b\u7b49\u200b\u6570\u636e\u200b\u7684\u200b\u8981\u6c42\u200b\uff0c\u200b\u4e0d\u200b\u8fdb\u884c\u200b\u5206\u8bcd\u200b\uff0c\u200b\u5e38\u5e38\u200b\u88ab\u200b\u7528\u6765\u200b\u8fc7\u6ee4\u200b\u3001\u200b\u6392\u5e8f\u200b\u548c\u200b\u805a\u5408\u200b\u3002 \u200b\u603b\u7ed3\u200b\uff1akeyword\uff1a\u200b\u5b58\u50a8\u200b\u6570\u636e\u200b\u65f6\u5019\u200b\uff0c\u200b\u4e0d\u4f1a\u200b\u5206\u8bcd\u200b\u5efa\u7acb\u200b\u7d22\u5f15\u200b\uff0c     text\uff1a\u200b\u5b58\u50a8\u200b\u6570\u636e\u200b\u65f6\u5019\u200b\uff0c\u200b\u4f1a\u200b\u81ea\u52a8\u200b\u5206\u8bcd\u200b\uff0c\u200b\u5e76\u200b\u751f\u6210\u200b\u7d22\u5f15\u200b\u3002</p>"},{"location":"bigdata/es/#match","title":"match\u200b\u67e5\u8be2","text":"<p>\u200b\u7528\u4e8e\u200b\u5728\u200b\u6587\u672c\u200b\u5b57\u6bb5\u200b\u4e2d\u200b\u67e5\u627e\u200b\u5339\u914d\u200b\u7684\u200b\u8bcd\u8bed\u200b\u3002match\u200b\u67e5\u8be2\u200b\u4f1a\u200b\u5bf9\u200btext\u200b\u7c7b\u578b\u200b\u5b57\u200b\u6bb5\u200b\u8fdb\u884c\u200b\u5206\u8bcd\u200b <pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"match\": {\n      \"address\": \"\u200b\u5317\u4eac\u200b\"\n    }\n  }\n}\n</code></pre></p>"},{"location":"bigdata/es/#term","title":"term\u200b\u67e5\u8be2","text":"<p>\u200b\u7528\u4e8e\u200b\u7cbe\u786e\u200b\u5339\u914d\u200b\u5b57\u6bb5\u200b\u4e2d\u200b\u7684\u200b\u503c\u200b\u3002\u200b\u4e00\u822c\u200b\u7528\u4e8e\u200bkeyword <pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"term\": {\n      \"category1_new\": \"\u200b\u58eb\u591a\u200b\"\n    }\n  }\n}\n</code></pre></p>"},{"location":"bigdata/es/#bool","title":"bool\u200b\u67e5\u8be2","text":"<p>\u200b\u7528\u4e8e\u200b\u7ec4\u5408\u200b\u591a\u4e2a\u200b\u67e5\u8be2\u200b\u6761\u4ef6\u200b\uff0c\u200b\u652f\u6301\u200bmust\u3001should\u3001must_not\u200b\u7b49\u200b\u5173\u952e\u8bcd\u200b\u3002 must: \u200b\u6587\u6863\u200b\u5fc5\u987b\u200b\u5b8c\u5168\u200b\u5339\u914d\u200b\u6761\u4ef6\u200b should: should\u200b\u4e0b\u9762\u200b\u4f1a\u5e26\u200b\u4e00\u4e2a\u200b\u4ee5\u4e0a\u200b\u7684\u200b\u6761\u4ef6\u200b\uff0c\u200b\u81f3\u5c11\u200b\u6ee1\u8db3\u200b\u4e00\u4e2a\u200b\u6761\u4ef6\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u6587\u6863\u200b\u5c31\u200b\u7b26\u5408\u200bshould must_not: \u200b\u6587\u6863\u200b\u5fc5\u987b\u200b\u4e0d\u200b\u5339\u914d\u200b\u6761\u4ef6\u200b <pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        { \"match\": { \"state\": \"\u200b\u5317\u4eac\u200b\" } },\n        { \"term\": {  \"category1_new\": \"\u200b\u58eb\u591a\u200b\"} }\n      ]\n    }\n  }\n}\n</code></pre></p>"},{"location":"bigdata/es/#range","title":"range\u200b\u67e5\u8be2","text":"<p>\u200b\u7528\u4e8e\u200b\u67e5\u627e\u200b\u67d0\u4e2a\u200b\u5b57\u6bb5\u200b\u5728\u200b\u6307\u5b9a\u200b\u8303\u56f4\u200b\u5185\u200b\u7684\u200b\u6587\u6863\u200b\u3002 <pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"range\": {\n      \"price\": {\n        \"gte\": 100,\n        \"lte\": 500\n      }\n    }\n  }\n}\n</code></pre></p>"},{"location":"bigdata/es/#fuzzy","title":"Fuzzy\u200b\u67e5\u8be2","text":"<p>\"Fuzzy\"\u200b\u67e5\u8be2\u200b\u662f\u200bElasticsearch\u200b\u4e2d\u200b\u7684\u200b\u4e00\u79cd\u200b\u6a21\u7cca\u200b\u5339\u914d\u200b\u67e5\u8be2\u200b\uff0c\u200b\u5b83\u200b\u5141\u8bb8\u200b\u4f60\u200b\u67e5\u627e\u200b\u4e0e\u200b\u6307\u5b9a\u200b\u8bcd\u8bed\u200b\u76f8\u4f3c\u200b\u7684\u200b\u6587\u6863\u200b\u3002\u200b\u6a21\u7cca\u200b\u5339\u914d\u200b\u975e\u5e38\u200b\u6709\u7528\u200b\uff0c\u200b\u7279\u522b\u200b\u662f\u200b\u5728\u200b\u5904\u7406\u200b\u62fc\u5199\u9519\u8bef\u200b\u3001\u200b\u6587\u672c\u200b\u6570\u636e\u200b\u5305\u542b\u200b\u6253\u5b57\u200b\u9519\u8bef\u200b\u6216\u200b\u8fd1\u4e49\u8bcd\u200b\u65f6\u200b\u3002\u200b\u5b83\u200b\u57fa\u4e8e\u200b\u7f16\u8f91\u200b\u8ddd\u79bb\u200b\u6765\u200b\u5339\u914d\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5904\u7406\u200b\u62fc\u5199\u9519\u8bef\u200b\u6216\u200b\u8fd1\u4e49\u8bcd\u200b\u3002\u200b\u67e5\u8be2\u200b\u7684\u200b\u4e3b\u8981\u200b\u76ee\u6807\u200b\u662f\u200b\u901a\u8fc7\u200b\u5bb9\u5fcd\u200b\u4e00\u5b9a\u200b\u6570\u91cf\u200b\u7684\u200b\u5b57\u7b26\u200b\u7f16\u8f91\u200b\u64cd\u4f5c\u200b\u6765\u200b\u67e5\u627e\u200b\u76f8\u4f3c\u200b\u7684\u200b\u8bcd\u8bed\u200b\uff0c\u200b\u800c\u200b\u4e0d\u4ec5\u4ec5\u200b\u662f\u200b\u7cbe\u786e\u200b\u5339\u914d\u200b\u3002 <pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"fuzzy\": {\n      \"channeltype_new\": \"\u200b\u4f20\u7edf\u200b\u6e20\u200b\"\n    }\n  }\n}\n</code></pre></p>"},{"location":"bigdata/es/#fuzzy_1","title":"fuzzy \u200b\u67e5\u8be2\u200b\u7684\u200b\u5e38\u89c1\u200b\u53c2\u6570","text":"<ol> <li> <p>value\uff08\u200b\u5fc5\u586b\u200b\uff09</p> </li> <li> <p>\u200b\u7528\u4e8e\u200b\u6307\u5b9a\u200b\u8981\u200b\u8fdb\u884c\u200b\u6a21\u7cca\u200b\u5339\u914d\u200b\u7684\u200b\u503c\u200b\uff0c\u200b\u901a\u5e38\u200b\u662f\u200b\u4f60\u200b\u8981\u200b\u67e5\u627e\u200b\u7684\u200b\u5355\u8bcd\u200b\u6216\u200b\u77ed\u8bed\u200b\u3002  </p> </li> <li>\u200b\u4f8b\u5982\u200b\uff0c\"value\": \"searh\" \u200b\u8fdb\u884c\u200b\u5bf9\u200b search \u200b\u7684\u200b\u6a21\u7cca\u200b\u67e5\u8be2\u200b\u3002</li> <li>fuzziness\uff08\u200b\u53ef\u200b\u9009\u200b\uff09  </li> <li>\u200b\u63a7\u5236\u200b\u7f16\u8f91\u200b\u8ddd\u79bb\u200b\uff0c\u200b\u5373\u200b\u5141\u8bb8\u200b\u591a\u5c11\u200b\u4e2a\u5b57\u7b26\u200b\u63d2\u5165\u200b\u3001\u200b\u5220\u9664\u200b\u6216\u200b\u66ff\u6362\u200b\u3002\u200b\u53ef\u4ee5\u200b\u662f\u200b\uff1a \u200b\u6570\u5b57\u200b\uff08\u200b\u4f8b\u5982\u200b\uff1afuzziness: 2\uff09\uff1a\u200b\u6307\u5b9a\u200b\u6700\u5927\u200b\u5141\u8bb8\u200b\u7684\u200b\u7f16\u8f91\u200b\u8ddd\u79bb\u200b\u3002 AUTO\uff1a\u200b\u57fa\u4e8e\u200b\u641c\u7d22\u8bcd\u200b\u7684\u200b\u957f\u5ea6\u200b\u81ea\u52a8\u200b\u8ba1\u7b97\u200b\u5141\u8bb8\u200b\u7684\u200b\u7f16\u8f91\u200b\u8ddd\u79bb\u200b\u3002\u200b\u901a\u5e38\u200b\u77ed\u8bcd\u200b\uff08\u200b\u5982\u200b2\u200b\u4e2a\u200b\u5b57\u6bcd\u200b\uff09\u200b\u4f7f\u7528\u200b\u8f83\u200b\u5c0f\u200b\u7684\u200b\u8ddd\u79bb\u200b\uff0c\u200b\u800c\u200b\u8f83\u200b\u957f\u200b\u7684\u200b\u8bcd\u5219\u200b\u5141\u8bb8\u200b\u66f4\u5927\u200b\u7684\u200b\u7f16\u8f91\u200b\u8ddd\u79bb\u200b\u3002</li> <li>\u200b\u4f8b\u5982\u200b\uff0c\"fuzziness\": 2 \u200b\u8868\u793a\u200b\u5141\u8bb8\u200b\u4e24\u4e2a\u200b\u5b57\u7b26\u200b\u7684\u200b\u5dee\u5f02\u200b\u3002</li> <li>prefix_length\uff08\u200b\u53ef\u200b\u9009\u200b\uff09  </li> <li>\u200b\u7528\u4e8e\u200b\u5b9a\u4e49\u200b\u5728\u200b\u5f00\u59cb\u200b\u65f6\u200b\u4e0d\u200b\u5141\u8bb8\u200b\u6709\u200b\u4efb\u4f55\u200b\u53d8\u5316\u200b\u7684\u200b\u5b57\u7b26\u200b\u6570\u200b\u3002\u200b\u901a\u8fc7\u200b\u8fd9\u4e2a\u200b\u53c2\u6570\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5728\u200b\u5b9e\u9645\u200b\u8ba1\u7b97\u200b\u6a21\u7cca\u200b\u67e5\u8be2\u200b\u524d\u200b\u5ffd\u7565\u200b\u6587\u672c\u200b\u7684\u200b\u524d\u7f00\u200b\u90e8\u5206\u200b\uff0c\u200b\u4f18\u5316\u200b\u67e5\u8be2\u200b\u6027\u80fd\u200b\u3002</li> <li>\u200b\u4f8b\u5982\u200b\uff0c\"prefix_length\": 2 \u200b\u8868\u793a\u200b\u67e5\u8be2\u200b\u8bcd\u200b\u7684\u200b\u524d\u200b\u4e24\u4e2a\u200b\u5b57\u7b26\u200b\u4e0d\u4f1a\u200b\u53d7\u5230\u200b\u6a21\u7cca\u5316\u200b\u7684\u200b\u5f71\u54cd\u200b\u3002</li> <li>max_expansions\uff08\u200b\u53ef\u200b\u9009\u200b\uff09  </li> <li>\u200b\u9650\u5236\u200b\u53ef\u4ee5\u200b\u751f\u6210\u200b\u7684\u200b\u6a21\u7cca\u200b\u53d8\u4f53\u200b\u7684\u200b\u6700\u5927\u200b\u6570\u91cf\u200b\u3002\u200b\u5982\u679c\u200b\u8bbe\u7f6e\u200b\u4e86\u200b\u8f83\u5927\u200b\u7684\u200b fuzziness \u200b\u503c\u200b\uff0c\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u67e5\u8be2\u200b\u751f\u6210\u200b\u5927\u91cf\u200b\u53d8\u4f53\u200b\uff0cmax_expansions \u200b\u53ef\u200b\u7528\u4e8e\u200b\u63a7\u5236\u200b\u8fd9\u200b\u4e00\u70b9\u200b\uff0c\u200b\u907f\u514d\u200b\u6027\u80fd\u200b\u4e0b\u964d\u200b\u3002</li> <li>\u200b\u4f8b\u5982\u200b\uff0c\"max_expansions\": 50 \u200b\u8868\u793a\u200b\u6700\u200b\u591a\u200b\u751f\u6210\u200b50\u200b\u4e2a\u200b\u53d8\u4f53\u200b\u3002</li> <li>transpositions\uff08\u200b\u53ef\u200b\u9009\u200b\uff09</li> <li>\u200b\u662f\u5426\u200b\u5141\u8bb8\u200b\u5b57\u7b26\u200b\u4f4d\u7f6e\u200b\u7684\u200b\u4ea4\u6362\u200b\u3002\u200b\u9ed8\u8ba4\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u5b57\u7b26\u200b\u4ea4\u6362\u200b\u4e0d\u200b\u88ab\u200b\u8ba4\u4e3a\u200b\u662f\u200b\u6709\u6548\u200b\u7684\u200b\u53d8\u4f53\u200b\uff08\u200b\u5373\u200b \"ab\" \u200b\u4e0d\u200b\u7b49\u4e8e\u200b \"ba\"\uff09\u3002\u200b\u5982\u679c\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b true\uff0c\u200b\u5219\u200b\u5141\u8bb8\u200b\u5b57\u7b26\u200b\u4f4d\u7f6e\u200b\u4ea4\u6362\u200b\u3002</li> <li>\u200b\u4f8b\u5982\u200b\uff0c\"transpositions\": true \u200b\u5141\u8bb8\u200b\u5b57\u7b26\u200b\u4ea4\u6362\u200b\u3002 <pre><code>POST /your_index/_search\n{\n  \"query\": {\n    \"fuzzy\": {\n      \"your_field\": {\n        \"value\": \"searh\",        // \u200b\u8981\u200b\u5339\u914d\u200b\u7684\u200b\u8bcd\u200b\n        \"fuzziness\": \"AUTO\",    // \u200b\u81ea\u52a8\u200b\u8bbe\u7f6e\u200b\u6a21\u7cca\u200b\u5ea6\u200b\n        \"prefix_length\": 2,     // \u200b\u524d\u200b2\u200b\u4e2a\u5b57\u7b26\u200b\u4e0d\u53d8\u200b\n        \"max_expansions\": 50   // \u200b\u5141\u8bb8\u200b\u7684\u200b\u6700\u5927\u200b\u53d8\u4f53\u200b\u6570\u200b\n      }\n    }\n  }\n}\n</code></pre></li> </ol>"},{"location":"bigdata/es/#fuzzy_2","title":"\u5173\u4e8e\u200bfuzzy\u200b\u67e5\u8be2\u200b\u7684\u200b\u7591\u95ee","text":"<p>\u200b\u80cc\u666f\u200b\uff1a\u200b\u4f7f\u7528\u200bfuzzy\u200b\u67e5\u8be2\u200b\u67e5\u8be2\u200b\u67d0\u4e2a\u200b\u5e97\u94fa\u200b\u65f6\u200b\uff0c\u200b\u53d1\u73b0\u200b\u4f7f\u7528\u200b\u767e\u200b\u5174\u9686\u200b\u80fd\u591f\u200b\u67e5\u8be2\u200b\u51fa\u767e\u200b\u5174\u9686\u200b\u8d85\u5e02\u200b(\u200b\u5929\u96c5\u5c45\u200b\u6559\u5e08\u200b\u5c0f\u533a\u200b\u897f\u200b)\u200b\u7684\u200b\u6570\u636e\u200b\uff0c\u200b\u4f46\u662f\u200b\u4f7f\u7528\u200b\u767e\u200b\u5174\u9686\u200b\u8d85\u5e02\u200b\u67e5\u8be2\u200b\u4e0d\u200b\u51fa\u200b\u6570\u636e\u200b\uff0c\u200b\u5f53\u524d\u200b\u4f7f\u7528\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\u4e3a\u200bik_smart\u200b\u5206\u8bcd\u5668\u200b\u3002 \u200b\u5206\u6790\u200b\uff1a \u200b\u767e\u200b\u5174\u9686\u200b\u8d85\u5e02\u200b(\u200b\u5929\u96c5\u5c45\u200b\u6559\u5e08\u200b\u5c0f\u533a\u200b\u897f\u200b)\u200b\u5206\u8bcd\u200b\u540e\u200b\u7684\u200b\u7ed3\u679c\u200b\u4e3a\u200b\uff1a <pre><code>{\n  \"tokens\": [\n    {\n      \"token\": \"\u200b\u767e\u200b\",\n      \"start_offset\": 0,\n      \"end_offset\": 1,\n      \"type\": \"TYPE_CNUM\",\n      \"position\": 0\n    },\n    {\n      \"token\": \"\u200b\u5174\u9686\u200b\",\n      \"start_offset\": 1,\n      \"end_offset\": 3,\n      \"type\": \"CN_WORD\",\n      \"position\": 1\n    },\n    {\n      \"token\": \"\u200b\u8d85\u5e02\u200b\",\n      \"start_offset\": 3,\n      \"end_offset\": 5,\n      \"type\": \"CN_WORD\",\n      \"position\": 2\n    },\n    {\n      \"token\": \"\u200b\u5929\u200b\",\n      \"start_offset\": 6,\n      \"end_offset\": 7,\n      \"type\": \"CN_CHAR\",\n      \"position\": 3\n    },\n    {\n      \"token\": \"\u200b\u96c5\u200b\",\n      \"start_offset\": 7,\n      \"end_offset\": 8,\n      \"type\": \"CN_CHAR\",\n      \"position\": 4\n    },\n    {\n      \"token\": \"\u200b\u5c45\u200b\",\n      \"start_offset\": 8,\n      \"end_offset\": 9,\n      \"type\": \"CN_CHAR\",\n      \"position\": 5\n    },\n    {\n      \"token\": \"\u200b\u6559\u5e08\u200b\",\n      \"start_offset\": 9,\n      \"end_offset\": 11,\n      \"type\": \"CN_WORD\",\n      \"position\": 6\n    },\n    {\n      \"token\": \"\u200b\u5c0f\u533a\u200b\",\n      \"start_offset\": 11,\n      \"end_offset\": 13,\n      \"type\": \"CN_WORD\",\n      \"position\": 7\n    },\n    {\n      \"token\": \"\u200b\u897f\u200b\",\n      \"start_offset\": 13,\n      \"end_offset\": 14,\n      \"type\": \"CN_CHAR\",\n      \"position\": 8\n    }\n  ]\n}\n</code></pre> \u200b\u4f7f\u7528\u200b\u767e\u200b\u5174\u9686\u200b\u67e5\u8be2\u200b\u65f6\u200b\uff0c\u200b\u662f\u200b\u4f7f\u7528\u200b\u767e\u200b\u5174\u9686\u200b(\u200b\u4e0d\u200b\u5206\u8bcd\u200b)\u200b\u7684\u200b\u7ed3\u679c\u200b\u548c\u200b\u767e\u200b\u5174\u9686\u200b\u8d85\u5e02\u200b(\u200b\u5929\u96c5\u5c45\u200b\u6559\u5e08\u200b\u5c0f\u533a\u200b\u897f\u200b)\u200b\u5206\u8bcd\u200b\u540e\u200b\u7684\u200btoken\u200b\u8fdb\u884c\u200b\u7f16\u8f91\u200b\u8ddd\u79bb\u200b\u8ba1\u7b97\u200b\u7684\u200b\u3002 \u200b\u6240\u4ee5\u200b\u67e5\u8be2\u200b\u767e\u200b\u5174\u9686\u200b\u548c\u200b\u5174\u9686\u200b\u7684\u200b\u7f16\u8f91\u200b\u8ddd\u79bb\u200b\u4e3a\u200b1\uff0c\u200b\u80fd\u591f\u200b\u67e5\u8be2\u200b\u51fa\u200b\u7ed3\u679c\u200b\uff0c\u200b\u800c\u200b\u4f7f\u7528\u200b\u767e\u200b\u5174\u9686\u200b\u8d85\u5e02\u200b\u67e5\u8be2\u200b\u65f6\u200b\uff0c\u200b\u65e0\u8bba\u662f\u200b\u5174\u9686\u200b\u6216\u8005\u200b\u662f\u200b\u8d85\u5e02\u200b\u7684\u200b\u7f16\u8f91\u200b\u8ddd\u79bb\u200b\u90fd\u200b\u5927\u4e8e\u200b2(\u200b\u53ef\u200b\u8bbe\u7f6e\u200b\u7684\u200b\u6700\u5927\u200b\u8ddd\u79bb\u200b)\uff0c\u200b\u6240\u4ee5\u200b\u67e5\u8be2\u200b\u4e0d\u200b\u51fa\u200b\u7ed3\u679c\u200b\u3002</p>"},{"location":"bigdata/es/#wildcard","title":"wildcard\u200b\u67e5\u8be2","text":"<p>\u200b\u652f\u6301\u200b\u901a\u914d\u7b26\u200b\u5339\u914d\u200b\u3002 <pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"wildcard\": {\n      \"title\": \"elasticsearch*\"\n    }\n  }\n}\n</code></pre></p>"},{"location":"bigdata/es/#regexp","title":"regexp\u200b\u67e5\u8be2","text":"<pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"regexp\": {\n      \"title\": \"elast[a-z]*ch\"\n    }\n  }\n}\n</code></pre>"},{"location":"bigdata/es/#match_phrase","title":"match_phrase\u200b\u67e5\u8be2","text":"<p>\u200b\u8981\u6c42\u200b\u67e5\u8be2\u200b\u7684\u200b\u8bcd\u8bed\u200b\u5728\u200b\u6587\u6863\u200b\u4e2d\u4ee5\u200b\u76f8\u540c\u200b\u7684\u200b\u987a\u5e8f\u200b\u76f8\u90bb\u200b\u51fa\u73b0\u200b\u3002 <pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"match_phrase\": {\n      \"description\": \"distributed search\"\n    }\n  }\n}\n</code></pre></p>"},{"location":"bigdata/es/#es_1","title":"\u4e00\u4e9b\u200bes\u200b\u7684\u200b\u7591\u95ee","text":""},{"location":"bigdata/es/#termfilter","title":"term\u200b\u548c\u200bfilter","text":"<p>\u200b\u6700\u8fd1\u200b\u5728\u200b\u7528\u200bes\u200b\u505a\u200b\u9879\u76ee\u200b\uff0c\u200b\u5176\u4e2d\u200b\u4f7f\u7528\u200b\u5230\u200b\u4e86\u200bterm\u200b\u548c\u200bfilter\uff0c\u200b\u4f7f\u7528\u200b\u7684\u200b\u8bed\u53e5\u200b\u4e3a\u200b\uff1a <pre><code>{\n    \"query\": {\n        \"term\": {\n            \"tenant_code\": XXX\n        }\n    }\n}\n\n{\n    \"query\": {\n        \"bool\": {\n            \"filter\": {\n                \"term\": {\n                    \"tenant_code\": XXX\n                }\n            }\n        }\n    }\n}\n</code></pre> \u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u8bed\u53e5\u200b\u51fa\u6765\u200b\u7684\u200b\u6570\u636e\u200b\u662f\u200b\u4e00\u6837\u200b\u7684\u200b\uff0c\u200b\u4f46\u662f\u200bmax_score\u200b\u5728\u200b\u4e0a\u9762\u200b\u7684\u200b\u4e3a\u200b1\uff0c\u200b\u5728\u200b\u4e0b\u9762\u200b\u7684\u200b\u4e3a\u200b0\u3002\u200b\u67e5\u8be2\u200b\u8d44\u6599\u200b\u540e\u200b\u53d1\u73b0\u200b\uff1a term\u200b\u67e5\u8be2\u200b\u662f\u200b\u4e00\u79cd\u200b\u7cbe\u786e\u200b\u5339\u914d\u200b\u67e5\u8be2\u200b\uff0c\u200b\u5b83\u200b\u8981\u6c42\u200b\u6587\u6863\u200b\u4e2d\u200b\u7684\u200b\u5b57\u200b\u6bb5\u503c\u200b\u4e0e\u200b\u6307\u5b9a\u200b\u7684\u200b\u503c\u200b\u5b8c\u5168\u200b\u76f8\u7b49\u200b\u3002\u200b\u5f53\u200b\u4f7f\u7528\u200bterm\u200b\u67e5\u8be2\u200b\u65f6\u200b\uff0cElasticsearch\u200b\u4f1a\u200b\u8ba1\u7b97\u200b\u6587\u6863\u200b\u4e0e\u200b\u67e5\u8be2\u200b\u6761\u4ef6\u200b\u7684\u200b\u5339\u914d\u200b\u5ea6\u200b\uff0c\u200b\u5982\u679c\u200b\u5b57\u200b\u6bb5\u503c\u200b\u4e0e\u200b\u67e5\u8be2\u200b\u6761\u4ef6\u200b\u5b8c\u5168\u200b\u5339\u914d\u200b\uff0c\u200b\u5b83\u4f1a\u200b\u8fd4\u56de\u200b1\uff0c\u200b\u5426\u5219\u200b\u8fd4\u56de\u200b0\u3002\u200b\u56e0\u4e3a\u200bterm\u200b\u67e5\u8be2\u200b\u662f\u200b\u7cbe\u786e\u200b\u5339\u914d\u200b\uff0c\u200b\u6240\u4ee5\u200b\u5f53\u6709\u200b\u5339\u914d\u200b\u65f6\u200b\uff0cmax_score\u200b\u4e3a\u200b1\u3002</p> <p>bool\u200b\u67e5\u8be2\u200b\u662f\u200b\u4e00\u4e2a\u200b\u66f4\u200b\u901a\u7528\u200b\u7684\u200b\u67e5\u8be2\u200b\u7c7b\u578b\u200b\uff0c\u200b\u5141\u8bb8\u200b\u60a8\u200b\u7ec4\u5408\u200b\u591a\u4e2a\u200b\u6761\u4ef6\u200b\uff0c\u200b\u5305\u62ec\u200b\u8fc7\u6ee4\u200b\u6761\u4ef6\u200b\u3002\u200b\u5728\u200b\u60a8\u200b\u7684\u200b\u793a\u4f8b\u200b\u4e2d\u200b\uff0cbool\u200b\u67e5\u8be2\u200b\u7684\u200bfilter\u200b\u5b50\u53e5\u200b\u4ec5\u200b\u5305\u542b\u200b\u4e00\u4e2a\u200bterm\u200b\u67e5\u8be2\u200b\u6761\u4ef6\u200b\uff0c\u200b\u7528\u4e8e\u200b\u8fc7\u6ee4\u200b\u6587\u6863\u200b\u3002\u200b\u867d\u7136\u200b\u8fd9\u4e2a\u200b\u6761\u4ef6\u200b\u53ef\u80fd\u200b\u4e0e\u200bterm\u200b\u67e5\u8be2\u200b\u4e00\u6837\u200b\u7cbe\u786e\u200b\uff0c\u200b\u4f46\u662f\u200bbool\u200b\u67e5\u8be2\u200b\u4e0d\u200b\u6d89\u53ca\u200b\u8bc4\u5206\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u53ea\u662f\u200b\u7528\u4e8e\u200b\u8fc7\u6ee4\u200b\u6587\u6863\u200b\u7684\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0cbool\u200b\u67e5\u8be2\u200b\u7684\u200bmax_score\u200b\u901a\u5e38\u200b\u662f\u200b0\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u4e0d\u200b\u8ba1\u7b97\u200b\u6587\u6863\u200b\u4e0e\u200b\u67e5\u8be2\u200b\u6761\u4ef6\u200b\u7684\u200b\u5339\u914d\u200b\u5ea6\u200b\u3002</p> <p>\u200b\u603b\u7ed3\u200b\uff1aterm\u200b\u67e5\u8be2\u200b\u8fd4\u56de\u200b1\u200b\u6216\u200b0\uff0c\u200b\u8868\u793a\u200b\u5b8c\u5168\u200b\u5339\u914d\u200b\u6216\u200b\u4e0d\u200b\u5339\u914d\u200b\uff0c\u200b\u800c\u200bbool\u200b\u67e5\u8be2\u200b\u7684\u200bfilter\u200b\u5b50\u53e5\u200b\u901a\u5e38\u200b\u8fd4\u56de\u200b0\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u53ea\u662f\u200b\u7528\u4e8e\u200b\u8fc7\u6ee4\u200b\u6587\u6863\u200b\u7684\u200b\uff0c\u200b\u4e0d\u200b\u6d89\u53ca\u200b\u8bc4\u5206\u200b\u3002\u200b\u5982\u679c\u200b\u60a8\u200b\u53ea\u200b\u5173\u5fc3\u200b\u8fc7\u6ee4\u200b\u7ed3\u679c\u200b\u800c\u200b\u4e0d\u200b\u5173\u5fc3\u200b\u8bc4\u5206\u200b\uff0c\u200b\u90a3\u4e48\u200b\u4f7f\u7528\u200bbool\u200b\u67e5\u8be2\u200b\u7684\u200bfilter\u200b\u5b50\u53e5\u200b\u901a\u5e38\u200b\u66f4\u200b\u5408\u9002\u200b\u3002</p>"},{"location":"bigdata/es/#painless","title":"Painless","text":"<p>Painless \u200b\u662f\u200b Elasticsearch \u200b\u4e2d\u200b\u7684\u200b\u4e00\u79cd\u200b\u811a\u672c\u8bed\u8a00\u200b\uff0c\u200b\u7528\u4e8e\u200b\u6267\u884c\u200b\u67e5\u8be2\u200b\u3001\u200b\u805a\u5408\u200b\u548c\u200b\u8f6c\u6362\u200b\u6570\u636e\u200b\u3002\u200b\u5b83\u200b\u662f\u200b\u4e00\u79cd\u200b\u8f7b\u91cf\u7ea7\u200b\u7684\u200b\u811a\u672c\u8bed\u8a00\u200b\uff0c\u200b\u4e13\u95e8\u200b\u8bbe\u8ba1\u200b\u7528\u4e8e\u200b Elasticsearch \u200b\u4e2d\u200b\u7684\u200b\u9ad8\u6027\u80fd\u200b\u811a\u672c\u200b\u6267\u884c\u200b\u3002Painless \u200b\u8bed\u8a00\u200b\u7684\u200b\u76ee\u6807\u200b\u662f\u200b\u63d0\u4f9b\u200b\u4e00\u79cd\u200b\u5b89\u5168\u200b\u4e14\u200b\u9ad8\u6548\u200b\u7684\u200b\u65b9\u5f0f\u200b\u6765\u200b\u7f16\u5199\u200b\u548c\u200b\u6267\u884c\u200b Elasticsearch \u200b\u67e5\u8be2\u200b\u548c\u200b\u805a\u5408\u200b\u4e2d\u200b\u7684\u200b\u81ea\u5b9a\u4e49\u200b\u811a\u672c\u200b\u903b\u8f91\u200b\u3002 \u200b\u4f7f\u7528\u200b\u65b9\u5f0f\u200b\u4e3a\u200b\uff1a <pre><code>\"script\": {\n    \"source\": \"\"\"\n                if (ctx._source.containsKey('XXXX')) {\n                    if (ctx._source.XXXX == null) {\n                        ctx._source.XXXX = [params.XXXX]\n                    } else {\n                        boolean exists = false;\n                        for (item in ctx._source.XXXX) {\n                            if (item.XXXX == params.XXXX.XXXX &amp;&amp; item.XXXX == params.XXXX.XXXX) {\n                                exists = true;\n                                break;\n                            }\n                        }\n                        if (!exists) {\n                            ctx._source.XXXX.add(params.XXXX)\n                        }\n                    }\n                } else {\n                    ctx._source.XXXX = [params.XXXX]\n                }\n            \"\"\",\n    \"lang\": \"painless\",\n    \"params\": {\n        \"XXXX\": {\n            \"XXXX\": doc['XXXX'],\n            \"XXXX\": doc['XXXX']\n        }\n    }\n}\n</code></pre></p>"},{"location":"bigdata/es/#_1","title":"\u67e5\u8be2\u200b\u65f6\u95f4","text":"<p>\u200b\u4e4b\u524d\u200b\u65b0\u5efa\u200b\u7d22\u5f15\u200b\u7684\u200b\u65f6\u95f4\u200b\u5b57\u200b\u6bb5\u200b\uff0c\u200b\u7c7b\u578b\u200b\u4e00\u822c\u200b\u4e3a\u200bdate\uff0c\u200b\u4f46\u662f\u200b\u67d0\u6b21\u200b\u6ca1\u200b\u6ce8\u610f\u200b\u7528\u200b\u7684\u200b\u662f\u200bkeyword\u200b\u7c7b\u578b\u200b\uff0c\u200b\u5728\u200b\u4f7f\u7528\u200b\u8303\u56f4\u200b\u67e5\u8be2\u200b\u7684\u200b\u65f6\u5019\u200b\u53d1\u73b0\u200b\u67e5\u51fa\u6765\u200b\u7684\u200b\u6570\u636e\u200b\u4e0d\u200b\u5bf9\u200b\uff0c\u200b\u67e5\u200b\u4e86\u200b\u8d44\u6599\u200b\u540e\u200b\u53d1\u73b0\u200b\uff1a \u200b\u5982\u679c\u200b\u662f\u200bdate\u200b\u7c7b\u578b\u200b\uff0c\u200b\u53ef\u200b\u6b63\u5e38\u200b\u67e5\u8be2\u200b\uff0c\u200b\u5982\u679c\u200b\u662f\u200bkeyword\u200b\u7c7b\u578b\u200b\uff0c\u200b\u9700\u8981\u200b\u5728\u200b\u5b57\u200b\u6bb5\u200b\u540e\u9762\u200b\u6dfb\u52a0\u200b.keyword\u200b\u540e\u200b\u624d\u80fd\u200b\u6b63\u5e38\u200b\u67e5\u8be2\u200b\uff0c\u200b\u793a\u4f8b\u200b\uff1a <pre><code>\u200b\u4e00\u200b\u3001date\n\"insert_time\":{\n  \"type\": \"date\",\n  \"format\" : \"yyyy-MM-dd HH:mm:ss\"\n}\n\n\"query\": {\n    \"bool\": {\n        \"must\": [\n            {\n                \"range\": {\n                    \"insert_time\": {\n                        \"gt\": last_insert_time\n                    }\n                }\n            },\n            {\n                \"term\": {\n                    \"xxx\": xxx\n                }\n            }\n        ]\n    }\n}\n}\n\u200b\u4e8c\u200b\u3001keywrod\n\n\"query\": {\n    \"bool\": {\n        \"must\": [\n            {\n                \"range\": {\n                    \"insert_time.keyword\": {\n                        \"gt\": last_insert_time\n                    }\n                }\n            },\n            {\n                \"term\": {\n                    \"xxx\": xxx\n                }\n            }\n        ]\n    }\n}\n}\n</code></pre></p>"},{"location":"bigdata/es/#tokenizer","title":"Tokenizer","text":"<p>es\u200b\u7684\u200b\u9ed8\u8ba4\u200bTokenizer\u200b\u662f\u200bstandard\uff0c\u200b\u53ef\u200b\u901a\u8fc7\u200b\u4ee5\u4e0b\u200b\u8bed\u53e5\u200b\u67e5\u770b\u200b\u5206\u8bcd\u200b: <pre><code>GET /_analyze\n{\n  \"text\": \"A Quick Brown Fox\"\n}\n</code></pre> Elasticsearch \u200b\u63d0\u4f9b\u200b\u4e86\u200b\u591a\u79cd\u200b\u5185\u7f6e\u200b\u7684\u200b Tokenizer\uff0c\u200b\u4ee5\u4e0b\u200b\u662f\u200b\u4e00\u4e9b\u200b\u5e38\u7528\u200b\u7684\u200b Tokenizer\uff1a</p> <p>standard\uff1a\u200b\u57fa\u4e8e\u200b Unicode \u200b\u6587\u672c\u200b\u5206\u5272\u200b\u7b97\u6cd5\u200b\u7684\u200b\u8bed\u6cd5\u200b\u5206\u8bcd\u5668\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u7528\u4e8e\u200b\u5927\u591a\u6570\u200b\u8bed\u8a00\u200b\u3002\u200b\u5b83\u4f1a\u200b\u5728\u200b\u5927\u591a\u6570\u200b\u6807\u70b9\u7b26\u53f7\u200b\u5904\u200b\u5206\u5272\u200b\u6587\u672c\u200b\uff0c\u200b\u4f46\u200b\u4e0d\u4f1a\u200b\u79fb\u9664\u200b\u6807\u70b9\u7b26\u53f7\u200b\u3002\u200b\u5b83\u200b\u662f\u200b Elasticsearch \u200b\u7684\u200b\u9ed8\u8ba4\u200b\u5206\u8bcd\u5668\u200b\u3002</p> <p>letter\uff1a\u200b\u5728\u200b\u9047\u5230\u200b\u975e\u200b\u5b57\u6bcd\u200b\u5b57\u7b26\u200b\u65f6\u200b\u5206\u5272\u200b\u6587\u672c\u200b\u3002</p> <p>lowercase\uff1a\u200b\u548c\u200b letter \u200b\u5206\u8bcd\u5668\u200b\u7c7b\u4f3c\u200b\uff0c\u200b\u4f46\u4f1a\u200b\u5c06\u200b\u6240\u6709\u200b\u8bcd\u9879\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u5c0f\u5199\u200b\u3002</p> <p>whitespace\uff1a\u200b\u5728\u200b\u9047\u5230\u200b\u4efb\u4f55\u200b\u7a7a\u767d\u200b\u5b57\u7b26\u200b\u65f6\u200b\u5206\u5272\u200b\u6587\u672c\u200b\u3002</p> <p>uax_url_email\uff1a\u200b\u548c\u200b standard \u200b\u5206\u8bcd\u5668\u200b\u7c7b\u4f3c\u200b\uff0c\u200b\u4f46\u4f1a\u200b\u5c06\u200b URL \u200b\u548c\u200b\u7535\u5b50\u90ae\u4ef6\u200b\u5730\u5740\u200b\u8bc6\u522b\u200b\u4e3a\u200b\u5355\u4e2a\u200b\u8bcd\u9879\u200b\u3002</p> <p>classic\uff1a\u200b\u4e00\u79cd\u200b\u57fa\u4e8e\u200b\u82f1\u8bed\u8bed\u6cd5\u200b\u7684\u200b\u5206\u8bcd\u5668\u200b\u3002</p> <p>ngram\uff1a\u200b\u5c06\u200b\u6587\u672c\u200b\u6216\u200b\u5355\u8bcd\u200b\u5206\u89e3\u200b\u4e3a\u200b\u5c0f\u200b\u7247\u6bb5\u200b\uff0c\u200b\u7528\u4e8e\u200b\u90e8\u5206\u200b\u5355\u8bcd\u200b\u5339\u914d\u200b\u3002</p> <p>edge_ngram\uff1a\u200b\u8fd9\u4e2a\u200b\u5206\u8bcd\u5668\u200b\u4e5f\u200b\u4f1a\u200b\u5c06\u200b\u6587\u672c\u200b\u6216\u200b\u5355\u8bcd\u200b\u5206\u89e3\u200b\u4e3a\u200b\u5c0f\u200b\u7247\u6bb5\u200b\uff0c\u200b\u4f46\u200b\u53ea\u200b\u8fd4\u56de\u200b\u4e0e\u200b\u8bcd\u200b\u7684\u200b\u5f00\u5934\u200b\u951a\u5b9a\u200b\u7684\u200b n-gram\u3002</p> <p>ngram\u200b\u914d\u7f6e\u200b\u793a\u4f8b\u200b\uff1a <pre><code>PUT my-index-000001\n{\n  \"settings\": {\n    \"analysis\": {\n      \"analyzer\": {\n        \"my_analyzer\": {\n          \"tokenizer\": \"my_tokenizer\"\n        }\n      },\n      \"tokenizer\": {\n        \"my_tokenizer\": {\n          \"type\": \"ngram\",\n          \"min_gram\": 3,\n          \"max_gram\": 3,\n          \"token_chars\": [\n            \"letter\",\n            \"digit\"\n          ]\n        }\n      }\n    }\n  }\n}\n\nPOST my-index-000001/_analyze\n{\n  \"analyzer\": \"my_analyzer\",\n  \"text\": \"2 Quick Foxes.\"\n}\n</code></pre></p>"},{"location":"bigdata/es/#text","title":"\u5bf9\u200btext\u200b\u7c7b\u578b\u200b\u6570\u636e\u200b\u8fdb\u884c\u200b\u5168\u200b\u5339\u914d","text":"<p>\u200b\u5728\u5efa\u200b\u7d22\u5f15\u200b\u7684\u200b\u65f6\u5019\u200b\u4f7f\u7528\u200b\"fields\": {\"keyword\": {\"type\": \"keyword\"}} <pre><code>GET /xxx/_search\n{\n  \"query\": {\n    \"term\": {\n      \"xx.keyword\": \"\u200b\u58eb\u591a\u200b\"\n    }\n  }\n}\n</code></pre></p>"},{"location":"bigdata/es/#template","title":"template\u200b\u7684\u200b\u4f7f\u7528","text":"<p>_template \u200b\u662f\u200b\u7528\u6765\u200b\u5b9a\u4e49\u200b\u7d22\u5f15\u200b\u6a21\u677f\u200b\u7684\u200b\u5de5\u5177\u200b\u3002\u200b\u7d22\u5f15\u200b\u6a21\u677f\u200b\u53ef\u4ee5\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u5728\u200b\u521b\u5efa\u200b\u7d22\u5f15\u200b\u65f6\u200b\u81ea\u52a8\u200b\u5e94\u7528\u200b\u4e00\u4e9b\u200b\u914d\u7f6e\u200b\uff0c\u200b\u6bd4\u5982\u200b\u6620\u5c04\u200b\uff08mappings\uff09\u3001\u200b\u8bbe\u7f6e\u200b\uff08settings\uff09\u200b\u548c\u200b\u522b\u540d\u200b\uff08aliases\uff09\uff0c\u200b\u4ece\u800c\u200b\u7b80\u5316\u200b\u548c\u200b\u89c4\u8303\u200b\u7d22\u5f15\u200b\u7684\u200b\u521b\u5efa\u200b\u8fc7\u7a0b\u200b\u3002 <pre><code># \u200b\u521b\u5efa\u200b\u6a21\u677f\u200b\nPUT _template/my_template\n{\n  \"index_patterns\": [\"test-*\"],\n  \"settings\": {\n    \"number_of_shards\": 1,\n    \"number_of_replicas\": 0\n  },\n  \"mappings\": {\n    \"properties\": {\n      \"timestamp\": {\n        \"type\": \"date\"\n      },\n      \"message\": {\n        \"type\": \"text\"\n      },\n      \"user_id\": {\n        \"type\": \"keyword\"\n      }\n    }\n  },\n  \"aliases\": {\n    \"logs_alias\": {}\n  }\n}\n\n# \u200b\u521b\u5efa\u200b\u7d22\u5f15\u200b\nPUT test-2024-07-16\n# \u200b\u67e5\u770b\u200b\nGET test-2024-07-16/_mapping\n</code></pre></p>"},{"location":"bigdata/flink/","title":"Flink","text":""},{"location":"bigdata/flink/#_1","title":"\u8868\u200b\u5b9a\u4e49","text":"<p>\u200b\u52a8\u6001\u200b\u8868\u200b(dynamic table)\uff1a\u200b\u52a8\u6001\u200b\u8868\u662f\u200b\u6d41\u200b\u7684\u200b\u53e6\u200b\u4e00\u79cd\u200b\u8868\u8fbe\u65b9\u5f0f\u200b\uff0c\u200b\u52a8\u6001\u200b\u8868\u200b\u4f5c\u4e3a\u200b\u4e00\u4e2a\u200b\u903b\u8f91\u200b\u7684\u200b\u62bd\u8c61\u6982\u5ff5\u200b\uff0c\u200b\u4f7f\u200b\u6211\u4eec\u200b\u66f4\u200b\u5bb9\u6613\u200b\u7406\u89e3\u200bflink\u200b\u4e2d\u5c06\u200bstreaming\u200b\u53d1\u5c55\u200b\u5230\u200btable\u200b\u8fd9\u4e2a\u200b\u5c42\u6b21\u200b\u7684\u200b\u8bbe\u8ba1\u200b\uff0c\u200b\u672c\u8d28\u200b\u90fd\u200b\u662f\u200b\u5bf9\u200b\u65e0\u200b\u8fb9\u754c\u200b\u3001\u200b\u6301\u7eed\u200b\u53d8\u66f4\u200b\u6570\u636e\u200b\u7684\u200b\u8868\u793a\u200b\u5f62\u5f0f\u200b\uff0c\u200b\u6240\u4ee5\u200b\u52a8\u6001\u200b\u8868\u4e0e\u6d41\u200b\u4e4b\u95f4\u200b\u53ef\u4ee5\u200b\u76f8\u4e92\u200b\u8f6c\u6362\u200b\u3002 Append-only \u200b\u6d41\u200b\uff1a \u200b\u4ec5\u200b\u901a\u8fc7\u200b INSERT \u200b\u64cd\u4f5c\u200b\u4fee\u6539\u200b\u7684\u200b\u52a8\u6001\u200b\u8868\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u8f93\u51fa\u200b\u63d2\u5165\u200b\u7684\u200b\u884c\u200b\u8f6c\u6362\u200b\u4e3a\u6d41\u200b\u3002  </p> <p>Retract \u200b\u6d41\u200b\uff1a retract \u200b\u6d41\u200b\u5305\u542b\u200b\u4e24\u79cd\u200b\u7c7b\u578b\u200b\u7684\u200b message\uff1a add messages \u200b\u548c\u200b retract messages \u3002\u200b\u901a\u8fc7\u200b\u5c06\u200bINSERT \u200b\u64cd\u4f5c\u200b\u7f16\u7801\u200b\u4e3a\u200b add message\u3001\u200b\u5c06\u200b DELETE \u200b\u64cd\u4f5c\u200b\u7f16\u7801\u200b\u4e3a\u200b retract message\u3001\u200b\u5c06\u200b UPDATE \u200b\u64cd\u4f5c\u200b\u7f16\u7801\u200b\u4e3a\u200b\u66f4\u65b0\u200b(\u200b\u5148\u524d\u200b)\u200b\u884c\u200b\u7684\u200b retract message \u200b\u548c\u200b\u66f4\u65b0\u200b(\u200b\u65b0\u200b)\u200b\u884c\u200b\u7684\u200b add message\uff0c\u200b\u5c06\u200b\u52a8\u6001\u200b\u8868\u200b\u8f6c\u6362\u200b\u4e3a\u200b retract \u200b\u6d41\u200b</p> <p>Upsert \u200b\u6d41\u200b: upsert \u200b\u6d41\u200b\u5305\u542b\u200b\u4e24\u79cd\u200b\u7c7b\u578b\u200b\u7684\u200b message\uff1a upsert messages \u200b\u548c\u200bdelete messages\u3002\u200b\u8f6c\u6362\u200b\u4e3a\u200b upsert \u200b\u6d41\u200b\u7684\u200b\u52a8\u6001\u200b\u8868\u200b\u9700\u8981\u200b(\u200b\u53ef\u80fd\u200b\u662f\u200b\u7ec4\u5408\u200b\u7684\u200b)\u200b\u552f\u4e00\u200b\u952e\u200b\u3002\u200b\u901a\u8fc7\u200b\u5c06\u200b INSERT \u200b\u548c\u200b UPDATE \u200b\u64cd\u4f5c\u200b\u7f16\u7801\u200b\u4e3a\u200b upsert message\uff0c\u200b\u5c06\u200b DELETE \u200b\u64cd\u4f5c\u200b\u7f16\u7801\u200b\u4e3a\u200b delete message \uff0c\u200b\u5c06\u200b\u5177\u6709\u200b\u552f\u4e00\u200b\u952e\u200b\u7684\u200b\u52a8\u6001\u200b\u8868\u200b\u8f6c\u6362\u200b\u4e3a\u6d41\u200b\u3002\u200b\u6d88\u8d39\u200b\u6d41\u200b\u7684\u200b\u7b97\u5b50\u200b\u9700\u8981\u200b\u77e5\u9053\u200b\u552f\u4e00\u200b\u952e\u200b\u7684\u200b\u5c5e\u6027\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u6b63\u786e\u200b\u5730\u200b\u5e94\u7528\u200b message\u3002\u200b\u4e0e\u200b retract \u200b\u6d41\u200b\u7684\u200b\u4e3b\u8981\u200b\u533a\u522b\u200b\u5728\u4e8e\u200b UPDATE \u200b\u64cd\u4f5c\u200b\u662f\u200b\u7528\u200b\u5355\u4e2a\u200b message \u200b\u7f16\u7801\u200b\u7684\u200b\uff0c\u200b\u56e0\u6b64\u200b\u6548\u7387\u200b\u66f4\u9ad8\u200b\u3002</p> <p>\u200b\u65f6\u6001\u200b\u8868\u200b(temporal table)\uff1a\u200b\u662f\u200b\u4e00\u5f20\u200b\u968f\u200b\u65f6\u95f4\u200b\u53d8\u5316\u200b\u7684\u200b\u8868\u200b, \u200b\u5728\u200b Flink \u200b\u4e2d\u200b\u79f0\u4e3a\u200b\u52a8\u6001\u200b\u8868\u200b\uff0c\u200b\u65f6\u6001\u200b\u8868\u4e2d\u200b\u7684\u200b\u6bcf\u6761\u200b\u8bb0\u5f55\u200b\u90fd\u200b\u5173\u8054\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b\u65f6\u95f4\u6bb5\u200b\uff0c\u200b\u6240\u6709\u200b\u7684\u200b Flink \u200b\u8868\u90fd\u200b\u662f\u200b\u65f6\u6001\u200b\u7684\u200b\uff08\u200b\u52a8\u6001\u200b\u7684\u200b\uff09\u3002\u200b\u4e5f\u5c31\u662f\u8bf4\u200b\u65f6\u6001\u200b\u8868\u662f\u200b\u52a8\u6001\u200b\u8868\u200b\u7684\u200b\u7279\u4f8b\u200b\uff0c\u200b\u65f6\u6001\u200b\u8868\u200b\u4e00\u5b9a\u200b\u662f\u200b\u52a8\u6001\u200b\u8868\u200b\uff0c\u200b\u52a8\u6001\u200b\u8868\u4e0d\u200b\u4e00\u5b9a\u200b\u662f\u200b\u65f6\u6001\u200b\u8868\u200b\u3002</p> <p>\u200b\u65f6\u6001\u200b\u8868\u200b\u53ef\u4ee5\u200b\u5206\u4e3a\u200b \u200b\u7248\u672c\u200b\u8868\u200b \u200b\u548c\u200b \u200b\u666e\u901a\u200b\u8868\u200b\u3002 \u200b\u7248\u672c\u200b\u8868\u200b: \u200b\u5982\u679c\u200b\u65f6\u6001\u200b\u8868\u4e2d\u200b\u7684\u200b\u8bb0\u5f55\u200b\u53ef\u4ee5\u200b\u8ffd\u8e2a\u200b\u548c\u200b\u5e76\u200b\u8bbf\u95ee\u200b\u5b83\u200b\u7684\u200b\u5386\u53f2\u200b\u7248\u672c\u200b\uff0c\u200b\u8fd9\u79cd\u200b\u8868\u200b\u6211\u4eec\u200b\u79f0\u4e4b\u4e3a\u200b\u7248\u672c\u200b\u8868\u200b\uff0c\u200b\u6765\u81ea\u200b\u6570\u636e\u5e93\u200b\u7684\u200b changelog \u200b\u53ef\u4ee5\u200b\u5b9a\u4e49\u200b\u6210\u200b\u7248\u672c\u200b\u8868\u200b\u3002</p> <p>\u200b\u666e\u901a\u200b\u8868\u200b: \u200b\u5982\u679c\u200b\u65f6\u6001\u200b\u8868\u4e2d\u200b\u7684\u200b\u8bb0\u5f55\u200b\u4ec5\u4ec5\u200b\u53ef\u4ee5\u200b\u8ffd\u8e2a\u200b\u5e76\u200b\u548c\u200b\u5b83\u200b\u7684\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\uff0c\u200b\u8fd9\u79cd\u200b\u8868\u200b\u6211\u4eec\u200b\u79f0\u4e4b\u4e3a\u200b\u666e\u901a\u200b\u8868\u200b\uff0c\u200b\u6765\u81ea\u200b\u6570\u636e\u5e93\u200b \u200b\u6216\u200b HBase \u200b\u7684\u200b\u8868\u200b\u53ef\u4ee5\u200b\u5b9a\u4e49\u200b\u6210\u200b\u666e\u901a\u200b\u8868\u200b\u3002 Flink \u200b\u4e2d\u200b\uff0c\u200b\u5b9a\u4e49\u200b\u4e86\u200b\u4e3b\u952e\u200b\u7ea6\u675f\u200b\u548c\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\u7684\u200b\u8868\u200b\u5c31\u662f\u200b\u7248\u672c\u200b\u8868\u200b\u3002</p>"},{"location":"bigdata/flink/#join","title":"JOIN","text":""},{"location":"bigdata/flink/#regular-joins","title":"Regular Joins","text":"<p>\u200b\u5e38\u89c4\u200b JOIN\uff08Regular JOIN\uff09\u200b\u662f\u200b\u8bed\u6cd5\u200b\u6700\u200b\u7b80\u5355\u200b\u7684\u200b\u4e00\u7c7b\u200b JOIN\uff0c\u200b\u548c\u200b\u4f20\u7edf\u200b\u6570\u636e\u5e93\u200b\u7684\u200b JOIN \u200b\u8bed\u6cd5\u200b\u5b8c\u5168\u4e00\u81f4\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u5de6\u8868\u200b\u548c\u200b\u53f3\u8868\u200b\u7684\u200b\u4efb\u4f55\u200b\u53d8\u52a8\u200b\uff0c\u200b\u90fd\u200b\u4f1a\u200b\u89e6\u53d1\u200b\u5b9e\u65f6\u200b\u8ba1\u7b97\u200b\u548c\u200b\u66f4\u65b0\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5b83\u200b\u7684\u200b\u7ed3\u679c\u200b\u662f\u200b\u201c\u200b\u9010\u6b65\u200b\u903c\u8fd1\u200b\u201d\u200b\u6700\u7ec8\u200b\u7684\u200b\u7cbe\u786e\u200b\u503c\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200b\u4e0b\u6e38\u200b\u53ef\u80fd\u200b\u770b\u5230\u200b\u53d8\u6765\u53d8\u53bb\u200b\u7684\u200b\u7ed3\u679c\u200b\u3002\u200b\u4e3a\u4e86\u200b\u652f\u6301\u200b\u7ed3\u679c\u200b\u7684\u200b\u66f4\u65b0\u200b\uff0c\u200b\u4e0b\u6e38\u200b\u76ee\u7684\u200b\u8868\u200b\u9700\u8981\u200b \u200b\u5b9a\u4e49\u200b\u4e3b\u952e\u200b \uff08PRIMARY KEY NOT ENFORCED\uff09\u3002 \u200b\u4e0d\u200b\u652f\u6301\u200b\u65f6\u95f4\u200b\u7a97\u53e3\u200b\u4ee5\u53ca\u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\uff0c\u200b\u4efb\u4f55\u200b\u4e00\u4fa7\u200b\u6570\u636e\u6d41\u200b\u6709\u200b\u66f4\u6539\u200b\u90fd\u200b\u662f\u200b\u53ef\u89c1\u200b\u7684\u200b\uff0c\u200b\u76f4\u63a5\u200b\u5f71\u54cd\u200b\u6574\u4e2a\u200b join \u200b\u7ed3\u679c\u200b\u3002\u200b\u5982\u679c\u200b\u6709\u200b\u4e00\u4fa7\u200b\u6570\u636e\u6d41\u200b\u589e\u52a0\u200b\u4e00\u4e2a\u200b\u65b0\u7eaa\u5f55\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5b83\u200b\u5c06\u200b\u4f1a\u200b\u628a\u200b\u53e6\u4e00\u4fa7\u200b\u7684\u200b\u6240\u6709\u200b\u7684\u200b\u8fc7\u53bb\u200b\u548c\u200b\u5c06\u6765\u200b\u7684\u200b\u6570\u636e\u200b\u5408\u5e76\u200b\u5728\u200b\u4e00\u8d77\u200b\uff0c\u200b\u56e0\u4e3a\u200bregular join \u200b\u6ca1\u6709\u200b\u5254\u9664\u200b\u7b56\u7565\u200b\uff0c\u200b\u8fd9\u200b\u5c31\u200b\u5f71\u54cd\u200b\u6700\u65b0\u200b\u8f93\u51fa\u200b\u7684\u200b\u7ed3\u679c\u200b; \u200b\u6b63\u200b\u56e0\u4e3a\u200b\u5386\u53f2\u6570\u636e\u200b\u4e0d\u4f1a\u200b\u88ab\u200b\u6e05\u7406\u200b\uff0c\u200b\u6240\u4ee5\u200b regular join \u200b\u652f\u6301\u200b\u6570\u636e\u6d41\u200b\u7684\u200b\u4efb\u4f55\u200b\u66f4\u65b0\u200b\u64cd\u4f5c\u200b\uff08\u200b\u63d2\u5165\u200b\u3001\u200b\u66f4\u65b0\u200b\u3001\u200b\u5220\u9664\u200b\uff09\u3002 \u200b\u8fd9\u79cd\u200b JOIN \u200b\u8981\u6c42\u200b JOIN \u200b\u4e24\u8fb9\u200b\u6570\u636e\u200b\u90fd\u200b\u6c38\u4e45\u200b\u4fdd\u7559\u200b\u5728\u200b Flink state \u200b\u4e2d\u200b\uff0c\u200b\u624d\u80fd\u200b\u4fdd\u8bc1\u200b\u8f93\u51fa\u200b\u7ed3\u679c\u200b\u7684\u200b\u51c6\u786e\u6027\u200b\uff0c\u200b\u8fd9\u200b\u5c06\u200b\u5bfc\u81f4\u200b State \u200b\u7684\u200b\u65e0\u9650\u200b\u81a8\u80c0\u200b\u3002 \u200b\u53ef\u4ee5\u200b\u914d\u7f6e\u200b state \u200b\u7684\u200bTTL(time-to-live\uff1atable.exec.state.ttl)\u200b\u6765\u200b\u907f\u514d\u200b\u5176\u200b\u65e0\u9650\u200b\u589e\u957f\u200b\uff0c\u200b\u4f46\u200b\u8bf7\u200b\u6ce8\u610f\u200b\u8fd9\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u5f71\u54cd\u200b\u67e5\u8be2\u200b\u7ed3\u679c\u200b\u7684\u200b\u51c6\u5907\u200b\u6027\u200b\u3002</p> <p>\u200b\u4f7f\u7528\u200b\u8bed\u6cd5\u200b\uff1a\u200b\u76ee\u524d\u200b\uff0c\u200b\u4ec5\u200b\u652f\u6301\u200b\u7b49\u503c\u200b\u8fde\u63a5\u200b\uff0cINNER JOIN\uff0cLEFT JOIN\uff0cRIGHT JOIN\uff0cFULL OUTER JOIN <pre><code>SELECT columns\nFROM t1  [AS &lt;alias1&gt;]\n[LEFT/INNER/FULL OUTER] JOIN t2\nON t1.column1 = t2.key-name1\n</code></pre> \u200b\u9002\u7528\u200b\u573a\u666f\u200b\uff1a\u200b\u79bb\u7ebf\u200b\u573a\u666f\u200b\u548c\u200b\u5c0f\u200b\u6570\u636e\u91cf\u200b\u573a\u666f\u200b\u3002</p>"},{"location":"bigdata/flink/#interval-joins","title":"Interval Joins","text":"<p>Interval Joins\u200b\u662f\u200b\u4e00\u79cd\u200b\u5728\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\u5185\u200b\u5173\u8054\u200b\u7684\u200bJOIN\uff0c\u200b\u5b83\u200b\u4e0e\u200b\u4e0a\u8ff0\u200b\u7684\u200b\u5e38\u89c4\u200b JOIN \u200b\u4e0d\u540c\u4e4b\u5904\u200b\u5728\u4e8e\u200b\uff0c\u200b\u5de6\u53f3\u200b\u8868\u4ec5\u200b\u5728\u200b\u67d0\u4e2a\u200b\u65f6\u95f4\u200b\u8303\u56f4\u200b\uff08\u200b\u7ed9\u5b9a\u200b\u4e0a\u754c\u200b\u548c\u200b\u4e0b\u754c\u200b\uff09\u200b\u5185\u200b\u8fdb\u884c\u200b\u5173\u8054\u200b\uff0c\u200b\u4e14\u200b\u53ea\u200b\u652f\u6301\u200b\u666e\u901a\u200b Append \u200b\u6570\u636e\u6d41\u200b\uff0c\u200b\u4e0d\u200b\u652f\u6301\u200b\u542b\u200b Retract \u200b\u7684\u200b\u52a8\u6001\u200b\u8868\u200b\u3002\u200b\u5982\u4e0b\u200b\u56fe\u200b\uff08\u200b\u6765\u81ea\u200b Flink \u200b\u5b98\u65b9\u200b\u6587\u6863\u200b\uff09\u3002\u200b\u5b83\u200b\u7684\u200b\u597d\u5904\u200b\u662f\u200b\u7531\u4e8e\u200b\u7ed9\u5b9a\u200b\u4e86\u200b\u5173\u8054\u200b\u7684\u200b\u533a\u95f4\u200b\uff0c\u200b\u56e0\u6b64\u200b\u53ea\u200b\u9700\u8981\u200b\u4fdd\u7559\u200b\u5f88\u5c11\u200b\u7684\u200b\u72b6\u6001\u200b\uff0c\u200b\u5185\u5b58\u200b\u538b\u529b\u200b\u8f83\u200b\u5c0f\u200b\u3002\u200b\u4f46\u662f\u200b\u7f3a\u70b9\u200b\u662f\u200b\u5982\u679c\u200b\u5173\u8054\u200b\u7684\u200b\u6570\u636e\u200b\u665a\u5230\u200b\u6216\u8005\u200b\u65e9\u5230\u200b\uff0c\u200b\u5bfc\u81f4\u200b\u843d\u200b\u4e0d\u5230\u200b JOIN \u200b\u533a\u95f4\u200b\u5185\u200b\uff0c\u200b\u5c31\u200b\u53ef\u80fd\u200b\u5bfc\u81f4\u200b\u7ed3\u679c\u200b\u4e0d\u200b\u51c6\u786e\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u53ea\u6709\u200b\u5f53\u200b\u533a\u95f4\u200b\u8fc7\u200b\u4e86\u200b\u4ee5\u540e\u200b\uff0cJOIN \u200b\u7ed3\u679c\u200b\u624d\u200b\u4f1a\u200b\u8f93\u51fa\u200b\uff0c\u200b\u56e0\u6b64\u200b\u4f1a\u200b\u6709\u200b\u4e00\u5b9a\u200b\u7684\u200b\u5ef6\u8fdf\u200b\u5b58\u5728\u200b\u3002  \u200b\u95f4\u9694\u200b\u8054\u63a5\u200b\u5f53\u524d\u200b\u4ec5\u200b\u652f\u6301\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\u3002 \u200b\u5982\u4f55\u200b\u8bbe\u7f6e\u200b\u8fb9\u754c\u6761\u4ef6\u200b: right.timestamp \u2208 [left.timestamp + lowerBound, left.timestamp + upperBound] Regular Join \u200b\u4f1a\u200b\u4ea7\u751f\u200b\u56de\u64a4\u200b\u6d41\u200b\uff0c\u200b\u4f46\u662f\u200b\u5728\u200b\u5b9e\u65f6\u200b\u6570\u4ed3\u200b\u4e2d\u200b\u4e00\u822c\u200b\u5199\u5165\u200b\u7684\u200b sink \u200b\u90fd\u200b\u662f\u200b\u7c7b\u4f3c\u200b\u4e8e\u200b Kafka \u200b\u8fd9\u6837\u200b\u7684\u200b\u6d88\u606f\u200b\u961f\u5217\u200b\uff0c\u200b\u7136\u540e\u200b\u540e\u9762\u200b\u63a5\u200b clickhouse \u200b\u7b49\u200b\u5f15\u64ce\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u5f15\u64ce\u200b\u53c8\u200b\u4e0d\u200b\u5177\u5907\u200b\u5904\u7406\u200b\u56de\u64a4\u200b\u6d41\u200b\u7684\u200b\u80fd\u529b\u200b\u3002 Interval Join \u200b\u5c31\u662f\u200b\u7528\u4e8e\u200b\u6d88\u706d\u200b\u56de\u64a4\u200b\u6d41\u200b\u7684\u200b\u3002</p> <p>\u200b\u4f7f\u7528\u200binterval join\uff0c\u200b\u9700\u8981\u200b\u5b9a\u4e49\u200b\u597d\u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\u5b57\u200b\u6bb5\u200b\uff0c \u200b\u4e14\u200b\u5c06\u200b\u8be5\u200b\u65f6\u95f4\u200b\u6233\u200b\u5b57\u200b\u6bb5\u200b\u7528\u4f5c\u200b WATERMARK FOR \u200b\u8bed\u53e5\u200b\u6307\u5b9a\u200b\u7684\u200b\u65f6\u95f4\u200b\u5b57\u200b\u6bb5\u200b\u3002\u200b\u5982\u679c\u200b\u8868\u200b\u5b9e\u5728\u200b\u6ca1\u6709\u200b\u65f6\u95f4\u200b\u6233\u200b\u5b57\u200b\u6bb5\u200b\uff0c\u200b\u5219\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b PROCTIME() \u200b\u51fd\u6570\u200b\u6765\u200b\u751f\u6210\u200b\u4e00\u4e2a\u200bProcessing Time\u3002\u200b\u5982\u679c\u200b\u5b9a\u4e49\u200b\u7684\u200b\u662f\u200b Processing Time\uff0c\u200b\u5219\u200bFlink \u200b\u6846\u67b6\u200b\u672c\u8eab\u200b\u6839\u636e\u200b\u7cfb\u7edf\u200b\u5212\u5206\u200b\u7684\u200b\u65f6\u95f4\u200b\u7a97\u53e3\u200b\u5b9a\u65f6\u200b\u6e05\u7406\u200b\u6570\u636e\u200b\uff1b\u200b\u5982\u679c\u200b\u5b9a\u4e49\u200b\u7684\u200b\u662f\u200b Event Time\uff0cFlink \u200b\u6846\u67b6\u200b\u5206\u914d\u200b Event Time \u200b\u7a97\u53e3\u200b\u5e76\u200b\u6839\u636e\u200b\u8bbe\u7f6e\u200b\u7684\u200b watermark \u200b\u6765\u200b\u6e05\u7406\u200b\u6570\u636e\u200b\u3002 \u200b\u7279\u522b\u200b\u6ce8\u610f\u200b\uff1a\u200b\u8bf7\u200b\u4e0d\u8981\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b\u672a\u5b9a\u4e49\u200b WATERMARK \u200b\u6216\u200b PROCTIME() \u200b\u7684\u200b\u539f\u59cb\u200b TIMESTAMP \u200b\u7c7b\u578b\u200b\u5b57\u200b\u6bb5\u200b\uff0c\u200b\u5426\u5219\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u9000\u56de\u200b\u5230\u200b\u4e0a\u8ff0\u200b\u7684\u200b \u201c\u200b\u5e38\u89c4\u200b JOIN\u201d\u3002</p> <p>\u200b\u4f7f\u7528\u200b\u8bed\u6cd5\u200b\uff1a <pre><code>SELECT columns\nFROM t1  [AS &lt;alias1&gt;]\n[LEFT/INNER/FULL OUTER] JOIN t2\nON t1.column1 = t2.key-name1 \nAND t1.timestamp BETWEEN t2.timestamp  AND  t2.timestamp + INTERVAL '10' MINUTE;\n\n-- \u200b\u4ee5\u4e0b\u200b\u5199\u6cd5\u200b\u5747\u200b\u53ef\u200b\nltime = rtime\nltime &gt;= rtime AND ltime &lt; rtime + INTERVAL '10' MINUTE\nltime BETWEEN rtime - INTERVAL '10' SECOND AND rtime + INTERVAL '5' SECOND\n</code></pre></p> <p>\u200b\u9002\u7528\u200b\u573a\u666f\u200b\uff1a\u200b\u53cc\u6d41\u200bjoin\u200b\u573a\u666f\u200b</p>"},{"location":"bigdata/flink/#temporal-join","title":"temporal join","text":"<p>Temporal table \u200b\u662f\u200b\u968f\u200b\u65f6\u95f4\u200b\u6f14\u53d8\u200b\u7684\u200b\u8868\u200b\u2014\u2014\u200b\u5728\u200b Flink \u200b\u4e2d\u200b\u4e5f\u200b\u79f0\u4e3a\u200b\u52a8\u6001\u200b\u8868\u200b\u3002\u200b\u65f6\u6001\u200b\u8868\u4e2d\u200b\u7684\u200b\u884c\u200b\u4e0e\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b\u65f6\u6001\u200b\u5468\u671f\u200b\u76f8\u5173\u8054\u200b\uff0c\u200b\u5e76\u4e14\u200b\u6240\u6709\u200b Flink \u200b\u8868\u90fd\u200b\u662f\u200b\u65f6\u6001\u200b\u7684\u200b\uff08\u200b\u52a8\u6001\u200b\u7684\u200b\uff09\u3002\u200b\u65f6\u6001\u200b\u8868\u200b\u5305\u542b\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b\u7248\u672c\u200b\u8868\u200b\u5feb\u7167\u200b\uff0c\u200b\u5b83\u200b\u53ef\u4ee5\u200b\u662f\u200b\u8ddf\u8e2a\u200b\u66f4\u6539\u200b\u7684\u200b\u66f4\u6539\u200b\u5386\u53f2\u200b\u8868\u200b\uff08\u200b\u4f8b\u5982\u200b\u6570\u636e\u5e93\u200b\u66f4\u6539\u200b\u65e5\u5fd7\u200b\uff0c\u200b\u5305\u542b\u200b\u6240\u6709\u200b\u5feb\u7167\u200b\uff09\u200b\u6216\u200b\u5b9e\u73b0\u200b\u66f4\u6539\u200b\u7684\u200b\u66f4\u6539\u200b\u7ef4\u5ea6\u200b\u8868\u200b\uff08\u200b\u4f8b\u5982\u200b\u5305\u542b\u200b\u6700\u65b0\u200b\u5feb\u7167\u200b\u7684\u200b\u6570\u636e\u5e93\u200b\u8868\u200b\uff09</p> <p>\u200b\u65f6\u6001\u200b\u8868\u200b JOIN \u200b\u5206\u4e3a\u200b \u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\uff08Event Time\uff09 \u200b\u548c\u200b \u200b\u5904\u7406\u200b\u65f6\u95f4\u200b\uff08Processing Time\uff09\u200b\u4e24\u79cd\u200b\u7c7b\u578b\u200b\uff0c\u200b\u4e14\u200b\u53ea\u200b\u652f\u6301\u200b INNER \u200b\u548c\u200b LEFT JOIN\u3002</p> <p>\u200b\u7531\u4e8e\u200b\u65f6\u6001\u200b\u8868\u200b JOIN \u200b\u9700\u8981\u200b\u5f97\u77e5\u200b\u4e0d\u540c\u200b\u65f6\u523b\u200b\u4e0b\u53f3\u8868\u200b\u7684\u200b\u4e0d\u540c\u200b\u7248\u672c\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5b83\u200b\u7684\u200b\u53f3\u8868\u200b\u5fc5\u987b\u200b\u662f\u200b Changelog \u200b\u52a8\u6001\u200b\u8868\u200b\uff08\u200b\u5373\u200b Upsert\u3001Retract \u200b\u6570\u636e\u6d41\u200b\uff0c\u200b\u800c\u200b\u975e\u200b Append \u200b\u6570\u636e\u6d41\u200b\uff09\uff0c\u200b\u4e14\u200b\u4e24\u4fa7\u200b\u7684\u200b\u6e90\u8868\u200b\u90fd\u200b\u5fc5\u987b\u200b\u5b9a\u4e49\u200b WATERMARK FOR\u3002\u200b\u968f\u7740\u200b Watermark \u200b\u6c34\u4f4d\u200b\u63a8\u8fdb\u200b\uff0cFlink \u200b\u53ef\u4ee5\u200b\u9010\u6b65\u200b\u6e05\u7406\u200b\u5931\u6548\u200b\u7684\u200b\u6570\u636e\u200b\uff0c\u200b\u56e0\u6b64\u200b\u65f6\u6001\u200b\u8868\u200b JOIN \u200b\u7684\u200b\u5185\u5b58\u200b\u538b\u529b\u200b\u76f8\u5bf9\u200b\u4e5f\u200b\u4e0d\u5927\u200b\u3002\u200b\u6b64\u5916\u200b\uff0c\u200b\u8fd8\u200b\u8981\u6c42\u200b\u65f6\u6001\u200b\u8868\u200b\u7684\u200b\u4e3b\u952e\u200b\u5fc5\u987b\u200b\u5305\u542b\u200b\u5728\u200b JOIN \u200b\u7b49\u503c\u200b\u6761\u4ef6\u200b\u4e2d\u200b\u3002 \u200b\u65f6\u6001\u200b\u8868\u662f\u200b\u4ec5\u200b\u8ffd\u52a0\u200b\uff08append-only\uff09\u200b\u8868\u4e0a\u200b\u7684\u200b\u53c2\u6570\u200b\u5316\u200b\u89c6\u56fe\u200b\uff0c\u200b\u5b83\u200b\u5c06\u200bappend-only\u200b\u8868\u7684\u884c\u200b\u89e3\u91ca\u200b\u4e3a\u8868\u200b\u7684\u200b\u53d8\u66f4\u200b\u65e5\u5fd7\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u7279\u5b9a\u200b\u65f6\u95f4\u200b\u70b9\u200b\u63d0\u4f9b\u200b\u8be5\u8868\u200b\u7684\u200b\u7279\u5b9a\u200b\u7248\u672c\u200b\u3002\u200b\u5c06\u200bappend- only\u200b\u8868\u200b\u89e3\u91ca\u200b\u4e3a\u200b\u53d8\u66f4\u200b\u65e5\u5fd7\u200b\u9700\u8981\u200b\u6307\u5b9a\u200b\u4e3b\u952e\u200b\u5c5e\u6027\u200b\u548c\u200b\u65f6\u95f4\u200b\u6233\u200b\u5c5e\u6027\u200b\u3002\u200b\u4e3b\u952e\u200b\u786e\u5b9a\u200b\u8986\u76d6\u200b\u54ea\u4e9b\u200b\u884c\u200b\uff0c\u200b\u65f6\u95f4\u200b\u6233\u200b\u786e\u5b9a\u200b\u884c\u200b\u6709\u6548\u200b\u7684\u200b\u65f6\u95f4\u200b\u3002</p> <pre><code>SELECT [column_list]\nFROM table1 [AS &lt;alias1&gt;]\n[LEFT] JOIN table2 FOR SYSTEM_TIME AS OF table1.{ proctime | rowtime } [AS &lt;alias2&gt;]\nON table1.column-name1 = table2.column-name1\n</code></pre> <p>\u200b\u4e0e\u200bRegular Joins\u200b\u76f8\u6bd4\u200b\uff0c\u200b\u5c3d\u7ba1\u200b\u6784\u5efa\u200b\u7aef\u200b\u53d1\u751f\u200b\u4e86\u200b\u53d8\u5316\u200b\uff0c\u200b\u4f46\u200b\u4e4b\u524d\u200b\u7684\u200b\u65f6\u6001\u200b\u8868\u200b\u7ed3\u679c\u200b\u4e0d\u4f1a\u200b\u53d7\u5230\u200b\u5f71\u54cd\u200b\u3002\u200b\u4e0e\u200bInterval Joins \u200b\u76f8\u6bd4\u200b\uff0c\u200b\u65f6\u6001\u200b\u8868\u200b\u8fde\u63a5\u200b\u4e0d\u200b\u5b9a\u4e49\u200b\u8bb0\u5f55\u200b\u5c06\u200b\u5728\u200b\u5176\u4e2d\u200b\u8fde\u63a5\u200b\u7684\u200b\u65f6\u95f4\u200b\u7a97\u53e3\u200b\u3002 \u200b\u6765\u81ea\u200b\u63a2\u6d4b\u200b\u7aef\u7684\u200b\u8bb0\u5f55\u200b\u603b\u662f\u200b\u5728\u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\u6307\u5b9a\u200b\u7684\u200b\u65f6\u95f4\u200b\u4e0e\u200b\u6784\u5efa\u200b\u7aef\u7684\u200b\u7248\u672c\u200b\u8fde\u63a5\u200b\u3002 \u200b\u56e0\u6b64\u200b\uff0c\u200b\u6784\u5efa\u200b\u7aef\u7684\u200b\u884c\u200b\u53ef\u80fd\u200b\u662f\u200b\u4efb\u610f\u200b\u65e7\u200b\u7684\u200b\u3002\u200b\u968f\u7740\u200b\u65f6\u95f4\u200b\u7684\u200b\u63a8\u79fb\u200b\uff0c\u200b\u4e0d\u518d\u200b\u9700\u8981\u200b\u7684\u200b\u8bb0\u5f55\u200b\u7248\u672c\u200b\uff08\u200b\u5bf9\u4e8e\u200b\u7ed9\u5b9a\u200b\u7684\u200b\u4e3b\u952e\u200b\uff09\u200b\u5c06\u200b\u4ece\u200b\u72b6\u6001\u200b\u4e2d\u200b\u5220\u9664\u200b\u3002</p> <p>\u200b\u65f6\u6001\u200b\u8868\u200b\u603b\u7ed3\u200b\uff1a</p> <p>Temporal Table \u200b\u53ef\u200b\u63d0\u4f9b\u200b\u5386\u53f2\u200b\u67d0\u4e2a\u200b\u65f6\u95f4\u200b\u70b9\u4e0a\u200b\u7684\u200b\u6570\u636e\u200b\u3002 Temporal Table \u200b\u6839\u636e\u200b\u65f6\u95f4\u200b\u6765\u200b\u8ddf\u8e2a\u200b\u7248\u672c\u200b\u3002 Temporal Table \u200b\u9700\u8981\u200b\u63d0\u4f9b\u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\u548c\u200b\u4e3b\u952e\u200b\uff0cjoin\u200b\u65f6\u200b\u4e3b\u952e\u200b\u5fc5\u987b\u200b\u5728\u200b\u5173\u8054\u200b\u6761\u4ef6\u200b\u4e2d\u200b\u3002 Temporal Table \u200b\u5728\u200bProcessingTime\u200b\u573a\u666f\u200b\u5173\u952e\u8bcd\u200b LATERAL TABLE \u200b\u7ed3\u5408\u200b\u4f7f\u7528\u200b\u3002 Temporal Table \u200b\u5728\u200b\u57fa\u4e8e\u200b ProcessingTime \u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\u5904\u7406\u200b\u65f6\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u4e3b\u952e\u200b\u53ea\u200b\u4fdd\u5b58\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\u7684\u200b\u6570\u636e\u200b\u3002 Temporal Table \u200b\u5728\u200b\u57fa\u4e8e\u200b EventTime \u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\u5904\u7406\u200b\u65f6\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u4e3b\u952e\u200b\u4fdd\u5b58\u200b\u4ece\u200b\u4e0a\u200b\u4e2a\u200b Watermark \u200b\u5230\u200b\u5f53\u524d\u200b\u7cfb\u7edf\u200b\u65f6\u95f4\u200b\u7684\u200b\u6240\u6709\u200b\u7248\u672c\u200b\u3002 Append-Only \u200b\u8868\u200b Join \u200b\u53f3\u4fa7\u200b Temporal Table \uff0c\u200b\u672c\u8d28\u200b\u4e0a\u200b\u8fd8\u662f\u200b\u5de6\u8868\u200b\u9a71\u52a8\u200b Join \uff0c\u200b\u5373\u200b\u4ece\u200b\u5de6\u8868\u200b\u62ff\u5230\u200b Key \uff0c\u200b\u6839\u636e\u200b Key \u200b\u548c\u200b\u65f6\u95f4\u200b(\u200b\u53ef\u80fd\u200b\u662f\u200b\u5386\u53f2\u200b\u65f6\u95f4\u200b)\u200b\u53bb\u200b\u53f3\u4fa7\u200b Temporal Table \u200b\u8868\u4e2d\u200b\u67e5\u8be2\u200b\u3002 Temporal Table Join \u200b\u76ee\u524d\u200b\u53ea\u200b\u652f\u6301\u200b Inner Join\u200b\u548c\u200b LEFT JOIN\u3002 Temporal Table Join \u200b\u65f6\u200b\uff0c\u200b\u53f3\u4fa7\u200b Temporal Table \u200b\u8868\u200b\u8fd4\u56de\u200b\u6700\u65b0\u200b\u4e00\u4e2a\u200b\u7248\u672c\u200b\u7684\u200b\u6570\u636e\u200b\u3002 \u200b\u9002\u7528\u200b\u573a\u666f\u200b\uff1a\u200b\u6d41\u200b\u548c\u200b\u7ef4\u5ea6\u200b\u8868\u200b join  </p> <p>\u200b\u6d4b\u8bd5\u200b\u603b\u7ed3\u200b\uff1a \u200b\u4f7f\u7528\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\uff1a \u200b\u5de6\u4fa7\u200b\u4e3a\u200b\u6d41\u8868\u200b\u3001\u200b\u53f3\u4fa7\u200b\u4e3a\u200b\u7248\u672c\u200b\u8868\u200b\uff08\u200b\u5728\u200b Flink \u200b\u4e2d\u200b\uff0c\u200b\u5b9a\u4e49\u200b\u4e86\u200b\u4e3b\u952e\u200b\u7ea6\u675f\u200b\u548c\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\u7684\u200b\u8868\u200b\u5c31\u662f\u200b\u7248\u672c\u200b\u8868\u200b\uff09 \u200b\u4e24\u4fa7\u200b\u8868\u90fd\u200b\u9700\u8981\u200b\u6307\u5b9a\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b \u200b\u7248\u672c\u200b\u8868\u200b\u7684\u200b\u6570\u636e\u200b\u4f1a\u200b\u6301\u7eed\u200b\u589e\u52a0\u200b \u200b\u53f3\u8868\u200b\uff08\u200b\u7248\u672c\u200b\u8868\u200b\uff09\u200b\u7684\u200bupdate_time\u200b\u5c0f\u4e8e\u200b\u5de6\u8868\u200b\u7684\u200b\u65f6\u95f4\u200b \u200b\u4e24\u4fa7\u200b\u8868\u90fd\u200b\u9700\u8981\u200b\u8bbe\u7f6e\u200bwatermark\uff0c\u200b\u7248\u672c\u200b\u8868\u200b\u9700\u8981\u200b\u8bbe\u7f6e\u200b\u4e3b\u952e\u200b\uff0c\u200b\u4e3b\u952e\u200b\u5fc5\u987b\u200b\u5305\u542b\u200b\u5728\u200b JOIN \u200b\u7b49\u503c\u200b\u6761\u4ef6\u200b\u4e2d\u200b \u200b\u5e76\u4e14\u200b\u7ecf\u8fc7\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u53f3\u8868\u200b\u6570\u636e\u200b\u8fdb\u884c\u200b\u66f4\u65b0\u200b\u7684\u200b\u65f6\u5019\u200b\u624d\u200b\u4f1a\u200b\u8fdb\u884c\u200b\u5199\u5165\u200b\u3002 \u200b\u539f\u56e0\u200b\u4e3a\u200bwatermark\u200b\u6c34\u4f4d\u200b\u7ebf\u200b\u8d77\u5230\u200b\u4e00\u4e2a\u200b\u89e6\u53d1\u200b\u5199\u51fa\u200b\u7684\u200b\u4f5c\u7528\u200b\uff0c\u200b\u5728\u200b\u5199\u51fa\u200b\u4e4b\u524d\u200b\uff0c\u200b\u5de6\u53f3\u200b\u6d41\u200b\u7684\u200b\u5143\u7d20\u200b\u5728\u200b\u7f13\u5b58\u200b\u4e2d\u200bjoin\u3002\u200b\u5e76\u4e14\u200bFlink\u200b\u4f1a\u200b\u9009\u62e9\u200b\u4f7f\u7528\u200bwatermark\u200b\u8f83\u200b\u5c0f\u200b\u7684\u200b\u90a3\u4e2a\u200b\u8868\u200b\u7684\u200bwatermark\u200b\u4f5c\u4e3a\u200b\u6574\u4e2a\u200bJoin\u200b\u64cd\u4f5c\u200b\u7684\u200bwatermark\u3002</p> <pre><code>--\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\uff1a\n\n-- \u200b\u6d41\u8868\u200b\n-- \u200b\u5fc5\u987b\u200b\u6761\u4ef6\u200b\uff1aWATERMARK\nCREATE TABLE orders (\n    order_id INT,\n    price INT,\n    currency STRING,\n    order_time TIMESTAMP(3),\n    WATERMARK FOR order_time AS order_time WITH (\n        'connector' = 'postgres-cdc',\n        'hostname' = 'localhost',\n        'port' = '15432',\n        'username' = 'postgres',\n        'password' = 'xxx',\n        'database-name' = 'flink_test',\n        'schema-name' = 'public',\n        'table-name' = 'orders',\n        'slot.name' = 'orders',\n    'debezium.plugin.name' = 'pgoutput' + \n);\n-- \u200b\u7248\u672c\u200b\u8868\u200b\n-- \u200b\u5fc5\u987b\u200b\u6761\u4ef6\u200b\uff1aWATERMARK\u3001PRIMARY KEY\nCREATE TABLE currency_rates ( \ncurrency STRING, \nconversion_rate BIGINT, \nupdate_time TIMESTAMP(3), \nWATERMARK FOR update_time AS update_time, \nPRIMARY KEY (currency) NOT ENFORCED ) \nWITH (\n    'connector' = 'postgres-cdc',\n    'hostname' = 'localhost',\n    'port' = '15432',\n    'username' = 'postgres',\n    'password' = 'xxxx',\n    'database-name' = 'flink_test',\n    'schema-name' = 'public',\n    'table-name' = 'currency_rates',\n    'slot.name' = 'currency_rates',\n'debezium.plugin.name' = 'pgoutput' \n);\n\nINSERT INTO RESULT SELECT\n    order_id,\n    price,\n    orders.currency,\n    conversion_rate,\n    order_time,\n    update_time \nFROM\n    orders\nLEFT JOIN currency_rates FOR SYSTEM_TIME AS OF orders.order_time ON orders.currency = currency_rates.currency\n\n\n--\u200b\u5904\u7406\u200b\u65f6\u95f4\u200b\uff1a\n-- \u200b\u6d41\u8868\u200b\n-- \u200b\u5fc5\u8981\u6761\u4ef6\u200b\uff1aPROCTIME()\nCREATE TABLE orders ( \n    order_id INT, \n    price INT,\n    ` currency ` STRING, \n    proctime AS PROCTIME ()\n    ) \n    WITH (\n    'connector' = 'postgres-cdc',\n    'hostname' = 'localhost',\n    'port' = '15432',\n    'username' = 'postgres',\n    'password' = 'xxxx',\n    'database-name' = 'flink_test',\n    'schema-name' = 'public',\n    'table-name' = 'orders',\n    'slot.name' = 'orders',\n'debezium.plugin.name' = 'pgoutput' \n);\n\n--\nCREATE TABLE currency_rates ( \n    currency STRING, \n    conversion_rate BIGINT, \n    update_time TIMESTAMP (3), \n    ` proc_time ` AS PROCTIME ()\n    )\n    WITH (\n    'connector' = 'postgres-cdc',\n    'hostname' = 'localhost',\n    'port' = '15432',\n    'username' = 'postgres',\n    'password' = 'xxxx',\n    'database-name' = 'flink_test',\n    'schema-name' = 'public',\n    'table-name' = 'currency_rates',\n    'slot.name' = 'currency_rates',\n'debezium.plugin.name' = 'pgoutput' \n)\n-- \u200b\u6ce8\u518c\u200b\u4e3a\u200bTemporalTable\nTemporalTableFunction rates = tableEnv.from(\"currency_rates\").createTemporalTableFunction($(\"proc_time\"), $(\"currency\"));\ntableEnv.createTemporarySystemFunction(\"rates\", rates);\n\nSELECT\n*\nFROM orders o,\nLATERAL TABLE (rates(proctime)) c\nwhere o.currency = c.currency \n</code></pre>"},{"location":"bigdata/flink/#_2","title":"\u9047\u5230\u200b\u7684\u200b\u95ee\u9898","text":""},{"location":"bigdata/flink/#1temporal-table-join-requires-time-attribute-in-the-left-table-but-no-time-attribute-found","title":"1.Temporal Table Join requires time attribute in the left table, but no time attribute found.","text":"<p>\u200b\u9700\u8981\u200b\u5b9a\u4e49\u200b\u65f6\u95f4\u200b</p>"},{"location":"bigdata/flink/#2temporal-table-join-requires-primary-key-in-versioned-table-but-no-primary-key-can-be-found","title":"2.Temporal Table Join requires primary key in versioned table, but no primary key can be found.","text":"<p>\u200b\u7248\u672c\u200b\u8868\u200b\u9700\u8981\u200b\u5b9a\u4e49\u200b\u4e3b\u952e\u200b</p>"},{"location":"bigdata/flink/#3processing-time-temporal-join-is-not-supported-yet","title":"3.Processing-time temporal join is not supported yet.","text":"<p>\u200b\u5b98\u7f51\u200b\uff1a Note The reason why the FOR SYSTEM_TIME AS OF syntax used in temporal join with latest version of any table/view is not support is only the semantic consideration, because the join processing for left stream doesn\u2019t wait for the complete snapshot of temporal table, this may mislead users in production environment. The processing-time temporal join by temporal table function also exists same semantic problem, but it has been alive for a long time, thus we support it from the perspective of compatibility. \u200b\u6ce8\u610f\u200b\uff1a\u200b\u5bf9\u4e8e\u200b\u4efb\u4f55\u200b\u8868\u200b/\u200b\u89c6\u56fe\u200b\u7684\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\uff0c\u200b\u4e34\u65f6\u200b\u8fde\u63a5\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u7684\u200bFOR SYSTEM_TIME AS OF\u200b\u8bed\u6cd5\u200b\u4e0d\u200b\u53d7\u200b\u652f\u6301\u200b\u7684\u200b\u539f\u56e0\u200b\u4ec5\u200b\u662f\u200b\u8bed\u4e49\u200b\u8003\u8651\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5de6\u6d41\u200b\u7684\u200b\u8fde\u63a5\u200b\u5904\u7406\u200b\u4e0d\u200b\u7b49\u5f85\u200b\u4e34\u65f6\u200b\u8868\u200b\u7684\u200b\u5b8c\u6574\u200b\u5feb\u7167\u200b\uff0c\u200b\u8fd9\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u8bef\u5bfc\u200b\u751f\u4ea7\u200b\u73af\u5883\u200b\u4e2d\u200b\u7684\u200b\u7528\u6237\u200b\u3002\u200b\u4e34\u65f6\u200b\u8868\u200b\u51fd\u6570\u200b\u7684\u200b\u5904\u7406\u200b\u65f6\u95f4\u200b\u4e34\u65f6\u200b\u8fde\u63a5\u200b\u4e5f\u200b\u5b58\u5728\u200b\u540c\u6837\u200b\u7684\u200b\u8bed\u4e49\u200b\u95ee\u9898\u200b\uff0c\u200b\u4f46\u200b\u5b83\u200b\u5df2\u7ecf\u200b\u5b58\u5728\u200b\u4e86\u200b\u5f88\u200b\u957f\u65f6\u95f4\u200b\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u4ece\u200b\u517c\u5bb9\u6027\u200b\u7684\u200b\u89d2\u5ea6\u200b\u6765\u200b\u652f\u6301\u200b\u5b83\u200b\u3002</p> <p>The result is not deterministic for processing-time. The processing-time temporal join is most often used to enrich the stream with an external table (i.e., dimension table). \u200b\u7ed3\u679c\u200b\u5bf9\u4e8e\u200b\u5904\u7406\u200b\u65f6\u95f4\u200b\u6765\u8bf4\u200b\u662f\u200b\u4e0d\u200b\u786e\u5b9a\u200b\u7684\u200b\u3002\u200b\u5904\u7406\u200b\u65f6\u95f4\u200b\u4e34\u65f6\u200b\u8fde\u63a5\u200b\u6700\u200b\u5e38\u7528\u200b\u4e8e\u200b\u4f7f\u7528\u200b\u5916\u90e8\u200b\u8868\u200b(\u200b\u5373\u200b\u7ef4\u5ea6\u200b\u8868\u200b)\u200b\u6765\u200b\u4e30\u5bcc\u200b\u6d41\u200b\u3002</p> <p>In contrast to regular joins, the previous temporal table results will not be affected despite the changes on the build side. Compared to interval joins, temporal table joins do not define a time window within which the records join, i.e., old rows are not stored in state. \u200b\u4e0e\u200b\u5e38\u89c4\u200b\u8054\u63a5\u200b\u4e0d\u540c\u200b\uff0c\u200b\u5c3d\u7ba1\u200b\u5728\u200b\u6784\u5efa\u200b\u7aef\u200b\u8fdb\u884c\u200b\u4e86\u200b\u66f4\u6539\u200b\uff0c\u200b\u4f46\u200b\u4e4b\u524d\u200b\u7684\u200b\u4e34\u65f6\u200b\u8868\u200b\u7ed3\u679c\u200b\u4e0d\u4f1a\u200b\u53d7\u5230\u200b\u5f71\u54cd\u200b\u3002\u200b\u4e0e\u200binterval joins\u200b\u76f8\u6bd4\u200b\uff0c\u200b\u4e34\u65f6\u200b\u8868\u200b\u8054\u63a5\u200b\u6ca1\u6709\u200b\u5b9a\u4e49\u200b\u8bb0\u5f55\u200b\u8054\u63a5\u200b\u7684\u200b\u65f6\u95f4\u200b\u7a97\u53e3\u200b\uff0c\u200b\u5373\u200b\uff0c\u200b\u65e7\u884c\u200b\u4e0d\u4f1a\u200b\u4ee5\u200b\u72b6\u6001\u200b\u5b58\u50a8\u200b\u3002 \u200b\u4ece\u200bflink 1.14\u200b\u5f00\u59cb\u200b\u5df2\u7ecf\u200b\u4e0d\u518d\u200b\u652f\u6301\u200b\u8fd9\u79cd\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200btemporal table function\u200b\u8bed\u6cd5\u200b\u66ff\u6362\u200b\u3002</p> <p>temporal table function: \u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200bTable API\u200b\u5728\u200b\u4ec5\u200b\u9644\u52a0\u200b\u6d41\u200b\u4e4b\u4e0a\u200b\u5b9a\u4e49\u200b\u65f6\u6001\u200b\u8868\u200b\u51fd\u6570\u200b\u3002\u200b\u8be5\u8868\u200b\u6ce8\u518c\u200b\u6709\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b\u952e\u5217\u200b\uff0c\u200b\u4ee5\u53ca\u200b\u4e00\u4e2a\u200b\u7528\u4e8e\u200b\u7248\u672c\u63a7\u5236\u200b\u7684\u200btime\u200b\u5c5e\u6027\u200b\u3002 <pre><code>SELECT * FROM currency_rates;\n\nupdate_time   currency   rate\n============= =========  ====\n09:00:00      Yen        102\n09:00:00      Euro       114\n09:00:00      USD        1\n11:15:00      Euro       119\n11:49:00      Pounds     108\n</code></pre> <pre><code>TemporalTableFunction rates = tEnv\n    .from(\"currency_rates\").\n    .createTemporalTableFunction(\"update_time\", \"currency\");\n\ntEnv.registerFunction(\"rates\", rates);                \n</code></pre></p> <p>\u200b\u53f3\u8868\u200b\u5b9a\u4e49\u200bprocess-time\u200b\u5c5e\u6027\u200b\uff0c\u200b\u603b\u662f\u200b\u80fd\u200b\u5173\u8054\u200b\u5230\u200b\u6700\u65b0\u200b\u7684\u200b\u53f3\u8868\u200b\u8bb0\u5f55\u200b\uff0c\u200b\u5176\u5b9e\u200b\u8fd9\u200b\u548c\u200blookup join\u200b\u5dee\u4e0d\u591a\u200b\uff0c\u200b\u53ea\u4e0d\u8fc7\u200b\u53f3\u8868\u200b\u7684\u200b\u8bb0\u5f55\u200b\u662f\u200b\u4ee5\u200bHashMap\u200b\u5168\u90e8\u200b\u4fdd\u5b58\u200b\u7740\u200b\u6700\u65b0\u200b\u7684\u200b\u7248\u672c\u200b\u5728\u200b\u72b6\u6001\u200b\u4e2d\u200b\u3002\u200b\u8fd9\u79cd\u200b\u65b9\u5f0f\u200b\u7684\u200b\u5f3a\u5927\u200b\u4e4b\u200b\u5904\u200b\u5728\u4e8e\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u76f4\u63a5\u200b\u5bf9\u63a5\u200b\u4e0d\u80fd\u200b\u53d8\u6210\u200bflink\u200b\u52a8\u6001\u200b\u8868\u200b\u7684\u200b\u5916\u90e8\u200b\u8868\u200b\uff08\u200b\u4f8b\u5982\u200bhbase\uff09 \u200b\u4e0e\u200bregular joins\u200b\u76f8\u6bd4\u200b\uff0c\u200b\u53f3\u8868\u200b\u7684\u200b\u6570\u636e\u200b\u53d8\u5316\u200b\u4e0d\u4f1a\u200b\u5f71\u54cd\u200b\u5230\u200b\u4e4b\u524d\u200b\u5df2\u7ecf\u200bjoin\u200b\u51fa\u200b\u7684\u200b\u7ed3\u679c\u200b \u200b\u4e0e\u200binterval joins\u200b\u76f8\u6bd4\u200b\uff0c\u200b\u4e0d\u200b\u9700\u8981\u200b\u5b9a\u4e49\u200b\u65f6\u95f4\u200b\u7a97\u53e3\u200b\uff0c\u200b\u4e14\u200b\u6240\u6709\u200b\u65e7\u7248\u672c\u200b\u6570\u636e\u200b\u90fd\u200b\u4e0d\u4f1a\u200b\u4fdd\u5b58\u200b\u5728\u200b\u72b6\u6001\u200b\u4e2d\u200b</p>"},{"location":"bigdata/flink/#loopup-join","title":"Loopup Join","text":"<p>Loopup Join\u200b\u901a\u5e38\u200b\u7528\u4e8e\u200b\u4f7f\u7528\u200b\u4ece\u200b\u5916\u90e8\u200b\u7cfb\u7edf\u200b\u67e5\u8be2\u200b\u7684\u200b\u6570\u636e\u200b\u6765\u200b\u4e30\u5bcc\u200b\u8868\u200b\u3002\u200b\u8981\u6c42\u200b\u4e00\u4e2a\u200b\u8868\u200b\u5177\u6709\u200b\u5904\u7406\u200b\u65f6\u95f4\u200b\u5c5e\u6027\u200b\uff0c\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u8868\u7531\u200b\u67e5\u627e\u200b\u6e90\u200b\u8fde\u63a5\u5668\u200b\u652f\u6301\u200b\u3002 Loopup Join\u200b\u4ec5\u200b\u652f\u6301\u200b\u4f7f\u7528\u200b\u5904\u7406\u200b\u65f6\u95f4\u200bProcessing Time \u200b\u5373\u200b\u7528\u4e8e\u200b\u6d41\u8868\u200b\u4e0e\u200b\u7ef4\u5ea6\u200b\u8868\u200b\u5173\u8054\u200b\u7684\u200b\u573a\u666f\u200b <pre><code>CREATE TABLE orders ( \n    order_id INT, \n    price INT,\n    ` currency ` STRING, \n    proctime AS PROCTIME ()\n    ) \n    WITH (\n    'connector' = 'postgres-cdc',\n    'hostname' = 'localhost',\n    'port' = '15432',\n    'username' = 'postgres',\n    'password' = 'xxxx',\n    'database-name' = 'flink_test',\n    'schema-name' = 'public',\n    'table-name' = 'orders',\n    'slot.name' = 'orders',\n'debezium.plugin.name' = 'pgoutput' \n);\n\n-- \u200b\u4f7f\u7528\u200bjdbc\u200b\u800c\u200b\u4e0d\u662f\u200bcdc\nCREATE TABLE currency_rates ( \n    currency STRING, \n    conversion_rate BIGINT, \n    update_time TIMESTAMP (3), \n    ` proc_time ` AS PROCTIME () )\nWITH ( \n    'connector' = 'jdbc', \n    'url' = 'jdbc:postgresql://localhost:15432/flink_test', \n    'username' = 'postgres', \n    'password' = 'xxxx', \n    'table-name' = 'currency_rates')\n\n\nSELECT\n*\nFROM orders o\nLEFT JOIN currency_rates FOR SYSTEM_TIME AS OF o.proctime AS c\non o.currency = c.currency \n</code></pre></p>"},{"location":"bigdata/flink/#_3","title":"\u4e00\u4e9b\u200b\u4f7f\u7528\u200b\u6280\u5de7","text":""},{"location":"bigdata/flink/#_4","title":"\u7981\u7528\u200b\u4efb\u52a1\u200b\u94fe","text":"<pre><code># \u200b\u5168\u5c40\u200b\u7981\u7528\u200b\nenv.disableOperatorChaining();\n# \u200b\u5355\u200b\u7b97\u5b50\u200b\n.flatMap(_.split(\" \")).disableChaining();\n</code></pre>"},{"location":"bigdata/flink/#rocksdb","title":"RocksDB","text":"<pre><code>EmbeddedRocksDBStateBackend rocksDB = new EmbeddedRocksDBStateBackend(true);\nrocksDB.setPredefinedOptions(PredefinedOptions.SPINNING_DISK_OPTIMIZED_HIGH_MEM);\nenv.setStateBackend(rocksDB);\n</code></pre>"},{"location":"bigdata/flink/#checkpoint","title":"Checkpoint","text":"<pre><code>env.enableCheckpointing(30000);\nenv.getCheckpointConfig().setTolerableCheckpointFailureNumber(1);\nenv.getCheckpointConfig().setMinPauseBetweenCheckpoints(60000);\nenv.getCheckpointConfig().setCheckpointTimeout(600000);\nenv.getCheckpointConfig().setCheckpointStorage(new FileSystemCheckpointStorage(\"hdfs://xxx:9000/flink/checkpoints/xxx\"));\n</code></pre>"},{"location":"bigdata/git/","title":"git","text":"<pre><code># \u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u5939\u200brec\uff0c\u200b\u521d\u59cb\u5316\u200bGit\u200b\u5e76\u200b\u5c06\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u5185\u5bb9\u200b\u62c9\u53d6\u200b\u5230\u200b\u672c\u5730\u200b\nmkdir rec  # \u200b\u65b0\u5efa\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u5939\u200b\ncd rec\ngit init  # \u200b\u521d\u59cb\u5316\u200bGit\ngit pull http://gitlab.****.git  # \u200b\u4ece\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u62c9\u53d6\u200b\u5185\u5bb9\u200b\u5230\u200b\u672c\u5730\u200b\n\n# \u200b\u8fd9\u200b\u4e00\u6b65\u200b\u8fdb\u884c\u200b\u4fee\u6539\u200b\uff0c\u200b\u5982\u200b\u65b0\u589e\u200b\u3001\u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u7b49\u200b\ngit init\ngit add .  # \u200b\u5c06\u200b\u65b0\u589e\u200b\u7684\u200b\u6587\u4ef6\u200b/\u200b\u6587\u4ef6\u5939\u200b\u6dfb\u52a0\u200b\u5230\u200b\u672c\u5730\u200bGit\u200b\u5e93\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b`.`\u200b\u6765\u200b\u6dfb\u52a0\u200b\u6240\u6709\u200b\u6587\u4ef6\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5355\u72ec\u200b\u6dfb\u52a0\u200b\u6587\u4ef6\u200b\ngit remote add origin http://gitlab.****.git\ngit remote add origin http://gitlab.****.git\ngit commit -m \"My commit\"\n\n# \u200b\u83b7\u53d6\u200b\u8fdc\u7a0b\u200b\u5e93\u200b\u4e0e\u200b\u672c\u5730\u200b\u540c\u6b65\u200b\u5408\u5e76\u200b\ngit pull --rebase origin master # \u200b\u4f7f\u7528\u200bgit pull\u200b\u53ef\u4ee5\u200b\u4ece\u200b\u8fdc\u7a0b\u200b\u83b7\u53d6\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\u5e76\u200b\u81ea\u52a8\u200b\u5408\u5e76\u200b\u5230\u200b\u672c\u5730\u200b\ngit push -u origin master # \u200b\u4f7f\u7528\u200bgit pull\u200b\u76f8\u5f53\u4e8e\u200b\u6267\u884c\u200bgit fetch\u200b\u548c\u200bgit merge\u3002\n</code></pre>"},{"location":"bigdata/git/#gitignore","title":"gitignore","text":"<pre><code># \u200b\u7528\u4e8e\u200b\u63d0\u4ea4\u200b\u65f6\u200b\u9ed8\u8ba4\u200b\u88ab\u200b\u5ffd\u7565\u200b\u7684\u200b\u6587\u4ef6\u200b\n/shelf/\nworkspace.xml\n.idea/misc.xml\n.idea/workspace.xml\n.idea/vcs.xml\n.idea\n*.pyc\n/log\n</code></pre>"},{"location":"bigdata/git/#gitignoreideagit","title":"\u5982\u679c\u200b.gitignore\u200b\u6587\u4ef6\u200b\u662f\u200b\u540e\u7eed\u200b\u6dfb\u52a0\u200b\u7684\u200b\uff0c\u200b\u9996\u5148\u200b\u9700\u8981\u200b\u6e05\u9664\u200b.idea\u200b\u76ee\u5f55\u200b\u7684\u200bGit\u200b\u7f13\u5b58\u200b\uff1a","text":"<pre><code>git rm -r -f __pycache__/\ngit rm -r --cached .idea\n</code></pre>"},{"location":"bigdata/git/#_1","title":"\u9047\u5230\u200b\u7684\u200b\u95ee\u9898\u200b\u4e00\u200b\uff1a","text":"<pre><code>! [rejected] master -&gt; master (non-fast-forward)\nerror: failed to push some refs to 'xxx.git'\n</code></pre>"},{"location":"bigdata/git/#git-pull","title":"\u89e3\u51b3\u529e\u6cd5\u200b\uff1a\u200b\u6267\u884c\u200b git pull\u3002","text":""},{"location":"bigdata/git/#_2","title":"\u9047\u5230\u200b\u7684\u200b\u95ee\u9898\u200b\u4e8c\u200b\uff1a","text":"<pre><code>error: The following untracked working tree files would be overwritten by ...\n</code></pre>"},{"location":"bigdata/git/#git-clean-d-fx","title":"\u89e3\u51b3\u529e\u6cd5\u200b\uff1a\u200b\u6267\u884c\u200b git clean -d -fx \u200b\u6e05\u9664\u200b\u672a\u200b\u8ddf\u8e2a\u200b\u7684\u200b\u6587\u4ef6\u200b\uff1a","text":"<pre><code>git clean -d -fx\n</code></pre>"},{"location":"bigdata/git/#_3","title":"\u5408\u5e76\u200b\u4ee3\u7801\u200b\u7684\u200b\u95ee\u9898","text":"<pre><code>//\u200b\u67e5\u8be2\u200b\u5f53\u524d\u200b\u8fdc\u7a0b\u200b\u7684\u200b\u7248\u672c\u200b\n$ git remote -v\n//\u200b\u83b7\u53d6\u200b\u6700\u65b0\u200b\u4ee3\u7801\u200b\u5230\u200b\u672c\u5730\u200b\n$ git fetch origin master  [\u200b\u793a\u4f8b\u200b1\uff1a\u200b\u83b7\u53d6\u200b\u8fdc\u200b\u7aef\u7684\u200borigin/master\u200b\u5206\u652f\u200b]\n$ git fetch origin dev [\u200b\u793a\u4f8b\u200b2\uff1a\u200b\u83b7\u53d6\u200b\u8fdc\u200b\u7aef\u7684\u200borigin/dev\u200b\u5206\u652f\u200b]\n//\u200b\u67e5\u770b\u200b\u7248\u672c\u200b\u5dee\u5f02\u200b\n$ git log -p master..origin/master [\u200b\u793a\u4f8b\u200b1\uff1a\u200b\u67e5\u770b\u200b\u672c\u5730\u200bmaster\u200b\u4e0e\u200b\u8fdc\u7aef\u200borigin/master\u200b\u7684\u200b\u7248\u672c\u200b\u5dee\u5f02\u200b]\n$ git log -p dev..origin/dev   [\u200b\u793a\u4f8b\u200b2\uff1a\u200b\u67e5\u770b\u200b\u672c\u5730\u200bdev\u200b\u4e0e\u200b\u8fdc\u7aef\u200borigin/dev\u200b\u7684\u200b\u7248\u672c\u200b\u5dee\u5f02\u200b]\n//\u200b\u5408\u5e76\u200b\u6700\u65b0\u200b\u4ee3\u7801\u200b\u5230\u200b\u672c\u5730\u200b\u5206\u652f\u200b\n$ git merge origin/master  [\u200b\u793a\u4f8b\u200b1\uff1a\u200b\u5408\u5e76\u200b\u8fdc\u7aef\u200b\u5206\u652f\u200borigin/master\u200b\u5230\u200b\u5f53\u524d\u200b\u5206\u652f\u200b]\n$ git merge origin/dev [\u200b\u793a\u4f8b\u200b2\uff1a\u200b\u5408\u5e76\u200b\u8fdc\u7aef\u200b\u5206\u652f\u200borigin/dev\u200b\u5230\u200b\u5f53\u524d\u200b\u5206\u652f\u200b]\n</code></pre>"},{"location":"bigdata/git/#git-pullgit-fetch","title":"git pull\u200b\u548c\u200bgit fetch","text":""},{"location":"bigdata/git/#_4","title":"git","text":"<p>git  pull(\u200b\u62c9\u53d6\u200b)  \u200b\u5373\u200b\u4ece\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u6293\u53d6\u200b\u672c\u5730\u200b\u6ca1\u6709\u200b\u7684\u200b\u4fee\u6539\u200b\u5e76\u200b\u3010\u200b\u81ea\u52a8\u200b\u5408\u5e76\u200b\u3011\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u5206\u652f\u200b     git pull origin master</p> <p>git  fetch(\u200b\u63d0\u53d6\u200b) \u200b\u4ece\u200b\u8fdc\u7a0b\u200b\u83b7\u53d6\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\u5230\u200b\u672c\u5730\u200b\u4e0d\u4f1a\u200b\u81ea\u52a8\u200b\u5408\u5e76\u200b   git fetch  origin master <pre><code>//\u200b\u5148\u200b\u67e5\u770b\u200b\u72b6\u6001\u200b\uff0c\u200b\u662f\u5426\u200b\u6709\u200b\u6539\u52a8\u200b\ngit status\n//\u200b\u628a\u200b\u66f4\u65b0\u200b\u7684\u200b\u4ee3\u7801\u200b\u6dfb\u52a0\u200b\u5230\u200b\u6682\u5b58\u533a\u200b\ngit add [xxx]  //xxx\u200b\u4e3a\u200b\u6587\u4ef6\u540d\u200b\uff0c\n/*\ngit add . \u200b\u4f1a\u200b\u628a\u200b\u672c\u5730\u200b\u6240\u6709\u200buntrack\u200b\u7684\u200b\u6587\u4ef6\u200b\u90fd\u200b\u52a0\u5165\u200b\u6682\u5b58\u533a\u200b\uff0c\u200b\u5e76\u4e14\u200b\u4f1a\u200b\u6839\u636e\u200b.gitignore\u200b\u505a\u200b\u8fc7\u6ee4\u200b\u3002\ngit add * \u200b\u4f1a\u200b\u5ffd\u7565\u200b.gitignore\u200b\u628a\u200b\u4efb\u4f55\u200b\u6587\u4ef6\u200b\u90fd\u200b\u52a0\u5165\u200b\u3002\n*/\n//\u200b\u5c06\u200b\u6682\u5b58\u533a\u200b\u7684\u200b\u66f4\u65b0\u200b\u63d0\u4ea4\u200b\u5230\u200b\u4ed3\u5e93\u533a\u200b\u3002\ngit commit -m \"\u3010\u200b\u66f4\u65b0\u200b\u3011\u200b\u66f4\u65b0\u200b\u8bf4\u660e\u200b\"\n//\u200b\u5148\u200bgit pull,\u200b\u62c9\u53d6\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u6240\u6709\u200b\u5206\u652f\u200b\u66f4\u65b0\u200b\u5e76\u200b\u5408\u5e76\u200b\u5230\u200b\u672c\u5730\u200b\ngit pull\n//\u200b\u5c06\u200b\u672c\u5730\u200b\u5206\u652f\u200b\u7684\u200b\u66f4\u65b0\u200b\u5168\u90e8\u200b\u63a8\u9001\u200b\u5230\u200b\u8fdc\u7a0b\u200b\u4ed3\u5e93\u200b\u3002\ngit push origin master\n//\u200b\u518d\u6b21\u200b\u67e5\u770b\u200b\u72b6\u6001\u200b\uff0c\u200b\u770b\u200b\u662f\u5426\u200b\u8fd8\u6709\u200b\u6587\u4ef6\u200b\u6ca1\u200b\u63a8\u9001\u200b\n    git status\n</code></pre></p>"},{"location":"bigdata/git/#gitlabgithubpush","title":"gitlab\u200b\u7684\u200b\u8d26\u53f7\u200b\u4e0e\u200bgithub\u200b\u51b2\u7a81\u200bpush\u200b\u4e0d\u4e86\u200b\u7684\u200b\u95ee\u9898","text":"<pre><code>git config user.name \"woo\" #\u200b\u6539\u4e3a\u200bgithub\u200b\u7684\u200b\u8d26\u53f7\u200b\ngit config user.email \"xxx@qq.com\"\ngit remote rm origin #\u200b\u79fb\u9664\u200b\ngit remote add origin https://github.com/Klring/wwlblog #\u200b\u91cd\u65b0\u200b\u6dfb\u52a0\u200b\n</code></pre>"},{"location":"bigdata/git/#_5","title":"\u8bbe\u7f6e\u200b\u4ee3\u7406","text":"<pre><code>git config http.proxy 127.0.0.1:7890\ngit config https.proxy 127.0.0.1:7890\n\u200b\u5168\u5c40\u200b+  --global\n\u200b\u53d6\u6d88\u200b\u4ee3\u7406\u200b\ngit config --global --unset https.proxy\ngit config --global --unset http.proxy\n</code></pre>"},{"location":"bigdata/hudi/","title":"hudi","text":""},{"location":"bigdata/hudi/#_1","title":"\u4e00\u200b\u3001\u200b\u6307\u5357","text":""},{"location":"bigdata/hudi/#1clean","title":"1\u3001Clean\u200b\u547d\u4ee4","text":"<pre><code>spark-submit \\\n--master yarn \\\n--driver-memory 8G \\\n--executor-memory 12G \\\n--executor-cores 6 \\\n--num-executors 15 \\\n--quque spark \\\n--conf 'spark.network.timeout=10000000' \\\n--conf 'spark.executor.heartbeatInterval=10000000' \\\n--conf 'spark.kryoserializer.buffer.max=512m' \\\n--conf 'spark.shuffle.memoryFraction=0.4' \n--class org.apache.hudi.utilities.HoodieCleaner xxx/hudi-utilities-bundle_2.12-0.11.1.jar \\\n--target-base-path xxx \\\n--hoodie-conf hoodie.cleaner.policy=KEEP_LATEST_FILE_VERSIONS \\\n--hoodie-conf hoodie.cleaner.fileversions.retained=1 \\\n--hoodie-conf hoodie.cleaner.parallelism=1200\n</code></pre>"},{"location":"bigdata/hudi/#2cluster","title":"2\u3001cluster\u200b\u547d\u4ee4","text":"<pre><code>vi /clusteringjob_partition.properties\nclustering.plan.partition.filter.mode=SELECTED_PARTITIONS\nhoodie.clustering.plan.strategy.cluster.begin.partition=2023-02-27\nhoodie.clustering.plan.strategy.cluster.end.partition=2023-02-27\nhoodie.clustering.plan.strategy.target.file.max.bytes=1073741824\nhoodie.clustering.plan.strategy.small.file.limit=629145600\n\n# HoodieClusteringJob\nspark-submit \\\n--master yarn \\\n--driver-memory 8G \\\n--executor-memory 12G \\\n--executor-cores 6 \\\n--num-executors 15 \\\n--queue spark \\\n--conf 'spark.network.timeout=10000000' \\\n--conf 'spark.executor.heartbeatInterval=10000000' \\\n--conf 'spark.kryoserializer.buffer.max=512m' \\\n--conf 'spark.shuffle.memoryFraction=0.4' \\\n--class org.apache.hudi.utilities.HoodieClusteringJob xxx/hudi-utilities-bundle_2.12-0.11.1.jar \\\n--props xxx/clusteringjob_partition.properties \\\n--mode scheduleAndExecute \\\n--base-path xxx \\\n--table-name xxx \\\n--spark-memory 12g\n\n# HoodieDeltaStreamer\nspark-submit \\\n--master yarn \\\n--class org.apache.hudi.utilities.deltastreamer.HoodieDeltaStreamer \\\nxxx/hudi-utilities-bundle_2.12-0.11.1.jar \\\n--props xxx/clusteringjob.properties  \\\n--schemaprovider-class org.apache.hudi.utilities.schema.SchemaRegistryProvider \\\n--source-class org.apache.hudi.utilities.sources.AvroKafkaSource \\\n--source-ordering-field impresssiontime \\\n--table-type COPY_ON_WRITE \\\n--target-base-path xxx/ \\\n--target-table xxx \\\n--op INSERT \\\n--hoodie-conf hoodie.clustering.async.enabled=true \\\n--continuous\n</code></pre>"},{"location":"bigdata/hudi/#3hudi-cli","title":"3\u3001hudi-cli\u200b\u7528\u6cd5","text":"<pre><code>1\u3001\u200b\u5f15\u5165\u200bobs\nexport CLIENT_JAR=xxx/hadoop-3.2.3/share/hadoop/tools/lib/hadoop-huaweicloud-3.2.3-hw-46.jar\n2\u3001\u200b\u8fdb\u5165\u200b\n./hudi-cli.sh\n3\u3001\u200b\u8fde\u63a5\u200b\u8868\u200b\nconnect --path xxx\n4\u3001\u200b\u5bf9\u8868\u200b\u8fdb\u884c\u200b\u64cd\u4f5c\u200b\n</code></pre>"},{"location":"bigdata/hudi/#4hudipayload","title":"4\u3001Hudi\u200b\u7684\u200bPayload","text":"<p>Hudi \u200b\u7684\u200bPayload\u200b\u662f\u200b\u4e00\u79cd\u200b\u53ef\u200b\u6269\u5c55\u200b\u7684\u200b\u6570\u636e\u5904\u7406\u200b\u673a\u5236\u200b\uff0c\u200b\u901a\u8fc7\u200b\u4e0d\u540c\u200b\u7684\u200bPayload\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5b9e\u73b0\u200b\u590d\u6742\u200b\u573a\u666f\u200b\u7684\u200b\u5b9a\u5236\u200b\u5316\u200b\u6570\u636e\u200b\u5199\u5165\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u5927\u5927\u589e\u52a0\u200b\u4e86\u200b\u6570\u636e\u5904\u7406\u200b\u7684\u200b\u7075\u6d3b\u6027\u200b\u3002Hudi Payload\u200b\u5728\u200b\u5199\u5165\u200b\u548c\u200b\u8bfb\u53d6\u200bHudi\u200b\u8868\u65f6\u200b\u5bf9\u200b\u6570\u636e\u200b\u8fdb\u884c\u200b\u53bb\u200b\u91cd\u200b\u3001\u200b\u8fc7\u6ee4\u200b\u3001\u200b\u5408\u5e76\u200b\u7b49\u200b\u64cd\u4f5c\u200b\u7684\u200b\u5de5\u5177\u200b\u7c7b\u200b\uff0c\u200b\u901a\u8fc7\u200b\u4f7f\u7528\u200b\u53c2\u6570\u200b \"hoodie.datasource.write.payload.class\" \u200b\u6307\u5b9a\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b\u7684\u200bPayload class\u3002</p>"},{"location":"bigdata/hudi/#overwritewithlatestavropayload","title":"OverwriteWithLatestAvroPayload","text":"<ul> <li>\u200b\u8fd9\u662f\u200b\u9ed8\u8ba4\u200b\u7684\u200b\u8bb0\u5f55\u200b Payload \u200b\u5b9e\u73b0\u200b\u3002\u200b\u5b83\u200b\u901a\u8fc7\u200b\u8c03\u7528\u200b\u9884\u200b\u5408\u5e76\u200b\u952e\u200b\uff08precombine key\uff09\u200b\u7684\u200b\u503c\u200b\u4e0a\u200b\u7684\u200b <code>.compareTo()</code>   \u200b\u65b9\u6cd5\u200b\u6765\u200b\u786e\u5b9a\u200b\u6700\u5927\u503c\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u5408\u5e76\u200b\u65f6\u200b\u7b80\u5355\u200b\u5730\u200b\u9009\u62e9\u200b\u6700\u65b0\u200b\u7684\u200b\u8bb0\u5f55\u200b\u3002\u200b\u8fd9\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u201c\u200b\u6700\u540e\u200b\u5199\u5165\u200b\u83b7\u80dc\u200b\u201d\uff08latest-write-wins\uff09\u200b\u7684\u200b\u8bed\u4e49\u200b\u3002</li> </ul>"},{"location":"bigdata/hudi/#defaulthoodierecordpayload","title":"DefaultHoodieRecordPayload","text":"<p><code>OverwriteWithLatestAvroPayload</code> \u200b\u662f\u200b\u57fa\u4e8e\u200b\u6392\u5e8f\u200b\u5b57\u200b\u6bb5\u200b\u8fdb\u884c\u200b\u9884\u200b\u5408\u5e76\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u5408\u5e76\u200b\u65f6\u200b\u9009\u62e9\u200b\u6700\u65b0\u200b\u7684\u200b\u8bb0\u5f55\u200b\uff0c\u200b\u800c\u200b <code>DefaultHoodieRecordPayload</code> \u200b\u5219\u200b\u5728\u200b\u9884\u200b\u5408\u5e76\u200b\u548c\u200b\u5408\u5e76\u200b\u65f6\u200b\u90fd\u200b\u9075\u5faa\u200b\u6392\u5e8f\u200b\u5b57\u200b\u6bb5\u200b\u3002\u200b\u6211\u4eec\u200b\u901a\u8fc7\u200b\u4e00\u4e2a\u200b\u793a\u4f8b\u200b\u6765\u200b\u7406\u89e3\u200b\u5b83\u4eec\u200b\u7684\u200b\u533a\u522b\u200b\uff1a</p> <p>\u200b\u5047\u8bbe\u200b\u6392\u5e8f\u200b\u5b57\u6bb5\u200b\u662f\u200b <code>ts</code>\uff0c\u200b\u8bb0\u5f55\u200b\u952e\u200b\u662f\u200b <code>id</code>\uff0c\u200b\u6a21\u5f0f\u200b\uff08schema\uff09\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>{\n[\n  {\n    \"name\": \"id\",\n    \"type\": \"string\"\n  },\n  {\n    \"name\": \"ts\",\n    \"type\": \"long\"\n  },\n  {\n    \"name\": \"name\",\n    \"type\": \"string\"\n  },\n  {\n    \"name\": \"price\",\n    \"type\": \"string\"\n  }\n]\n}\n</code></pre> <p>\u200b\u5b58\u50a8\u200b\u4e2d\u200b\u7684\u200b\u5f53\u524d\u200b\u8bb0\u5f55\u200b\uff1a</p> id ts name price 1 2 name_2 price_2 <p>\u200b\u4f20\u5165\u200b\u7684\u200b\u8bb0\u5f55\u200b\uff1a</p> id ts name price 1 1 name_1 price_1 <p>\u200b\u4f7f\u7528\u200b <code>OverwriteWithLatestAvroPayload</code> \u200b\u5408\u5e76\u200b\u540e\u200b\u7684\u200b\u7ed3\u679c\u200b\uff08\u200b\u6700\u540e\u200b\u5199\u5165\u200b\u83b7\u80dc\u200b\uff09\uff1a</p> id ts name price 1 1 name_1 price_1 <p>\u200b\u4f7f\u7528\u200b <code>DefaultHoodieRecordPayload</code> \u200b\u5408\u5e76\u200b\u540e\u200b\u7684\u200b\u7ed3\u679c\u200b\uff08\u200b\u59cb\u7ec8\u200b\u9075\u5faa\u200b\u6392\u5e8f\u200b\u5b57\u200b\u6bb5\u200b\uff09\uff1a</p> id ts name price 1 2 name_2 price_2"},{"location":"bigdata/hudi/#eventtimeavropayload","title":"EventTimeAvroPayload","text":"<ul> <li>\u200b\u67d0\u4e9b\u200b\u7528\u4f8b\u200b\u9700\u8981\u200b\u6309\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\uff08event time\uff09\u200b\u5408\u5e76\u200b\u8bb0\u5f55\u200b\uff0c\u200b\u56e0\u6b64\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\u5728\u200b\u8fd9\u91cc\u200b\u5145\u5f53\u200b\u6392\u5e8f\u200b\u5b57\u200b\u6bb5\u200b\u3002\u200b\u8fd9\u79cd\u200b Payload \u200b\u7279\u522b\u200b\u9002\u7528\u200b\u4e8e\u200b\u5904\u7406\u200b\u5ef6\u8fdf\u200b\u5230\u8fbe\u200b\u7684\u200b\u6570\u636e\u200b\u3002\u200b\u5bf9\u4e8e\u200b\u6b64\u7c7b\u200b\u7528\u4f8b\u200b\uff0c\u200b\u7528\u6237\u200b\u9700\u8981\u200b\u914d\u7f6e\u200b   Payload \u200b\u7684\u200b\u4e8b\u4ef6\u200b\u65f6\u95f4\u200b\u5b57\u200b\u6bb5\u200b\u3002</li> </ul>"},{"location":"bigdata/hudi/#overwritenondefaultswithlatestavropayload","title":"OverwriteNonDefaultsWithLatestAvroPayload","text":"<ul> <li>\u200b\u8fd9\u79cd\u200b Payload \u200b\u4e0e\u200b <code>OverwriteWithLatestAvroPayload</code>   \u200b\u975e\u5e38\u200b\u76f8\u4f3c\u200b\uff0c\u200b\u4f46\u200b\u5728\u200b\u5408\u5e76\u200b\u8bb0\u5f55\u200b\u65f6\u200b\u7565\u6709\u4e0d\u540c\u200b\u3002\u200b\u5728\u200b\u9884\u200b\u5408\u5e76\u200b\u65f6\u200b\uff0c\u200b\u5b83\u200b\u50cf\u200b <code>OverwriteWithLatestAvroPayload</code>   \u200b\u4e00\u6837\u200b\uff0c\u200b\u57fa\u4e8e\u200b\u6392\u5e8f\u200b\u5b57\u200b\u6bb5\u200b\u9009\u62e9\u200b\u67d0\u4e2a\u200b\u952e\u200b\u7684\u200b\u6700\u65b0\u200b\u8bb0\u5f55\u200b\u3002\u200b\u800c\u200b\u5728\u200b\u5408\u5e76\u200b\u65f6\u200b\uff0c\u200b\u5b83\u200b\u53ea\u4f1a\u200b\u8986\u76d6\u200b\u5b58\u50a8\u200b\u4e2d\u200b\u73b0\u6709\u200b\u8bb0\u5f55\u200b\u7684\u200b\u6307\u5b9a\u200b\u5b57\u200b\u6bb5\u200b\uff0c\u200b\u4e14\u200b\u4ec5\u200b\u5f53\u200b\u8fd9\u4e9b\u200b\u5b57\u6bb5\u200b\u7684\u200b\u503c\u200b\u4e0d\u200b\u7b49\u4e8e\u200b\u9ed8\u8ba4\u503c\u200b\u65f6\u624d\u200b\u4f1a\u200b\u8986\u76d6\u200b\u3002</li> </ul>"},{"location":"bigdata/hudi/#partialupdateavropayload","title":"PartialUpdateAvroPayload","text":"<ul> <li>\u200b\u8fd9\u79cd\u200b Payload   \u200b\u652f\u6301\u200b\u90e8\u5206\u200b\u66f4\u65b0\u200b\u3002\u200b\u901a\u5e38\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u5408\u5e76\u200b\u6b65\u9aa4\u200b\u4f1a\u200b\u51b3\u5b9a\u200b\u9009\u62e9\u200b\u54ea\u6761\u200b\u8bb0\u5f55\u200b\uff0c\u200b\u7136\u540e\u200b\u5b58\u50a8\u200b\u4e2d\u200b\u7684\u200b\u8bb0\u5f55\u200b\u4f1a\u200b\u88ab\u200b\u5b8c\u5168\u200b\u66ff\u6362\u200b\u4e3a\u200b\u6240\u9009\u200b\u7684\u200b\u8bb0\u5f55\u200b\u3002\u200b\u4f46\u200b\u5728\u200b\u67d0\u4e9b\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u9700\u6c42\u200b\u662f\u200b\u53ea\u200b\u66f4\u65b0\u200b\u67d0\u4e9b\u200b\u5b57\u200b\u6bb5\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u66ff\u6362\u200b\u6574\u4e2a\u200b\u8bb0\u5f55\u200b\u3002\u200b\u8fd9\u200b\u79f0\u4e3a\u200b\u90e8\u5206\u200b\u66f4\u65b0\u200b\u3002<code>PartialUpdateAvroPayload</code>   \u200b\u4e3a\u200b\u8fd9\u79cd\u200b\u7528\u4f8b\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u5f00\u7bb1\u200b\u5373\u7528\u200b\u7684\u200b\u652f\u6301\u200b\u3002\u200b\u6211\u4eec\u200b\u901a\u8fc7\u200b\u4e00\u4e2a\u200b\u7b80\u5355\u200b\u7684\u200b\u793a\u4f8b\u200b\u6765\u200b\u8bf4\u660e\u200b\uff1a</li> </ul> <p>\u200b\u5047\u8bbe\u200b\u6392\u5e8f\u200b\u5b57\u6bb5\u200b\u662f\u200b <code>ts</code>\uff0c\u200b\u8bb0\u5f55\u200b\u952e\u200b\u662f\u200b <code>id</code>\uff0c\u200b\u6a21\u5f0f\u200b\uff08schema\uff09\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>{\n[\n  {\n    \"name\": \"id\",\n    \"type\": \"string\"\n  },\n  {\n    \"name\": \"ts\",\n    \"type\": \"long\"\n  },\n  {\n    \"name\": \"name\",\n    \"type\": \"string\"\n  },\n  {\n    \"name\": \"price\",\n    \"type\": \"string\"\n  }\n]\n}\n</code></pre> <p>\u200b\u5b58\u50a8\u200b\u4e2d\u200b\u7684\u200b\u5f53\u524d\u200b\u8bb0\u5f55\u200b\uff1a</p> id ts name price 1 2 name_1 null <p>\u200b\u4f20\u5165\u200b\u7684\u200b\u8bb0\u5f55\u200b\uff1a</p> id ts name price 1 1 null price_1 <p>\u200b\u4f7f\u7528\u200b <code>PartialUpdateAvroPayload</code> \u200b\u5408\u5e76\u200b\u540e\u200b\u7684\u200b\u7ed3\u679c\u200b\uff1a</p> id ts name price 1 2 name_1 price_1"},{"location":"bigdata/hudi/#_2","title":"\u6838\u5fc3\u200b\u533a\u522b","text":"Payload \u200b\u7c7b\u578b\u200b \u200b\u8986\u76d6\u200b\u903b\u8f91\u200b \u200b\u9ed8\u8ba4\u503c\u200b\u5904\u7406\u200b OverwriteNonDefaultsWithLatestAvroPayload \u200b\u53ea\u200b\u8986\u76d6\u200b\u5b58\u50a8\u200b\u4e2d\u200b\u8bb0\u5f55\u200b\u7684\u200b\u975e\u200b\u9ed8\u8ba4\u503c\u200b\u5b57\u200b\u6bb5\u200b\uff08\u200b\u5982\u975e\u200b <code>null</code> \u200b\u6216\u975e\u200b <code>0</code> \u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\uff09\u3002 \u200b\u5982\u679c\u200b\u4f20\u5165\u200b\u8bb0\u5f55\u200b\u7684\u200b\u5b57\u200b\u6bb5\u503c\u200b\u4e3a\u200b\u9ed8\u8ba4\u503c\u200b\uff08\u200b\u5982\u200b <code>null</code> \u200b\u6216\u200b <code>0</code>\uff09\uff0c\u200b\u5219\u200b\u4e0d\u4f1a\u200b\u8986\u76d6\u200b\u5b58\u50a8\u200b\u4e2d\u200b\u7684\u200b\u5bf9\u5e94\u200b\u5b57\u200b\u6bb5\u200b\u3002 PartialUpdateAvroPayload \u200b\u53ea\u200b\u8986\u76d6\u200b\u4f20\u5165\u200b\u8bb0\u5f55\u200b\u4e2d\u975e\u200b\u7a7a\u5b57\u6bb5\u200b\uff08\u200b\u5373\u200b\u4e0d\u200b\u4e3a\u200b <code>null</code> \u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\uff09\u3002 \u200b\u5982\u679c\u200b\u4f20\u5165\u200b\u8bb0\u5f55\u200b\u7684\u200b\u5b57\u200b\u6bb5\u503c\u200b\u4e3a\u200b <code>null</code>\uff0c\u200b\u5219\u200b\u4e0d\u4f1a\u200b\u8986\u76d6\u200b\u5b58\u50a8\u200b\u4e2d\u200b\u7684\u200b\u5bf9\u5e94\u200b\u5b57\u200b\u6bb5\u200b\u3002"},{"location":"bigdata/hudi/#_3","title":"\u4e8c\u200b\u3001\u200b\u95ee\u9898","text":"<p>1\u3001spark-sql\u200b\u5efa\u8868\u200b\u548c\u200b\u4f7f\u7528\u200b\u4ee3\u7801\u200b\u5efa\u8868\u200b\u9ed8\u8ba4\u200b\u914d\u7f6e\u200b\u4e0d\u200b\u4e00\u6837\u200b\uff0c\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u5199\u5165\u200b\u6570\u636e\u200b\u91cd\u590d\u200b</p> <pre><code>spark-sql\u200b\u9ed8\u8ba4\u200b'hoodie.table.keygenerator.class'= 'org.apache.hudi.keygen.ComplexKeyGenerator'\n\n\u200b\u4ee3\u7801\u200b\u5efa\u8868\u200b\u9ed8\u8ba4\u200b'hoodie.table.keygenerator.class'= 'org.apache.hudi.keygen.SimpleKeyGenerator'\n</code></pre> <p>2\u3001\u200b\u4efb\u52a1\u200b\u505c\u6b62\u200b\u6216\u200b\u91cd\u542f\u200b\u540e\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u4ea7\u751f\u200b4KB\u200b\u7684\u200b\u5783\u573e\u6587\u4ef6\u200b</p> <pre><code># \u200b\u67e5\u770b\u200b\nhadoop fs -ls -R xxx/receive_date=2023-05-22 | awk '{print $5, $8, $6, $7}' | sort -n | head -n 30\n# \u200b\u5220\u9664\u200b\nhadoop fs -ls xxx/receive_date=2023-05-22 | awk '{if($5==4) print $8}' | xargs -I {} hadoop fs -rm {}\n</code></pre> <p>3\u3001NoSuchMethodError from HBase when using Hudi with metadata table on HDFS?</p> <pre><code>NoSuchMethodError from HBase when using Hudi with metadata table on HDFS?\nhudi\u200b\u91cc\u200b\u7684\u200bhbase\u200b\u662f\u200b\u7531\u200bhadoop\u200b\u7f16\u8bd1\u200b\uff0c\u200b\u5982\u679c\u200b\u4f7f\u7528\u200bhadoop3+hdfs\u200b\u4f1a\u200b\u62a5\u9519\u200b\n\u200b\u89e3\u51b3\u200b\uff1a\n(1) Download HBase source code from https://github.com/apache/hbase;\n(2) Switch to the source code of 2.4.9 release with the tag rel/2.4.9:\ngit checkout rel/2.4.9\n(3) Package a new version of HBase 2.4.9 with Hadoop 3 version:\nmvn clean install -Denforcer.skip -DskipTests -Dhadoop.profile=3.0 -Psite-install-step\n(4)Package Hudi again.\nmvn install -DskipTests -Drat.skip=true -Pflink-bundle-shade-hive3 -Pflink1.13 -Dscala-2.12 -Dspark3.2\n</code></pre>"},{"location":"bigdata/kafka/","title":"Kafka","text":""},{"location":"bigdata/kafka/#1","title":"1. \u200b\u5b9a\u4e49","text":""},{"location":"bigdata/kafka/#11","title":"1.1 \u200b\u4f20\u7edf\u200b\u5b9a\u4e49","text":"<ul> <li>\u200b\u5206\u5e03\u5f0f\u200b</li> <li>\u200b\u53d1\u5e03\u200b\u8ba2\u9605\u200b</li> <li>\u200b\u6d88\u606f\u200b\u961f\u5217\u200b</li> <li>\u200b\u53d1\u5e03\u200b\u8ba2\u9605\u200b\u5206\u4e3a\u200b\u591a\u79cd\u7c7b\u578b\u200b\uff0c\u200b\u8ba2\u9605\u200b\u8005\u200b\u6839\u636e\u200b\u9700\u6c42\u200b\u9009\u62e9\u6027\u200b\u8ba2\u9605\u200b</li> </ul>"},{"location":"bigdata/kafka/#12","title":"1.2 \u200b\u6700\u65b0\u200b\u5b9a\u4e49","text":"<ul> <li>\u200b\u6d41\u200b\u5e73\u53f0\u200b\uff08\u200b\u5b58\u50a8\u200b\u3001\u200b\u8ba1\u7b97\u200b\uff09</li> </ul>"},{"location":"bigdata/kafka/#2","title":"2. \u200b\u6d88\u606f\u200b\u961f\u5217\u200b\u5e94\u7528\u200b\u573a\u666f","text":"<ol> <li>\u200b\u7f13\u89e3\u200b\u5cf0\u503c\u200b\u6d41\u91cf\u200b</li> <li>\u200b\u89e3\u200b\u8026\u200b\u7cfb\u7edf\u200b\u7ec4\u4ef6\u200b</li> <li>\u200b\u652f\u6301\u200b\u5f02\u6b65\u200b\u901a\u4fe1\u200b</li> </ol>"},{"location":"bigdata/kafka/#3","title":"3. \u200b\u4e24\u79cd\u200b\u6a21\u5f0f","text":""},{"location":"bigdata/kafka/#31","title":"3.1 \u200b\u70b9\u5bf9\u70b9","text":"<ul> <li>\u200b\u4e00\u4e2a\u200b\u751f\u4ea7\u8005\u200b\uff0c\u200b\u4e00\u4e2a\u200b\u6d88\u8d39\u8005\u200b</li> <li>\u200b\u4e00\u4e2a\u200b\u4e3b\u9898\u200b</li> <li>\u200b\u6570\u636e\u200b\u4f1a\u200b\u88ab\u200b\u5220\u9664\u200b</li> </ul>"},{"location":"bigdata/kafka/#32","title":"3.2 \u200b\u53d1\u5e03\u200b\u8ba2\u9605","text":"<ul> <li>\u200b\u591a\u4e2a\u200b\u751f\u4ea7\u8005\u200b</li> <li>\u200b\u591a\u4e2a\u200b\u6d88\u8d39\u8005\u200b\uff0c\u200b\u76f8\u4e92\u200b\u72ec\u7acb\u200b</li> <li>\u200b\u591a\u4e2a\u200b\u4e3b\u9898\u200b</li> <li>\u200b\u6570\u636e\u200b\u4e0d\u4f1a\u200b\u88ab\u200b\u5220\u9664\u200b</li> </ul>"},{"location":"bigdata/kafka/#4","title":"4. \u200b\u67b6\u6784","text":"<ol> <li>\u200b\u751f\u4ea7\u8005\u200b</li> <li> <p>\u200b\u5904\u7406\u200b100T\u200b\u6570\u636e\u200b</p> </li> <li> <p>Broker</p> </li> <li>Broker\u200b\u670d\u52a1\u5668\u200b\u5728\u200bhadoop102\u3001hadoop103\u3001hadoop104\u200b\u7b49\u200b\u8282\u70b9\u200b</li> <li>\u200b\u4e3b\u9898\u200b\uff08Topic\uff09\u200b\u7528\u4e8e\u200b\u5bf9\u200b\u6570\u636e\u200b\u5206\u7c7b\u200b</li> <li>\u200b\u5206\u533a\u200b</li> <li>\u200b\u53ef\u9760\u6027\u200b\u548c\u200b\u526f\u672c\u200b</li> <li>Leader\u200b\u548c\u200bFollower</li> <li> <p>\u200b\u751f\u4ea7\u8005\u200b\u548c\u200b\u6d88\u8d39\u8005\u200b\u53ea\u200b\u5bf9\u200bLeader\u200b\u64cd\u4f5c\u200b</p> </li> <li> <p>\u200b\u6d88\u8d39\u8005\u200b</p> </li> <li>\u200b\u6d88\u8d39\u8005\u200b\u4e4b\u95f4\u200b\u76f8\u4e92\u200b\u72ec\u7acb\u200b</li> <li> <p>\u200b\u6d88\u8d39\u8005\u200b\u7ec4\u200b\uff08\u200b\u4e00\u4e2a\u200b\u5206\u533a\u200b\u53ea\u80fd\u200b\u7531\u200b\u4e00\u4e2a\u200b\u6d88\u8d39\u8005\u200b\u6d88\u8d39\u200b\uff09</p> </li> <li> <p>Zookeeper</p> </li> <li>\u200b\u5b58\u50a8\u200bBroker\u200b\u4fe1\u606f\u200b\uff0c\u200b\u5982\u200bbroker.ids</li> <li>Leader\u200b\u9009\u4e3e\u200b</li> </ol>"},{"location":"bigdata/kafka/#_1","title":"\u4e8c\u200b\u3001\u200b\u5165\u95e8","text":""},{"location":"bigdata/kafka/#1_1","title":"1. \u200b\u5b89\u88c5","text":"<ul> <li>\u200b\u8bbe\u7f6e\u200b\u5168\u5c40\u200b\u552f\u4e00\u200b\u7684\u200bbroker.id</li> <li>\u200b\u914d\u7f6e\u200bbroker.id\u3001log.dirs\u3001zk/kafka</li> <li>\u200b\u542f\u52a8\u200b\u548c\u200b\u505c\u6b62\u200bKafka\uff0c\u200b\u5148\u200b\u505c\u6b62\u200bKafka\u200b\u518d\u200b\u505c\u6b62\u200bZooKeeper</li> <li>\u200b\u4f7f\u7528\u200b\u811a\u672c\u200b\u8fdb\u884c\u200b\u6279\u91cf\u200b\u542f\u52a8\u200b\u548c\u200b\u505c\u6b62\u200b</li> </ul>"},{"location":"bigdata/kafka/#2_1","title":"2. \u200b\u5e38\u7528\u547d\u4ee4\u200b\u884c","text":"<ol> <li>\u200b\u4e3b\u9898\u200b\u64cd\u4f5c\u200b\u4f7f\u7528\u200bkafka-topic.sh</li> <li>\u200b\u751f\u4ea7\u8005\u200b\u4f7f\u7528\u200bkafka-console-producer.sh</li> <li>\u200b\u6d88\u8d39\u8005\u200b\u4f7f\u7528\u200bkafka-console-consumer.sh</li> </ol>"},{"location":"bigdata/kafka/#_2","title":"\u4e09\u200b\u3001\u200b\u751f\u4ea7\u8005","text":""},{"location":"bigdata/kafka/#1_2","title":"1. \u200b\u539f\u7406","text":""},{"location":"bigdata/kafka/#2-api","title":"2. \u200b\u5f02\u6b65\u200b\u53d1\u9001\u200bAPI","text":"<ul> <li>\u200b\u914d\u7f6e\u200b\u8fde\u63a5\u200b\uff08bootstrap-server\uff09</li> <li>\u200b\u914d\u7f6e\u200bkey\u200b\u548c\u200bvalue\u200b\u7684\u200b\u5e8f\u5217\u5316\u200b</li> <li>\u200b\u521b\u5efa\u200b\u751f\u4ea7\u8005\u200b\uff08KafkaProducer\uff09</li> <li>\u200b\u53d1\u9001\u6570\u636e\u200b\uff08send()\u3001send() with Callback\uff09</li> <li>\u200b\u5173\u95ed\u200b\u8d44\u6e90\u200b</li> </ul>"},{"location":"bigdata/kafka/#3_1","title":"3. \u200b\u540c\u6b65\u200b\u53d1\u9001","text":""},{"location":"bigdata/kafka/#4_1","title":"4. \u200b\u5206\u533a","text":"<ul> <li>\u200b\u9ed8\u8ba4\u200b\u5206\u533a\u200b\u89c4\u5219\u200b</li> <li>\u200b\u81ea\u5b9a\u4e49\u200b\u5206\u533a\u200b</li> </ul>"},{"location":"bigdata/kafka/#5","title":"5. \u200b\u63d0\u9ad8\u200b\u541e\u5410\u91cf","text":"<ul> <li>\u200b\u8c03\u6574\u200b\u6279\u6b21\u200b\u5927\u5c0f\u200b</li> <li>\u200b\u8c03\u6574\u200blinger.ms</li> <li>\u200b\u6570\u636e\u538b\u7f29\u200b</li> <li>\u200b\u589e\u52a0\u200b\u7f13\u5b58\u200b\u5927\u5c0f\u200b</li> </ul>"},{"location":"bigdata/kafka/#6","title":"6. \u200b\u53ef\u9760\u6027","text":"<ul> <li>\u200b\u914d\u7f6e\u200backs\u200b\u53c2\u6570\u200b</li> <li>\u200b\u6570\u636e\u200b\u91cd\u590d\u200b\u5904\u7406\u200b</li> <li>\u200b\u5b9e\u73b0\u200b\u5e42\u200b\u7b49\u200b\u6027\u200b</li> </ul>"},{"location":"bigdata/kafka/#7","title":"7. \u200b\u6570\u636e\u200b\u6709\u5e8f","text":"<ul> <li>\u200b\u5355\u5206\u200b\u533a\u5185\u200b\u6709\u5e8f\u200b</li> <li>\u200b\u591a\u200b\u5206\u533a\u200b\u6709\u5e8f\u200b\u7684\u200b\u5904\u7406\u200b</li> </ul>"},{"location":"bigdata/kafka/#8","title":"8. \u200b\u6570\u636e\u200b\u4e71\u5e8f","text":""},{"location":"bigdata/kafka/#broker","title":"\u56db\u200b\u3001Broker","text":""},{"location":"bigdata/kafka/#1-zookeeper","title":"1. Zookeeper\u200b\u5b58\u50a8\u200b\u4fe1\u606f","text":"<ul> <li>\u200b\u5b58\u50a8\u200bbroker.ids</li> <li>Leader\u200b\u4fe1\u606f\u200b</li> <li>\u200b\u8f85\u52a9\u200b\u9009\u4e3e\u200b\uff08Controller\uff09</li> </ul>"},{"location":"bigdata/kafka/#2_2","title":"2. \u200b\u5de5\u4f5c\u200b\u6d41\u7a0b","text":""},{"location":"bigdata/kafka/#3_2","title":"3. \u200b\u670d\u5f79","text":"<ul> <li>\u200b\u670d\u52a1\u5668\u200b\u51c6\u5907\u200b\u548c\u200b\u8ba1\u5212\u200b</li> <li>\u200b\u6267\u884c\u200b\u8ba1\u5212\u200b</li> <li>\u200b\u9a8c\u8bc1\u200b\u8ba1\u5212\u200b</li> </ul>"},{"location":"bigdata/kafka/#4_2","title":"4. \u200b\u9000\u5f79","text":""},{"location":"bigdata/kafka/#5_1","title":"5. \u200b\u526f\u672c","text":"<ul> <li>\u200b\u526f\u672c\u200b\u63d0\u9ad8\u200b\u53ef\u9760\u6027\u200b</li> <li>Leader\u200b\u548c\u200bFollower</li> <li>ISR\uff08In-Sync Replicas\uff09</li> <li>Leader\u200b\u6302\u200b\u4e86\u200b</li> <li>Follower\u200b\u6302\u200b\u4e86\u200b</li> <li>\u200b\u624b\u52a8\u200b\u526f\u672c\u200b\u5206\u914d\u200b</li> <li>Leader\u200b\u5206\u533a\u200b\u7684\u200b\u8d1f\u8f7d\u200b\u5747\u8861\u200b</li> </ul>"},{"location":"bigdata/kafka/#6_1","title":"6. \u200b\u5b58\u50a8\u200b\u673a\u5236","text":"<ul> <li>Broker\u3001Topic\u3001Partition</li> <li>Log Segment\uff081GB\uff09</li> <li>\u200b\u7a00\u758f\u200b\u7d22\u5f15\u200b\uff084KB\uff09</li> </ul>"},{"location":"bigdata/kafka/#7_1","title":"7. \u200b\u5220\u9664\u200b\u6570\u636e","text":"<ul> <li>\u200b\u6570\u636e\u200b\u4fdd\u7559\u200b\u7b56\u7565\u200b</li> <li>\u200b\u5220\u9664\u200b\u548c\u200b\u538b\u7f29\u200b</li> </ul>"},{"location":"bigdata/kafka/#8_1","title":"8. \u200b\u9ad8\u6548\u200b\u8bfb\u5199","text":"<ul> <li>\u200b\u5206\u533a\u200b</li> <li>\u200b\u7a00\u758f\u200b\u7d22\u5f15\u200b</li> <li>\u200b\u987a\u5e8f\u200b\u8bfb\u5199\u200b</li> <li>\u200b\u96f6\u200b\u62f7\u8d1d\u200b\u548c\u200b\u9875\u200b\u7f13\u5b58\u200b</li> </ul>"},{"location":"bigdata/kafka/#_3","title":"\u4e94\u200b\u3001\u200b\u6d88\u8d39\u8005","text":""},{"location":"bigdata/kafka/#1_3","title":"1. \u200b\u603b\u4f53\u200b\u6d41\u7a0b","text":""},{"location":"bigdata/kafka/#2_3","title":"2. \u200b\u6d88\u8d39\u8005\u200b\u7ec4","text":""},{"location":"bigdata/kafka/#3_3","title":"3. \u200b\u6309\u7167\u200b\u4e3b\u9898\u200b\u6d88\u8d39","text":"<ul> <li>\u200b\u914d\u7f6e\u200b\u8fde\u63a5\u200b\u3001\u200b\u53cd\u200b\u5e8f\u5217\u5316\u200b\u3001\u200b\u6d88\u8d39\u8005\u200b\u7ec4\u200bID</li> <li>\u200b\u521b\u5efa\u200b\u6d88\u8d39\u8005\u200b</li> <li>\u200b\u8ba2\u9605\u200b\u4e3b\u9898\u200b</li> <li>\u200b\u6d88\u8d39\u200b\u6570\u636e\u200b</li> </ul>"},{"location":"bigdata/kafka/#4_3","title":"4. \u200b\u6309\u7167\u200b\u5206\u533a\u200b\u6d88\u8d39","text":""},{"location":"bigdata/kafka/#5_2","title":"5. \u200b\u6d88\u8d39\u8005\u200b\u7ec4\u200b\u6848\u4f8b","text":"<ul> <li>\u200b\u6d88\u8d39\u8005\u200b\u7ec4\u200bID</li> </ul>"},{"location":"bigdata/kafka/#6_2","title":"6. \u200b\u5206\u533a\u200b\u5206\u914d\u200b\u7b56\u7565","text":"<ul> <li>Range</li> <li>Round Robin</li> <li>\u200b\u7c98\u6027\u200b</li> </ul>"},{"location":"bigdata/kafka/#7-offset","title":"7. Offset","text":"<ul> <li>Offset\u200b\u5b58\u50a8\u200b</li> <li>\u200b\u81ea\u52a8\u200b\u63d0\u4ea4\u200b</li> <li>\u200b\u624b\u52a8\u200b\u63d0\u4ea4\u200b</li> <li>\u200b\u6307\u5b9a\u200bOffset\u200b\u6d88\u8d39\u200b</li> <li>\u200b\u6309\u200b\u65f6\u95f4\u200b\u6d88\u8d39\u200b</li> <li>\u200b\u6f0f\u200b\u6d88\u8d39\u200b\u548c\u200b\u91cd\u590d\u200b\u6d88\u8d39\u200b</li> </ul>"},{"location":"bigdata/kafka/#8_2","title":"8. \u200b\u4e8b\u52a1","text":"<ul> <li>\u200b\u751f\u4ea7\u200b\u7aef\u5230\u200b\u96c6\u7fa4\u200b</li> <li>\u200b\u96c6\u7fa4\u200b\u5230\u200b\u6d88\u8d39\u8005\u200b</li> <li>\u200b\u6846\u67b6\u200b</li> </ul>"},{"location":"bigdata/kafka/#9","title":"9. \u200b\u6570\u636e\u200b\u79ef\u538b","text":"<ul> <li>\u200b\u589e\u52a0\u200b\u5206\u533a\u200b\u548c\u200b\u6d88\u8d39\u8005\u200b\u4e2a\u6570\u200b</li> <li>\u200b\u8c03\u6574\u200b\u751f\u4ea7\u200b\u53c2\u6570\u200b</li> <li>\u200b\u8c03\u6574\u200b\u6d88\u8d39\u200b\u7aef\u200b\u53c2\u6570\u200b</li> </ul>"},{"location":"bigdata/kafka/#_4","title":"\u516d\u200b\u3001\u200b\u751f\u4ea7\u200b\u8c03\u4f18\u200b\u548c\u200b\u786c\u4ef6\u200b\u9009\u62e9","text":"<ul> <li>\u200b\u65e5\u6d3b\u200b\u548c\u200b\u65e5\u5fd7\u200b\u6761\u6570\u200b\u8ba1\u7b97\u200b</li> <li>\u200b\u670d\u52a1\u5668\u200b\u53f0\u6570\u200b\u8ba1\u7b97\u200b</li> <li>\u200b\u78c1\u76d8\u200b\u3001\u200b\u5185\u5b58\u200b\u3001CPU\u200b\u548c\u200b\u7f51\u7edc\u200b\u9009\u62e9\u200b</li> </ul>"},{"location":"bigdata/kafka/#_5","title":"\u6d4b\u8bd5","text":"<ul> <li>\u200b\u751f\u4ea7\u8005\u200b\u548c\u200b\u6d88\u8d39\u8005\u200b\u6027\u80fd\u200b\u6d4b\u8bd5\u200b</li> </ul>"},{"location":"bigdata/pandas%20vs%20pyspark/","title":"pandas vs pyspark","text":""},{"location":"bigdata/pandas%20vs%20pyspark/#pandas","title":"\u4f7f\u7528\u200bpandas\u200b\u9047\u5230\u200b\u7684\u200b\u95ee\u9898","text":""},{"location":"bigdata/pandas%20vs%20pyspark/#apply","title":"apply\u200b\u65b9\u6cd5","text":"<p>apply\u200b\u7684\u200baxis\u200b\u53c2\u6570\u200b,\u200b\u9ed8\u8ba4\u200b\u662f\u200b0\uff0c\u200b\u5373\u200b\u6309\u5217\u200b\u8fdb\u884c\u200b\uff0c\u200b\u4e3a\u200b1\u200b\u65f6\u200b\uff0c\u200b\u6309\u884c\u200b \u200b\u5982\u4f55\u200b\u8981\u200b\u4f7f\u7528\u200bapply\u200b\u5904\u7406\u200b\u6570\u636e\u200b\u65f6\u200b\uff0c\u200b\u8981\u200b\u7528\u5230\u200bdf\u200b\u5185\u200b\u7684\u200b\u6570\u636e\u200b\u65f6\u200b,\u200b\u4f7f\u7528\u200bdf['xxx'] = df.apply(lambda x: test(x), axis=1)\u200b\u6309\u884c\u200b\u5904\u7406\u200b\u3002</p>"},{"location":"bigdata/pg%E5%AE%89%E8%A3%85%E6%80%BB%E7%BB%93/","title":"Pg\u200b\u5b89\u88c5","text":"<p>YUM\u200b\u5b89\u88c5\u200b</p> <pre><code># Install the repository RPM:\nsudo yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n\n# Install PostgreSQL:\nsudo yum install -y postgresql15-server\n\n# Optionally initialize the database and enable automatic start:\nsudo /usr/pgsql-15/bin/postgresql-15-setup initdb\nsudo systemctl enable postgresql-15\nsudo systemctl start postgresql-15\n\n\ncd /home/data\nmkdir -p pgdata/data/\nchown -R postgres.postgres /pgdata\nvi /usr/lib/systemd/system/postgresql-15.service  \n\n\u200b\u4fee\u6539\u200bPGDATA\n# \u200b\u751f\u6548\u200b\nsudo systemctl daemon-reload\nsudo systemctl reload postgresql-15\nsudo systemctl restart postgresql-15\n\n# \u200b\u8fdb\u5165\u200bpg\nsu - postgres\npsql -U postgres\n# \u200b\u4fee\u6539\u200b\u6570\u636e\u5e93\u200b\u5bc6\u7801\u200b\n \\password\n\u200b\u5bc6\u7801\u200b\uff1aXXX\n</code></pre>"},{"location":"bigdata/pyspark/","title":"pyspark","text":""},{"location":"bigdata/pyspark/#_1","title":"\u5148\u200b\u9644\u56fe","text":""},{"location":"bigdata/pyspark/#create-rdd","title":"Create RDD","text":"<pre><code>dataList = [\"java good\", \"Python awsome\", \"Scala good\"]\nrdd = spark.sparkContext.parallelize(dataList, 3)\n</code></pre>"},{"location":"bigdata/pyspark/#getnumpartitions","title":"getNumPartitions","text":"<p>\u200b\u83b7\u53d6\u200b\u5206\u533a\u200b\u6570\u91cf\u200b <pre><code>print(\"initial partition count:\" + str(rdd.getNumPartitions()))\n</code></pre></p>"},{"location":"bigdata/pyspark/#repartition-and-coalesce","title":"Repartition and Coalesce","text":"<p><pre><code>reparRdd = rdd.repartition(4)\nprint(\"re-partition count:\" + str(reparRdd.getNumPartitions()))\nreparRdd2 = rdd.coalesce(2)\nprint(\"re-partition count:\" + str(reparRdd2.getNumPartitions()))\n</code></pre>  repartition\uff08\uff09\u200b\u65b9\u6cd5\u200b\u662f\u200b\u4e00\u4e2a\u200b\u975e\u5e38\u200b\u6602\u8d35\u200b\u7684\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u4f1a\u200b\u5c06\u200b\u96c6\u7fa4\u200b\u4e2d\u200b\u6240\u6709\u200b\u8282\u70b9\u200b\u7684\u200b\u6570\u636e\u200b\u6df7\u6d17\u200b  \u200b\u5982\u679c\u200b\u4f60\u200b\u5728\u200b4\u200b\u4e2a\u200b\u5206\u533a\u200b\u4e2d\u6709\u200b\u6570\u636e\u200b\uff0c\u200b\u90a3\u4e48\u200b\u6267\u884c\u200bcoalesce\uff082\uff09\u200b\u53ea\u200b\u4ece\u200b2\u200b\u4e2a\u200b\u8282\u70b9\u200b\u79fb\u52a8\u200b\u6570\u636e\u200b\u3002coalesce()\u200b\u53ea\u80fd\u200b\u51cf\u5c11\u200b\u5206\u533a\u200b\uff0c\u200b\u4e0d\u80fd\u200b\u589e\u52a0\u200b\u5206\u533a\u200b  \u200b\u603b\u7ed3\u200b\uff1a\u200b\u51cf\u5c11\u200b\u5206\u533a\u200b\u4f7f\u7528\u200bcoalesce\uff0c\u200b\u589e\u52a0\u200b\u5206\u533a\u200b\u4f7f\u7528\u200brepartition</p>"},{"location":"bigdata/pyspark/#rdd-transformations","title":"RDD Transformations\u200b\u7b97\u5b50","text":""},{"location":"bigdata/pyspark/#flatmap","title":"flatMap","text":"<pre><code>rdd2 = rdd.flatMap(lambda x: x.split(\" \"))\n</code></pre>"},{"location":"bigdata/pyspark/#map","title":"Map","text":"<pre><code>rdd3 = rdd2.map(lambda x: (x, 1))\n</code></pre>"},{"location":"bigdata/pyspark/#reducebykey","title":"reduceByKey","text":"<pre><code>rdd4 = rdd3.reduceByKey(lambda a, b: a + b)\n</code></pre>"},{"location":"bigdata/pyspark/#sortbykey","title":"sortByKey","text":"<pre><code>rdd5 = rdd4.map(lambda x: (x[1], x[0])).sortByKey()\n</code></pre>"},{"location":"bigdata/pyspark/#filter","title":"filter","text":"<pre><code>rdd6 = rdd5.filter(lambda x: 'Python' in x[1])\n</code></pre>"},{"location":"bigdata/pyspark/#rdd-actions","title":"RDD Actions\u200b\u7b97\u5b50","text":""},{"location":"bigdata/pyspark/#count","title":"count","text":"<pre><code>print(\"Count : \" + str(rdd6.count()))\n</code></pre>"},{"location":"bigdata/pyspark/#first","title":"first","text":"<pre><code>firstRec = rdd6.first()\nprint(\"First Record : \" + str(firstRec[0]) + \",\" + firstRec[1])\n</code></pre>"},{"location":"bigdata/pyspark/#max","title":"max","text":"<pre><code>datMax = rdd6.max()\nprint(\"Max Record : \" + str(datMax[0]) + \",\" + datMax[1])\n</code></pre>"},{"location":"bigdata/pyspark/#reduce","title":"reduce","text":"<pre><code>totalWordCount = rdd5.reduce(lambda a, b: (a[0] + b[0], a[1]))\nprint(\"dataReduce Record : \" + str(totalWordCount))\n</code></pre>"},{"location":"bigdata/pyspark/#take","title":"take","text":"<pre><code>data3 = rdd5.take(3)\nfor f in data3:\n    print(\"data3 Key:\" + str(f[0]) + \", Value:\" + f[1])\n</code></pre>"},{"location":"bigdata/pyspark/#advantages-of-persisting-rdd","title":"Advantages of Persisting RDD","text":""},{"location":"bigdata/pyspark/#cache","title":"Cache","text":"<pre><code>cachedRdd = rdd.cache()\n# \u200b\u9ed8\u8ba4\u200bCache storage level `MEMORY_ONLY`\n# \u200b\u53ef\u200b\u9009\u200bRDD Persist MEMORY_ONLY,MEMORY_AND_DISK, MEMORY_ONLY_SER, MEMORY_AND_DISK_SER, DISK_ONLY, MEMORY_ONLY_2,MEMORY_AND_DISK_2 and more.\n# \u200b\u6307\u5b9a\u200b\u4e0d\u540c\u200b\u7684\u200b\u5b58\u50a8\u200b\u7ea7\u522b\u200b\ndfPersist = rdd.persist(pyspark.StorageLevel.MEMORY_ONLY)\n# \u200b\u91ca\u653e\u200bRDD\u200b\u7684\u200b\u6301\u4e45\u6027\u200b\uff0c\u200b\u4ece\u800c\u200b\u91ca\u653e\u200b\u5360\u7528\u200b\u7684\u200b\u5185\u5b58\u200b\u3002\nrddPersist2 = dfPersist.unpersist()\n</code></pre>"},{"location":"bigdata/pyspark/#broadcast","title":"Broadcast","text":"<p>Broadcast \u200b\u662f\u200b\u4e00\u79cd\u200b\u7528\u4e8e\u200b\u5c06\u200b\u5927\u200b\u6570\u636e\u7ed3\u6784\u200b\u5e7f\u64ad\u200b\u5230\u200b\u96c6\u7fa4\u200b\u4e2d\u200b\u7684\u200b\u6240\u6709\u200b\u8282\u70b9\u200b\u4ee5\u4f9b\u200b\u4efb\u52a1\u200b\u4f7f\u7528\u200b\u7684\u200b\u673a\u5236\u200b\u3002\u200b\u8fd9\u200b\u5bf9\u4e8e\u200b\u907f\u514d\u200b\u7f51\u7edc\u200b\u4f20\u8f93\u200b\u548c\u200b\u63d0\u9ad8\u200b\u6027\u80fd\u200b\u975e\u5e38\u200b\u6709\u7528\u200b\uff0c\u200b\u5c24\u5176\u200b\u662f\u200b\u5f53\u200b\u4f60\u200b\u9700\u8981\u200b\u5728\u200b\u591a\u4e2a\u200b\u4efb\u52a1\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u76f8\u540c\u200b\u7684\u200b\u6570\u636e\u200b\u65f6\u200b\uff0c\u200b\u4f8b\u5982\u200b\u5728\u200b join \u200b\u64cd\u4f5c\u200b\u4e2d\u200b\u3002  Broadcast \u200b\u53ef\u4ee5\u200b\u7528\u4e8e\u200b\u5c06\u200b\u53ea\u8bfb\u200b\u7684\u200b\u5927\u200b\u6570\u636e\u7ed3\u6784\u200b\uff08\u200b\u4f8b\u5982\u200b\u5b57\u5178\u200b\u3001\u200b\u96c6\u5408\u200b\u3001DataFrame \u200b\u7b49\u200b\uff09\u200b\u4f20\u64ad\u200b\u5230\u200b\u5404\u4e2a\u200b\u8282\u70b9\u200b\uff0c\u200b\u4ee5\u200b\u907f\u514d\u200b\u5c06\u200b\u8fd9\u4e9b\u200b\u6570\u636e\u200b\u590d\u5236\u5230\u200b\u6bcf\u4e2a\u200b\u4efb\u52a1\u200b\u7684\u200b\u5185\u5b58\u200b\u4e2d\u200b\u3002\u200b\u8fd9\u200b\u53ef\u4ee5\u200b\u51cf\u5c11\u200b\u7f51\u7edc\u200b\u4f20\u8f93\u200b\u548c\u200b\u964d\u4f4e\u200b\u5185\u5b58\u200b\u5360\u7528\u200b\uff0c\u200b\u4ece\u800c\u200b\u63d0\u9ad8\u200b\u6027\u80fd\u200b\u3002 <pre><code>broadcastVar = spark.sparkContext.broadcast([0, 1, 2, 3])\nprint(broadcastVar.value)\n</code></pre></p>"},{"location":"bigdata/pyspark/#accumulators","title":"Accumulators","text":"<p>\u200b\u7528\u4e8e\u200b\u5728\u200b\u5206\u5e03\u5f0f\u8ba1\u7b97\u200b\u4e2d\u200b\u8fdb\u884c\u200b\u7d2f\u79ef\u200b\u64cd\u4f5c\u200b\u3002Accumulator \u200b\u901a\u5e38\u200b\u7528\u4e8e\u200b\u5728\u200b\u5e76\u884c\u64cd\u4f5c\u200b\u4e2d\u200b\u7d2f\u79ef\u200b\u7ed3\u679c\u200b\uff0c\u200b\u4f8b\u5982\u200b\u8ba1\u6570\u200b\u6216\u200b\u603b\u548c\u200b\uff0c\u200b\u800c\u200b\u4e0d\u4f1a\u200b\u5f15\u53d1\u200b\u7ade\u4e89\u200b\u6761\u4ef6\u200b\uff08race condition\uff09\u3002\u200b\u5b83\u4eec\u200b\u5728\u200b\u591a\u4e2a\u200b\u4efb\u52a1\u200b\u4e2d\u200b\u8fdb\u884c\u200b\u5e76\u884c\u64cd\u4f5c\u200b\uff0c\u200b\u7136\u540e\u200b\u5c06\u200b\u7ed3\u679c\u200b\u7d2f\u79ef\u5230\u200b\u5355\u4e2a\u200b\u53d8\u91cf\u200b\u4e2d\u200b\u3002  \u200b\u4e3b\u8981\u200b\u7684\u200b\u7528\u6cd5\u200b\u662f\u200b\u5728\u200b Spark \u200b\u4f5c\u4e1a\u200b\u4e2d\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b Accumulator\uff0c\u200b\u7136\u540e\u200b\u5728\u200b\u4e0d\u540c\u200b\u7684\u200b\u4efb\u52a1\u200b\u4e2d\u200b\u7d2f\u79ef\u200b\u503c\u200b\u3002\u200b\u8fd9\u4e9b\u200b\u503c\u200b\u53ef\u4ee5\u200b\u88ab\u200b\u6240\u6709\u200b\u4efb\u52a1\u200b\u8bfb\u53d6\u200b\uff0c\u200b\u4f46\u200b\u53ea\u80fd\u200b\u88ab\u200b\u7d2f\u79ef\u200b\uff0c\u200b\u4e0d\u80fd\u200b\u88ab\u200b\u4fee\u6539\u200b\u3002 <pre><code>accumulator = spark.sparkContext.accumulator(0)\nspark.sparkContext.parallelize([1, 2, 3]).foreach(lambda x: accumulator.add(x))\nprint(accumulator.value)\n</code></pre></p>"},{"location":"bigdata/pyspark/#_2","title":"\u4e00\u4e9b\u200b\u4f18\u5316\u200b\u7b56\u7565","text":""},{"location":"bigdata/pyspark/#dataframe","title":"\u904d\u5386\u200bDataFrame\u200b\u7684\u200b\u4f18\u5316","text":"<pre><code>import functools\nfrom pyspark.sql import DataFrame\n\npaths = get_file_paths()\n\n# BAD: For loop\nfor path in paths:\n  df = spark.read.load(path)\n  df = fancy_transformations(df)\n  df.write.mode(\"append\").saveAsTable(\"xyz\")\n\n# GOOD: functools.reduce\nlazily_evaluated_reads = [spark.read.load(path) for path in paths]\nlazily_evaluted_transforms = [fancy_transformations(df) for df in lazily_evaluated_reads]\nunioned_df = functools.reduce(DataFrame.union, lazily_evaluted_transforms)\nunioned_df.write.mode(\"append\").saveAsTable(\"xyz\")\n</code></pre>"},{"location":"bigdata/pyspark/#_3","title":"\u8bfb\u53d6\u200b\u6587\u4ef6","text":"<p>\u200b\u8bfb\u53d6\u200b\u6587\u4ef6\u200b\u65f6\u200b,\u200b\u6bd4\u5982\u200bParquet\u3001JSON\u200b\u548c\u200bORC\uff0chudi\u200b\u4f7f\u7528\u200bParquet\u200b\u683c\u5f0f\u200b\uff0c\u200b\u7406\u8bba\u200b\u4e0a\u200b\u4e5f\u200b\u9002\u7528\u200b\uff0c\u200b\u5047\u8bbe\u200b\u8981\u200b\u8bfb\u53d6\u200b10GB\u200b\u7684\u200b\u6570\u636e\u200b\uff0c\u200b\u53ef\u200b\u4f7f\u7528\u200b\u4ee5\u4e0b\u200b\u8ba1\u7b97\u200b\u8981\u200b\u4f7f\u7528\u200b\u7684\u200b\u8d44\u6e90\u200b\uff1a spark\u200b\u9ed8\u8ba4\u200b\u8bfb\u53d6\u200b\u5355\u4e2a\u200b\u5206\u533a\u200b\u7684\u200b\u5927\u5c0f\u200b\u4e3a\u200b128Mb\uff0c\u200b\u53d6\u51b3\u4e8e\u200b\uff1a - spark.sql.files.maxPartitionBytes: \u200b\u7528\u9014\u200b: \u200b\u8fd9\u4e2a\u200b\u53c2\u6570\u200b\u7528\u4e8e\u200b\u63a7\u5236\u200b Spark SQL \u200b\u5728\u200b\u8bfb\u53d6\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u5355\u4e2a\u200b\u5206\u533a\u200b\u4e2d\u200b\u6700\u200b\u591a\u200b\u53ef\u4ee5\u200b\u5305\u542b\u200b\u7684\u200b\u5b57\u8282\u6570\u200b\u3002 \u200b\u9ed8\u8ba4\u503c\u200b: \u200b\u9ed8\u8ba4\u503c\u200b\u4e3a\u200b 128MB\u3002 \u200b\u9002\u7528\u200b\u573a\u666f\u200b: \u200b\u5f53\u200b Spark \u200b\u4f7f\u7528\u200b SparkSession \u200b\u8bfb\u53d6\u200b\u6587\u4ef6\u200b\u6570\u636e\u6e90\u200b\uff08\u200b\u5982\u200b Parquet\u3001ORC\u3001CSV \u200b\u7b49\u200b\uff09\u200b\u65f6\u200b\uff0c\u200b\u8be5\u200b\u53c2\u6570\u200b\u4f1a\u200b\u51b3\u5b9a\u200b\u6bcf\u4e2a\u200b\u5206\u533a\u200b\u6240\u200b\u8bfb\u53d6\u200b\u7684\u200b\u6570\u636e\u91cf\u200b\u3002\u200b\u6b64\u53c2\u6570\u200b\u5bf9\u200b Spark SQL \u200b\u53ca\u200b DataFrame API \u200b\u76f8\u5173\u200b\u7684\u200b\u64cd\u4f5c\u200b\u751f\u6548\u200b\u3002 \u200b\u5f71\u54cd\u200b: \u200b\u5982\u679c\u200b\u6587\u4ef6\u200b\u5f88\u5927\u200b\uff0c\u200b\u90a3\u4e48\u200b Spark \u200b\u4f1a\u200b\u5c06\u200b\u6587\u4ef6\u200b\u5206\u6210\u200b\u591a\u4e2a\u200b\u5206\u533a\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u5206\u533a\u200b\u6700\u591a\u4f1a\u200b\u8bfb\u53d6\u200b spark.sql.files.maxPartitionBytes \u200b\u5927\u5c0f\u200b\u7684\u200b\u6570\u636e\u200b\u3002\u200b\u8fd9\u200b\u6709\u52a9\u4e8e\u200b\u907f\u514d\u200b\u5355\u4e2a\u200b\u5206\u533a\u200b\u6570\u636e\u200b\u8fc7\u5927\u200b\uff0c\u200b\u4ece\u800c\u200b\u5bfc\u81f4\u200b\u5185\u5b58\u200b\u6ea2\u51fa\u200b\u3002 - spark.files.maxPartitionBytes: \u200b\u7528\u9014\u200b: \u200b\u8fd9\u4e2a\u200b\u53c2\u6570\u200b\u7528\u4e8e\u200b\u63a7\u5236\u200b Spark Core \u200b\u5728\u200b\u5904\u7406\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u5355\u4e2a\u200b\u5206\u533a\u200b\u7684\u200b\u6700\u5927\u200b\u5b57\u8282\u6570\u200b\u3002 \u200b\u9ed8\u8ba4\u503c\u200b: \u200b\u8fd9\u4e2a\u200b\u53c2\u6570\u200b\u9ed8\u8ba4\u503c\u200b\u6ca1\u6709\u200b\u786c\u6027\u89c4\u5b9a\u200b\uff0c\u200b\u4f46\u200b\u5982\u679c\u200b\u4f7f\u7528\u200b\u7684\u8bdd\u200b\uff0c\u200b\u901a\u5e38\u200b\u4e0e\u200b spark.sql.files.maxPartitionBytes \u200b\u7c7b\u4f3c\u200b\u3002 \u200b\u9002\u7528\u200b\u573a\u666f\u200b: \u200b\u8fd9\u4e2a\u200b\u53c2\u6570\u200b\u4e3b\u8981\u200b\u5e94\u7528\u200b\u4e8e\u200b Spark Core \u200b\u4e2d\u200b\uff0c\u200b\u5f53\u200b\u4f60\u200b\u4f7f\u7528\u200b sc.textFile \u200b\u6216\u200b\u5176\u4ed6\u200b\u6587\u4ef6\u200b\u8bfb\u53d6\u200b\u64cd\u4f5c\u200b\u65f6\u200b\uff0c\u200b\u63a7\u5236\u200b\u6bcf\u4e2a\u200b\u5206\u533a\u200b\u7684\u200b\u6570\u636e\u91cf\u200b\u3002 \u200b\u5f71\u54cd\u200b: \u200b\u7c7b\u4f3c\u200b\u4e8e\u200b spark.sql.files.maxPartitionBytes\uff0c\u200b\u4f46\u200b\u4f5c\u7528\u200b\u8303\u56f4\u200b\u66f4\u5e7f\u200b\uff0c\u200b\u9002\u7528\u200b\u4e8e\u200b\u6240\u6709\u200b\u4f7f\u7528\u200b Spark Core \u200b\u76f4\u63a5\u200b\u8bfb\u53d6\u200b\u6587\u4ef6\u200b\u7684\u200b\u64cd\u4f5c\u200b\u3002  </p> <p>\u200b\u8ba1\u7b97\u200b\u5982\u4e0b\u200b\uff1a 10GB = 10 * 1024Mb = 10240 \u200b\u5206\u533a\u200b\u6570\u200b = 10240 / 128 = 80 \u200b\u4e00\u822c\u200b\uff0c\u200b\u5efa\u8bae\u200b\u4e00\u4e2a\u200b\u6267\u884c\u5668\u200b\u4e2d\u6709\u200b2-5\u200b\u4e2a\u200b\u6267\u884c\u5668\u200b\u6838\u5fc3\u200b\uff0c\u200b\u5982\u679c\u200b\u6211\u4eec\u200b\u53d6\u200b\u4e00\u4e2a\u200b\u6267\u884c\u5668\u200b\u4e2d\u200b\u7684\u200b\u6267\u884c\u5668\u200b\u6838\u5fc3\u200b\u6570\u200b=4\uff0c\u200b\u90a3\u4e48\u200b\u6267\u884c\u5668\u200b\u603b\u6570\u200b= 80/4 = 20 \u200b\u9ed8\u8ba4\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u6267\u884c\u5668\u200b\u6838\u5fc3\u200b\u7684\u200b\u603b\u200b\u5185\u5b58\u200b\u5e94\u4e3a\u200b\u9ed8\u8ba4\u200b\u5206\u533a\u200b\u5185\u5b58\u200b\u7684\u200b4\u200b\u500d\u200b,\u200b\u5373\u200b4 * 128Mb = 512Mb\uff0c\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6267\u884c\u5668\u200b\u603b\u200b\u5185\u5b58\u200b = \u200b\u6838\u5fc3\u200b\u6570\u200b512 = 4512 = 2GB \u200b\u6240\u4ee5\u200b\uff0c\u200b\u8bfb\u53d6\u200b10Gb\u200b\u7684\u200b\u6570\u636e\u200b\uff0c\u200b\u7406\u8bba\u200b\u4e0a\u8981\u200b\u8fbe\u5230\u200b\u6700\u5927\u200b\u5e76\u884c\u200b\uff0c\u200b\u9700\u8981\u200b20\u200b\u4e2a\u200bexecutors\uff0c 2Gb\u200b\u7684\u200bexecutors memory</p>"},{"location":"bigdata/pyspark/#_4","title":"\u542f\u52a8\u200b\u53c2\u6570","text":""},{"location":"bigdata/pyspark/#archives","title":"archives","text":"<p>\u200b\u5728\u200b Spark \u200b\u4e2d\u200b\uff0c--archives \u200b\u662f\u200b\u4e00\u4e2a\u200b\u7528\u4e8e\u200b\u6307\u5b9a\u200b\u9700\u8981\u200b\u5206\u53d1\u200b\u5230\u200b\u6240\u6709\u200b\u5de5\u4f5c\u200b\u8282\u70b9\u200b\u7684\u200b\u5f52\u6863\u6587\u4ef6\u200b\uff08\u200b\u5982\u200b .zip\u3001.tar.gz \u200b\u7b49\u200b\uff09\u200b\u7684\u200b\u547d\u4ee4\u200b\u53c2\u6570\u200b\u3002\u200b\u901a\u8fc7\u200b --archives \u200b\u53c2\u6570\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u8fd9\u4e9b\u200b\u5f52\u6863\u6587\u4ef6\u200b\u89e3\u538b\u200b\u5e76\u200b\u5206\u53d1\u200b\u5230\u200b\u6bcf\u4e2a\u200b\u6267\u884c\u5668\u200b\u8282\u70b9\u200b\u4e2d\u200b\uff0c\u200b\u4f9b\u200b\u4f5c\u4e1a\u200b\u4f7f\u7528\u200b\u3002  </p>"},{"location":"bigdata/pyspark/#_5","title":"\u4f5c\u7528\u200b\uff1a","text":"<ul> <li>\u200b\u5206\u53d1\u200b\u6587\u4ef6\u200b\uff1a\u200b\u5c06\u200b\u6307\u5b9a\u200b\u7684\u200b\u5f52\u6863\u6587\u4ef6\u200b\u5206\u53d1\u200b\u5230\u200b\u96c6\u7fa4\u200b\u7684\u200b\u6240\u6709\u200b\u5de5\u4f5c\u200b\u8282\u70b9\u200b\u3002</li> <li>\u200b\u89e3\u538b\u200b\u5f52\u6863\u6587\u4ef6\u200b\uff1a\u200b\u8fd9\u4e9b\u200b\u5f52\u6863\u6587\u4ef6\u200b\u4f1a\u200b\u88ab\u200b\u81ea\u52a8\u200b\u89e3\u538b\u200b\u5230\u200b\u6267\u884c\u5668\u200b\u7684\u200b\u5de5\u4f5c\u200b\u76ee\u5f55\u200b\u4e2d\u200b\uff0c\u200b\u4f9b\u200b\u4f5c\u4e1a\u200b\u4f7f\u7528\u200b\u3002</li> </ul>"},{"location":"bigdata/pyspark/#_6","title":"\u4f7f\u7528\u200b\u573a\u666f\u200b\uff1a","text":"<ul> <li>\u200b\u4f9d\u8d56\u200b\u5305\u200b\u6216\u200b\u8d44\u6e90\u200b\uff1a\u200b\u5982\u679c\u200b\u4f60\u200b\u7684\u200b Spark \u200b\u4f5c\u4e1a\u200b\u4f9d\u8d56\u200b\u4e00\u4e9b\u200b\u5916\u90e8\u200b\u5e93\u200b\u6216\u8005\u200b\u8d44\u6e90\u200b\u6587\u4ef6\u200b\uff0c\u200b\u8fd9\u4e9b\u200b\u5e93\u200b\u6216\u8005\u200b\u8d44\u6e90\u200b\u6587\u4ef6\u200b\u53ef\u4ee5\u200b\u6253\u5305\u200b\u6210\u200b\u5f52\u6863\u6587\u4ef6\u200b\uff0c\u200b\u901a\u8fc7\u200b --archives \u200b\u9009\u9879\u200b\u5206\u53d1\u200b\u548c\u200b\u89e3\u538b\u200b\u5230\u200b\u6bcf\u4e2a\u200b\u5de5\u4f5c\u200b\u8282\u70b9\u200b\u4e0a\u200b\u3002</li> <li>\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\uff1a\u200b\u5982\u679c\u200b\u4f60\u200b\u9700\u8981\u200b\u5728\u200b\u6bcf\u4e2a\u200b\u8282\u70b9\u200b\u4e0a\u200b\u914d\u7f6e\u200b\u7279\u5b9a\u200b\u7684\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\uff08\u200b\u4f8b\u5982\u200b Python \u200b\u865a\u62df\u73af\u5883\u200b\uff09\uff0c\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u8fd9\u4e9b\u200b\u73af\u5883\u200b\u6253\u5305\u200b\u6210\u200b\u5f52\u6863\u6587\u4ef6\u200b\uff0c\u200b\u901a\u8fc7\u200b --archives \u200b\u5206\u53d1\u200b\u5230\u200b\u6bcf\u4e2a\u200b\u8282\u70b9\u200b\u3002</li> </ul>"},{"location":"bigdata/pyspark/#_7","title":"\u793a\u4f8b\u200b\uff1a","text":"<p>\u200b\u5982\u679c\u200b\u4f60\u200b\u4f7f\u7528\u200b Conda \u200b\u521b\u5efa\u200b\u4e86\u200b\u4e00\u4e2a\u200b\u865a\u62df\u73af\u5883\u200b\uff0c\u200b\u5e76\u200b\u5e0c\u671b\u200b\u5728\u200b Spark \u200b\u96c6\u7fa4\u200b\u4e0a\u200b\u5206\u53d1\u200b\u5e76\u200b\u4f7f\u7528\u200b\u8be5\u200b\u73af\u5883\u200b <pre><code># \u200b\u521b\u5efa\u200b\u73af\u5883\u200b\nconda create -n pyspark_env_3.10 python=3.10 pyspark\n# \u200b\u6253\u5305\u200b\u73af\u5883\u200b\nconda pack -n pyspark_env_3.10 -o pyspark_env_3.10.tar.gz\n\u200b\u9047\u5230\u200b\u62a5\u9519\u200b\uff1a\nCondaPackError: \nFiles managed by conda were found to have been deleted/overwritten in the\nfollowing packages:\n\n- pip 24.2:\n    lib/python3.1/site-packages/pip-24.2.dist-info/AUTHORS.txt\n    lib/python3.1/site-packages/pip-24.2.dist-info/INSTALLER\n    lib/python3.1/site-packages/pip-24.2.dist-info/LICENSE.txt\n    + 437 others\n- pyspark 3.5.1:\n    lib/python3.1/site-packages/pyspark-3.5.1.dist-info/INSTALLER\n    lib/python3.1/site-packages/pyspark-3.5.1.dist-info/METADATA\n    lib/python3.1/site-packages/pyspark-3.5.1.dist-info/RECORD\n    + 765 others\n- pytz 2024.1:\n    lib/python3.1/site-packages/pytz-2024.1.dist-info/INSTALLER\n    lib/python3.1/site-packages/pytz-2024.1.dist-info/LICENSE.txt\n    lib/python3.1/site-packages/pytz-2024.1.dist-info/METADATA\n    + 615 others\n- python-dateutil 2.9.0:\n    lib/python3.1/site-packages/dateutil/__init__.py\n    lib/python3.1/site-packages/dateutil/_common.py\n    lib/python3.1/site-packages/dateutil/_version.py\n    + 25 others\n- python-tzdata 2024.1:\n    lib/python3.1/site-packages/tzdata-2024.1.dist-info/INSTALLER\n    lib/python3.1/site-packages/tzdata-2024.1.dist-info/LICENSE\n    lib/python3.1/site-packages/tzdata-2024.1.dist-info/LICENSE_APACHE\n    + 632 others\n- six 1.16.0:\n    lib/python3.1/site-packages/six-1.16.0.dist-info/INSTALLER\n    lib/python3.1/site-packages/six-1.16.0.dist-info/LICENSE\n    lib/python3.1/site-packages/six-1.16.0.dist-info/METADATA\n    + 6 others\n- setuptools 72.1.0:\n    lib/python3.1/site-packages/_distutils_hack/__init__.py\n    lib/python3.1/site-packages/_distutils_hack/override.py\n    lib/python3.1/site-packages/distutils-precedence.pth\n    + 589 others\n- py4j 0.10.9.7:\n    lib/python3.1/site-packages/py4j-0.10.9.7.dist-info/INSTALLER\n    lib/python3.1/site-packages/py4j-0.10.9.7.dist-info/LICENSE.txt\n    lib/python3.1/site-packages/py4j-0.10.9.7.dist-info/METADATA\n    + 38 others\n- wheel 0.44.0:\n    lib/python3.1/site-packages/wheel-0.44.0.dist-info/LICENSE.txt\n    lib/python3.1/site-packages/wheel-0.44.0.dist-info/METADATA\n    lib/python3.1/site-packages/wheel-0.44.0.dist-info/RECORD\n    + 31 others\n\u200b\u6839\u636e\u200b\uff1ahttps://stackoverflow.com/questions/69992742/conda-pack-condapackerror-files-managed-by-conda-were\n\u200b\u9519\u8bef\u200b\u539f\u56e0\u200b\u53ef\u80fd\u200b\u662f\u56e0\u4e3a\u200b\uff1a\u200b\u955c\u50cf\u200b\u8bd5\u56fe\u200b\u4f7f\u7528\u200bpython3.10\uff0c\u200b\u800c\u200bconda-pack\u200b\u5c06\u200b\u5176\u200b\u89e3\u6790\u200b\u4e3a\u200bpython3.1\u3002\u200b\u800c\u200bconda-pack0.7\u200b\u4ee5\u4e0a\u200b\u7248\u672c\u200b\u5df2\u7ecf\u200b\u89e3\u51b3\u200b\u4e86\u200b\u8fd9\u4e2a\u200bbug\n# \u200b\u5b89\u88c5\u200bconda-pack0.7\u200b\u4ee5\u4e0a\u200b\u7248\u672c\u200b\uff0c\u200b\u8fd9\u91cc\u200b\u662f\u200b0.8\nconda install conda-pack\n# \u200b\u4f7f\u7528\u200bconda-pack\nconda-pack -n pyspark_env_3.10 -o pyspark_env_3.10.tar.gz\n\n# \u200b\u8fd0\u884c\u200bspark\nspark-submit \\\n   --archives pyspark_env_3.10.tar.gz#pyspark_env \\\n   --master yarn \\\n   --deploy-mode client \\\n   --conf spark.yarn.appMasterEnv.PYSPARK_PYTHON=./pyspark_env/bin/python \\\n   --conf spark.yarn.appMasterEnv.PYSPARK_DRIVER_PYTHON=./pyspark_env/bin/python \\\n   --executor-memory 4G \\\n   --executor-cores 2 \\\n   --num-executors 6 \\\n   --queue spark \\\n   spark-3.2.1/job/read_hudi.py\n\n# \u200b\u4e5f\u200b\u53ef\u200b\u4e0a\u4f20\u200bhdfs\nhadoop fs -put pyspark_env_3.10.tar.gz /spark-jobs/jar\n\nspark-submit \\\n    --archives hdfs:///spark-jobs/jar/pyspark_env_3.10.tar.gz#pyspark_env \\\n   --master yarn \\\n   --deploy-mode client \\\n   --conf spark.yarn.appMasterEnv.PYSPARK_PYTHON=./pyspark_env/bin/python \\\n   --conf spark.yarn.appMasterEnv.PYSPARK_DRIVER_PYTHON=./pyspark_env/bin/python \\\n   --executor-memory 4G \\\n   --executor-cores 2 \\\n   --num-executors 6 \\\n   --queue spark \\\n   spark-3.2.1/job/read_hudi.py\n</code></pre></p>"},{"location":"bigdata/pyspark/#spark","title":"spark\u200b\u5e38\u89c1\u95ee\u9898\u200b\uff1a","text":""},{"location":"bigdata/pyspark/#_8","title":"\u95ee\u9898\u200b\u4e00\u200b\uff1a","text":"<p>\u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u51fa\u73b0\u200b\uff1aorg.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 0 \u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a shuffle\u200b\u5206\u4e3a\u200bshuffle write\u200b\u548c\u200bshuffle read\u200b\u4e24\u200b\u90e8\u5206\u200b\u3002 shuffle write\u200b\u7684\u200b\u5206\u533a\u200b\u6570\u7531\u200b\u4e0a\u4e00\u9636\u6bb5\u200b\u7684\u200bRDD\u200b\u5206\u533a\u200b\u6570\u200b\u63a7\u5236\u200b\uff0cshuffle read\u200b\u7684\u200b\u5206\u533a\u200b\u6570\u5219\u200b\u662f\u200b\u7531\u200bSpark\u200b\u63d0\u4f9b\u200b\u7684\u200b\u4e00\u4e9b\u200b\u53c2\u6570\u200b\u63a7\u5236\u200b\u3002 shuffle write\u200b\u53ef\u4ee5\u200b\u7b80\u5355\u200b\u7406\u89e3\u200b\u4e3a\u200b\u7c7b\u4f3c\u200b\u4e8e\u200bsaveAsLocalDiskFile\u200b\u7684\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u5c06\u200b\u8ba1\u7b97\u200b\u7684\u200b\u4e2d\u95f4\u200b\u7ed3\u679c\u200b\u6309\u200b\u67d0\u79cd\u200b\u89c4\u5219\u200b\u4e34\u65f6\u200b\u653e\u5230\u200b\u5404\u4e2a\u200bexecutor\u200b\u6240\u5728\u200b\u7684\u200b\u672c\u5730\u200b\u78c1\u76d8\u200b\u4e0a\u200b\u3002 shuffle read\u200b\u7684\u200b\u65f6\u5019\u200b\u6570\u636e\u200b\u7684\u200b\u5206\u533a\u200b\u6570\u5219\u200b\u662f\u200b\u7531\u200bspark\u200b\u63d0\u4f9b\u200b\u7684\u200b\u4e00\u4e9b\u200b\u53c2\u6570\u200b\u63a7\u5236\u200b\u3002\u200b\u53ef\u4ee5\u200b\u60f3\u5230\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u5982\u679c\u200b\u8fd9\u4e2a\u200b\u53c2\u6570\u503c\u200b\u8bbe\u7f6e\u200b\u7684\u200b\u5f88\u5c0f\u200b\uff0c\u200b\u540c\u65f6\u200bshuffle read\u200b\u7684\u200b\u91cf\u200b\u5f88\u5927\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5c06\u4f1a\u200b\u5bfc\u81f4\u200b\u4e00\u4e2a\u200btask\u200b\u9700\u8981\u200b\u5904\u7406\u200b\u7684\u200b\u6570\u636e\u200b\u975e\u5e38\u200b\u5927\u200b\u3002\u200b\u7ed3\u679c\u200b\u5bfc\u81f4\u200bJVM crash\uff0c\u200b\u4ece\u800c\u200b\u5bfc\u81f4\u200b\u53d6\u200bshuffle\u200b\u6570\u636e\u200b\u5931\u8d25\u200b\uff0c\u200b\u540c\u65f6\u200bexecutor\u200b\u4e5f\u200b\u4e22\u5931\u200b\u4e86\u200b\uff0c\u200b\u770b\u5230\u200bFailed to connect to host\u200b\u7684\u200b\u9519\u8bef\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200bexecutor lost\u200b\u7684\u200b\u610f\u601d\u200b\u3002\u200b\u6709\u65f6\u5019\u200b\u5373\u4f7f\u200b\u4e0d\u4f1a\u200b\u5bfc\u81f4\u200bJVM crash\u200b\u4e5f\u200b\u4f1a\u200b\u9020\u6210\u200b\u957f\u65f6\u95f4\u200b\u7684\u200bgc\u3002 \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a 1\u3001\u200b\u51cf\u5c11\u200bshuffle\u200b\u6570\u636e\u200b \u200b\u4e3b\u8981\u200b\u4ece\u200b\u4ee3\u7801\u200b\u5c42\u9762\u200b\u7740\u624b\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u4e0d\u5fc5\u8981\u200b\u7684\u200b\u6570\u636e\u200b\u5728\u200bshuffle\u200b\u524d\u200b\u8fdb\u884c\u200b\u8fc7\u6ee4\u200b\uff0c\u200b\u6bd4\u5982\u200b\u539f\u59cb\u6570\u636e\u200b\u6709\u200b20\u200b\u4e2a\u200b\u5b57\u200b\u6bb5\u200b\uff0c\u200b\u53ea\u8981\u200b\u9009\u53d6\u200b\u9700\u8981\u200b\u7684\u200b\u5b57\u200b\u6bb5\u200b\u8fdb\u884c\u200b\u5904\u7406\u200b\u5373\u53ef\u200b\uff0c\u200b\u5c06\u4f1a\u200b\u51cf\u5c11\u200b\u4e00\u5b9a\u200b\u7684\u200bshuffle\u200b\u6570\u636e\u200b\u3002 2\u3001\u200b\u4fee\u6539\u200b\u5206\u533a\u200b \u200b\u901a\u8fc7\u200bspark.sql.shuffle.partitions\u200b\u63a7\u5236\u200b\u5206\u533a\u200b\u6570\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b200\uff0c\u200b\u6839\u636e\u200bshuffle\u200b\u7684\u200b\u91cf\u200b\u4ee5\u53ca\u200b\u8ba1\u7b97\u200b\u7684\u200b\u590d\u6742\u5ea6\u200b\u9002\u5f53\u200b\u63d0\u9ad8\u200b\u8fd9\u4e2a\u200b\u503c\u200b\uff0c\u200b\u4f8b\u5982\u200b500\u3002 3\u3001\u200b\u589e\u52a0\u200b\u5931\u8d25\u200b\u7684\u200b\u91cd\u8bd5\u200b\u6b21\u6570\u200b\u548c\u200b\u91cd\u8bd5\u200b\u7684\u200b\u65f6\u95f4\u200b\u95f4\u9694\u200b \u200b\u901a\u8fc7\u200bspark.shuffle.io.maxRetries\u200b\u63a7\u5236\u200b\u91cd\u8bd5\u200b\u6b21\u6570\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u662f\u200b3\uff0c\u200b\u53ef\u200b\u9002\u5f53\u200b\u589e\u52a0\u200b\uff0c\u200b\u4f8b\u5982\u200b10\u3002 \u200b\u901a\u8fc7\u200bspark.shuffle.io.retryWait\u200b\u63a7\u5236\u200b\u91cd\u8bd5\u200b\u7684\u200b\u65f6\u95f4\u200b\u95f4\u9694\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u662f\u200b5s\uff0c\u200b\u53ef\u200b\u9002\u5f53\u200b\u589e\u52a0\u200b\uff0c\u200b\u4f8b\u5982\u200b10s\u3002 4\u3001\u200b\u63d0\u9ad8\u200bexecutor\u200b\u7684\u200b\u5185\u5b58\u200b \u200b\u5728\u200bspark-submit\u200b\u63d0\u4ea4\u200b\u4efb\u52a1\u200b\u65f6\u200b\uff0c\u200b\u9002\u5f53\u200b\u63d0\u9ad8\u200bexecutor\u200b\u7684\u200bmemory\u200b\u503c\u200b\uff0c\u200b\u4f8b\u5982\u200b15G\u200b\u6216\u8005\u200b20G\u3002</p>"},{"location":"bigdata/pyspark/#caused-by-orgapachesparksparkexception-could-not-execute-broadcast-in-300-secs-you-can-increase-the-timeout-for-broadcasts-via-sparksqlbroadcasttimeout-or-disable-broadcast-join-by-setting-sparksqlautobroadcastjointhreshold-to-1","title":"\u95ee\u9898\u200b\u4e8c\u200b\uff1a \u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u51fa\u73b0\u200b\uff1aCaused by: org.apache.spark.SparkException: Could not execute broadcast in 300 secs. You can increase the timeout for broadcasts via spark.sql.broadcastTimeout or disable broadcast join by setting spark.sql.autoBroadcastJoinThreshold to -1","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a \u200b\u4ece\u200b\u4e0a\u8ff0\u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u53ef\u4ee5\u200b\u770b\u51fa\u200b\u5728\u200bShuffleMapStage\u200b\u9636\u6bb5\u200b\uff0c\u200b\u4e5f\u200b\u5c31\u662f\u200bShuffleRead\u200b\u9636\u6bb5\u200b\uff0c\u200b\u5728\u200bDriver\u200b\u5728\u200b\u5411\u200b\u5404\u4e2a\u200bExecutor\u200b\u5e7f\u64ad\u200b\u8f93\u5165\u200b\u6570\u636e\u200b\u65f6\u5019\u200b\uff0c\u200b\u51fa\u73b0\u200b\u4e86\u200b\u8d85\u65f6\u200b\u73b0\u8c61\u200b\u3002 \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a   1\u3001\u200b\u9002\u5f53\u200b\u589e\u52a0\u200b\u8d85\u65f6\u200b\u65f6\u95f4\u200b\uff1aspark.sql.broadcastTimeout=800 2\u3001\u200b\u9002\u5f53\u200b\u589e\u52a0\u200b\u91cd\u8bd5\u200b\u6b21\u6570\u200b\uff1aspark.sql.broadcastMaxRetries=3 3\u3001\u200b\u5173\u95ed\u200b\u5e7f\u64ad\u200b\u53d8\u91cf\u200bjoin\uff1aset spark.sql.autoBroadcastJoinThreshold = -1  </p>"},{"location":"bigdata/pyspark/#orgapachesparksqlcatalystparserparseexception","title":"\u95ee\u9898\u200b\u4e09\u200b\uff1a \u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u51fa\u73b0\u200b\uff1aorg.apache.spark.sql.catalyst.parser.ParseException","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a spark\u200b\u5728\u200b\u505a\u200bsql\u200b\u8f6c\u5316\u200b\u65f6\u62a5\u200b\u9519\u200b\u3002 \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a \u200b\u68c0\u67e5\u200bsql\u200b\u662f\u5426\u200b\u4e66\u5199\u200b\u6b63\u786e\u200b</p>"},{"location":"bigdata/pyspark/#sparkexception-could-not-find-coarsegrainedscheduler","title":"\u95ee\u9898\u200b\u56db\u200b\uff1a \u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u51fa\u73b0\u200b\uff1aSparkException: Could not find CoarseGrainedScheduler","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a \u200b\u8fd9\u662f\u200b\u4e00\u4e2a\u200b\u8d44\u6e90\u200b\u95ee\u9898\u200b\u5e94\u8be5\u200b\u7ed9\u200b\u4efb\u52a1\u5206\u914d\u200b\u66f4\u200b\u591a\u200b\u7684\u200bcores\u200b\u548c\u200bexecutors\uff0c\u200b\u5e76\u4e14\u200b\u5206\u914d\u200b\u66f4\u200b\u591a\u200b\u7684\u200b\u5185\u5b58\u200b\u3002\u200b\u5e76\u4e14\u200b\u9700\u8981\u200b\u7ed9\u200bRDD\u200b\u5206\u914d\u200b\u66f4\u200b\u591a\u200b\u7684\u200b\u5206\u533a\u200b \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a 1\u3001\u200b\u8c03\u5927\u200b\u4e00\u4e0b\u200b\u8d44\u6e90\u200b\u548c\u200bcores\u200b\u548c\u200bexecuters\u200b\u7684\u200b\u6570\u91cf\u200b 2\u3001\u200b\u5728\u200b\u914d\u7f6e\u200b\u8d44\u6e90\u200b\u4e2d\u200b\u52a0\u5165\u200b\u8fd9\u53e5\u200b\u8bdd\u200b\u4e5f\u8bb8\u200b\u80fd\u200b\u89e3\u51b3\u200b\u4f60\u200b\u7684\u200b\u95ee\u9898\u200b\uff1a \u2013conf spark.dynamicAllocation.enabled=false</p>"},{"location":"bigdata/pyspark/#exception-in-thread-main-javalangnosuchmethoderror-scalacollectionimmutablec-o-l-o-n-coloncoloncolontl1lscalacollectionimmutablelist","title":"\u95ee\u9898\u200b\u4e94\u200b\uff1a \u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u51fa\u73b0\u200b\uff1aException in thread \u201cmain\u201d java.lang.NoSuchMethodError: scala.collection.immutable.c o l o n coloncoloncolon.tl$1()Lscala/collection/immutable/List;","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a scala\u200b\u7248\u672c\u200b\u4e0d\u200b\u4e00\u81f4\u200b\u95ee\u9898\u200b \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a 1\u3001\u200b\u901a\u8fc7\u200b\u7ed9\u200bspark\u200b\u4efb\u52a1\u200b\u6307\u5b9a\u200b\u76f8\u540c\u200b\u7248\u672c\u200b\u7684\u200b\u955c\u50cf\u200b \u2013conf spark.kubernetes.container.image=\u200b\u955c\u50cf\u200b\u5730\u5740\u200b</p>"},{"location":"bigdata/pyspark/#orgapachesparksparkexception-job-aborted-due-to-stage-failure-total-size-of-serialized-results-of-9478-tasks-10241-mib-is-bigger-than-sparkdrivermaxresultsize-10240-mib","title":"\u95ee\u9898\u200b\u516d\u200b\uff1a \u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u51fa\u73b0\u200b\uff1aorg.apache.spark.SparkException: Job aborted due to stage failure: Total size of serialized results of 9478 tasks (1024.1 MiB) is bigger than spark.driver.maxResultSize (1024.0 MiB)","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a \u200b\u5e8f\u5217\u5316\u200b\u7ed3\u679c\u200b\u96c6\u200b\u7684\u200b\u5927\u5c0f\u200b\u8d85\u8fc7\u200b\u4e86\u200bspark\u200b\u4efb\u52a1\u200b\u9ed8\u8ba4\u200b\u7684\u200b\u6700\u5927\u200b\u7ed3\u679c\u200b\u96c6\u200b\u5927\u5c0f\u200b\uff08\u200b\u9ed8\u8ba4\u200bspark.driver.maxResultSize\u200b\u4e3a\u200b1g\uff09 \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a 1\u3001\u200b\u589e\u52a0\u200bspark.driver.maxResultSize\u200b\u7684\u200b\u5927\u5c0f\u200b \u2013conf spark.driver.maxResultSize=2g  </p>"},{"location":"bigdata/pyspark/#the-executor-with-id-12-exited-with-exit-code-137","title":"\u95ee\u9898\u200b\u4e03\u200b\uff1a \u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u51fa\u73b0\u200b\uff1aThe executor with id 12 exited with exit code 137","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a executor\u200b\u5185\u5b58\u200b\u6ea2\u51fa\u200b\uff08oom\uff09 \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a 1\u3001\u200b\u589e\u52a0\u200bexecutor\u200b\u5185\u5b58\u200b \u200b\u793a\u4f8b\u200b\u53c2\u6570\u200b\uff1a\u2013conf spark.executor.memory=10g \u200b\u6ce8\u200b\uff1a\u200b\u5c11\u90e8\u5206\u200b\u60c5\u51b5\u200b\u4e3a\u200b\u5806\u5916\u200b\u5185\u5b58\u200b\uff08overhead memory\uff09\u200b\u4e0d\u8db3\u200b\uff0c\u200b\u9700\u8981\u200b\u589e\u52a0\u200b\u5806\u5916\u200b\u5185\u5b58\u200b \u200b\u793a\u4f8b\u200b\u53c2\u6570\u200b\uff1a\u2013conf spark.executor.memoryOverhead=5g</p>"},{"location":"bigdata/pyspark/#warn-tasksetmanager-lost-task-10-in-stage-00-tid-1-aalocal-executorlostfailure-executor-lost-warn-tasksetmanager-lost-task-692-in-stage-70-tid-1145-19216847217-javaioioexception-connection-from-1921684721755483-closed-javautilconcurrenttimeoutexception-futures-timed-out-after-120-second-error-transportchannelhandler-connection-to-1921684721235409-has-been-quiet-for-120000-ms-while-there-are-outstanding-requests-assuming-connection-is-dead-please-adjust-sparknetworktimeout-if-this-is-wrong","title":"\u95ee\u9898\u200b\u516b\u200b\uff1a WARN TaskSetManager: Lost task 1.0 in stage 0.0 (TID 1, aa.local): ExecutorLostFailure (executor lost) WARN TaskSetManager: Lost task 69.2 in stage 7.0 (TID 1145, 192.168.47.217): java.io.IOException: Connection from /192.168.47.217:55483 closed java.util.concurrent.TimeoutException: Futures timed out after [120 second ERROR TransportChannelHandler: Connection to /192.168.47.212:35409 has been quiet for 120000 ms while there are outstanding requests. Assuming connection is dead; please adjust spark.network.timeout if this is wrong","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a TaskSetManager: Lost task &amp; TimeoutException \u200b\u56e0\u4e3a\u200b\u7f51\u7edc\u200b\u6216\u8005\u200bgc\u200b\u7684\u200b\u539f\u56e0\u200b,worker\u200b\u6216\u200bexecutor\u200b\u6ca1\u6709\u200b\u63a5\u6536\u200b\u5230\u200bexecutor\u200b\u6216\u200btask\u200b\u7684\u200b\u5fc3\u8df3\u200b\u53cd\u9988\u200b \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a 1\u3001\u200b\u63d0\u9ad8\u200b spark.network.timeout \u200b\u7684\u200b\u503c\u200b\uff0c\u200b\u6839\u636e\u200b\u60c5\u51b5\u200b\u6539\u6210\u200b300(5min)\u200b\u6216\u200b\u66f4\u200b\u9ad8\u200b 2\u3001\u200b\u914d\u7f6e\u200b\u6240\u6709\u200b\u7f51\u7edc\u200b\u4f20\u8f93\u200b\u7684\u200b\u5ef6\u65f6\u200b\uff0c\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\u4e3b\u52a8\u200b\u8bbe\u7f6e\u200b\u4ee5\u4e0b\u200b\u53c2\u6570\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u8986\u76d6\u200b\u5176\u200b\u5c5e\u6027\u200b  </p>"},{"location":"bigdata/pyspark/#javalangoutofmemoryerror-not-enough-memory-to-build-and-broadcast","title":"\u95ee\u9898\u200b\u4e5d\u200b\uff1a \u200b\u65e5\u5fd7\u200b\u4e2d\u200b\u51fa\u73b0\u200b\uff1ajava.lang.OutOfMemoryError: Not enough memory to build and broadcast","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a Driver \u200b\u7aef\u200bOOM\u3002 Driver \u200b\u7aef\u7684\u200b OOM \u200b\u9003\u4e0d\u51fa\u200b 2 \u200b\u7c7b\u200b\u75c5\u7076\u200b\uff1a \u200b\u521b\u5efa\u200b\u7684\u200b\u6570\u636e\u200b\u96c6\u200b\u8d85\u8fc7\u200b\u5185\u5b58\u200b\u4e0a\u9650\u200b \u200b\u6536\u96c6\u200b\u7684\u200b\u7ed3\u679c\u200b\u96c6\u200b\u8d85\u8fc7\u200b\u5185\u5b58\u200b\u4e0a\u9650\u200b \u200b\u5e7f\u64ad\u200b\u53d8\u91cf\u200b\u5728\u200b\u521b\u5efa\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0c\u200b\u9700\u8981\u200b\u5148\u200b\u628a\u200b\u5206\u5e03\u200b\u5728\u200b\u6240\u6709\u200b Executors \u200b\u7684\u200b\u6570\u636e\u200b\u5206\u7247\u200b\u62c9\u53d6\u200b\u5230\u200b Driver \u200b\u7aef\u200b\uff0c\u200b\u7136\u540e\u200b\u5728\u200b Driver \u200b\u7aef\u200b\u6784\u5efa\u200b\u5e7f\u64ad\u200b\u53d8\u91cf\u200b\uff0c\u200b\u6700\u540e\u200b Driver \u200b\u7aef\u200b\u628a\u200b\u5c01\u88c5\u200b\u597d\u200b\u7684\u200b\u5e7f\u64ad\u200b\u53d8\u91cf\u200b\u518d\u200b\u5206\u200b\u53d1\u7ed9\u200b\u5404\u4e2a\u200b Executors\u3002\u200b\u7b2c\u4e00\u6b65\u200b\u7684\u200b\u6570\u636e\u200b\u62c9\u53d6\u200b\u5176\u5b9e\u200b\u5c31\u662f\u200b\u7528\u200b collect \u200b\u5b9e\u73b0\u200b\u7684\u200b\u3002\u200b\u5982\u679c\u200b Executors \u200b\u4e2d\u200b\u6570\u636e\u200b\u5206\u7247\u200b\u7684\u200b\u603b\u200b\u5927\u5c0f\u200b\u8d85\u8fc7\u200b Driver \u200b\u7aef\u200b\u5185\u5b58\u200b\u4e0a\u9650\u200b\u4e5f\u200b\u4f1a\u200b\u62a5\u200b OOM\u3002 \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a \u200b\u589e\u52a0\u200bdriver\u200b\u7aef\u7684\u200b\u5185\u5b58\u5927\u5c0f\u200b</p>"},{"location":"bigdata/pyspark/#javalangoutofmemoryerror-java-heap-space-at-javautilarrayscopyof-javalangoutofmemoryerror-java-heap-space-at-javalangreflectarraynewinstance","title":"\u95ee\u9898\u200b\u5341\u200b\uff1a java.lang.OutOfMemoryError: Java heap space at java.util.Arrays.copyOf java.lang.OutOfMemoryError: Java heap space at java.lang.reflect.Array.newInstance","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a executor\u200b\u7aef\u200bOOM User Memory \u200b\u7528\u4e8e\u200b\u5b58\u50a8\u7528\u6237\u200b\u81ea\u5b9a\u4e49\u200b\u7684\u200b\u6570\u636e\u7ed3\u6784\u200b\uff0c\u200b\u5982\u200b\u6570\u7ec4\u200b\u3001\u200b\u5217\u8868\u200b\u3001\u200b\u5b57\u5178\u200b\u7b49\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u5982\u679c\u200b\u8fd9\u4e9b\u200b\u6570\u636e\u7ed3\u6784\u200b\u7684\u200b\u603b\u200b\u5927\u5c0f\u200b\u8d85\u51fa\u200b\u4e86\u200b User Memory \u200b\u5185\u5b58\u200b\u533a\u57df\u200b\u7684\u200b\u4e0a\u9650\u200b\uff0c\u200b\u5c31\u200b\u4f1a\u200b\u51fa\u73b0\u200b\u8fd9\u6837\u200b\u7684\u200b\u62a5\u9519\u200b\u3002</p>"},{"location":"bigdata/pyspark/#spark-sql-insert-overwrite","title":"\u95ee\u9898\u200b\u5341\u4e00\u200b\uff1a spark sql \u200b\u6267\u884c\u200binsert overwrite\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u51fa\u73b0\u200b\u6570\u636e\u200b\u91cd\u590d\u200b\u3002","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a Spark SQL\u200b\u5728\u200b\u6267\u884c\u200bSQL\u200b\u7684\u200boverwrite\u200b\u7684\u200b\u65f6\u5019\u200b\u5e76\u200b\u6ca1\u6709\u200b\u5220\u9664\u200b\u65e7\u200b\u7684\u200b\u7684\u200b\u6570\u636e\u6587\u4ef6\u200b\uff08Spark SQL\u200b\u751f\u6210\u200b\u7684\u200b\u6570\u636e\u6587\u4ef6\u200b\uff09\uff0cSpark SQL\u200b\u5199\u5165\u200bHive\u200b\u7684\u200b\u6d41\u7a0b\u200b\u5982\u4e0b\u200b\uff1a</p> <p>1.Spark\u200b\u5199\u5165\u200bHive\u200b\u4f1a\u200b\u5148\u751f\u200b\u6210\u200b\u4e00\u4e2a\u200b\u4e34\u65f6\u200b\u7684\u200b_temporary\u200b\u76ee\u5f55\u200b\u7528\u4e8e\u200b\u5b58\u50a8\u200b\u751f\u6210\u200b\u7684\u200b\u6570\u636e\u6587\u4ef6\u200b\uff0c\u200b\u5168\u90e8\u200b\u751f\u6210\u200b\u5b8c\u6bd5\u200b\u540e\u200b\u5168\u90e8\u200b\u79fb\u52a8\u200b\u5230\u200b\u8f93\u51fa\u200b\u76ee\u5f55\u200b\uff0c\u200b\u7136\u540e\u200b\u5220\u9664\u200b_temporary\u200b\u76ee\u5f55\u200b\uff0c\u200b\u6700\u540e\u200b\u521b\u5efa\u200bHive\u200b\u5143\u200b\u6570\u636e\u200b\uff08\u200b\u5199\u200b\u5206\u533a\u200b\uff09\uff1b 2.Spark\u200b\u5199\u5165\u200b\u6570\u636e\u200b\u4efb\u52a1\u200b\u4f7f\u7528\u200b\u4e86\u200b\u540c\u4e00\u4e2a\u200b_temporary\u200b\u76ee\u5f55\u200b\uff0c\u200b\u5bfc\u81f4\u200b\u5176\u4e2d\u200b\u4e00\u4e2a\u200b\u5b8c\u6210\u200b\u6570\u636e\u200b\u751f\u6210\u200b\u548c\u200b\u79fb\u52a8\u200b\u5230\u200bHive\u200b\u8def\u5f84\u200b\u4e4b\u540e\u200b\u5220\u9664\u200b_temporary\u200b\u76ee\u5f55\u200b\u5931\u8d25\u200b\uff08\u200b\u4efb\u52a1\u200b\u88ab\u200bkill\u200b\u6389\u200b\u4e86\u200b\uff09\uff0c\u200b\u8fdb\u4e00\u6b65\u200b\u5bfc\u81f4\u200b\u6570\u636e\u200b\u5df2\u7ecf\u200b\u5230\u200b\u4e86\u200b\u4f46\u662f\u200b\u5143\u200b\u6570\u636e\u200b\u6ca1\u6709\u200b\u521b\u5efa\u200b\u3002 3.\u200b\u4e0a\u200b\u4e00\u4e2a\u200b\u4efb\u52a1\u200b\u867d\u7136\u200b\u751f\u6210\u200b\u4e86\u200b\u6570\u636e\u6587\u4ef6\u200b\u4f46\u662f\u200b\u6ca1\u6709\u200b\u5143\u200b\u6570\u636e\u200b\uff0c\u200b\u5219\u200b\u540e\u200b\u4e00\u4e2a\u200b\u4efb\u52a1\u200b\u7684\u200boverwrite\u200b\u627e\u200b\u4e0d\u5230\u200b\u5143\u200b\u6570\u636e\u200b\u56e0\u6b64\u200b\u65e0\u6cd5\u200b\u5220\u9664\u200bHive\u200b\u8def\u5f84\u200b\u4e0b\u200b\u7684\u200b\u6570\u636e\u6587\u4ef6\u200b\uff08\u200b\u7b2c\u4e8c\u4e2a\u200b\u4efb\u52a1\u200b\u4f1a\u200b\u4efb\u52a1\u200b\u76ee\u5f55\u200b\u4e0b\u200b\u6ca1\u6709\u200b\u6570\u636e\u200b\u751f\u6210\u200b\uff09 4.\u200b\u5f53\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u6267\u884c\u200b\u5b8c\u6210\u200b\u7684\u200bSpark\u200b\u63d2\u5165\u200b\u4efb\u52a1\u200b\u7ed3\u675f\u200b\u540e\u200b\uff0c\u200b\u6b64\u65f6\u200bHive\u200b\u8def\u5f84\u200b\u4e0b\u200b\u5df2\u7ecf\u200b\u79fb\u52a8\u200b\u8fc7\u6765\u200b\u591a\u4e2a\u200b\u4efb\u52a1\u200b\u7684\u200b\u6570\u636e\u6587\u4ef6\u200b\uff0c\u200b\u7531\u4e8e\u200b\u5df2\u7ecf\u200b\u6ca1\u6709\u200b\u6b63\u5728\u200b\u6267\u884c\u200b\u7684\u200bSpark\u200b\u5199\u200b\u4efb\u52a1\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5220\u9664\u200b_temporary\u200b\u76ee\u5f55\u200b\u6210\u529f\u200b\uff0c\u200b\u521b\u5efa\u200b\u5143\u200b\u6570\u636e\u200b\u6210\u529f\u200b\uff0c\u200b\u7ed3\u679c\u200b\u5c31\u662f\u200b\u8fd9\u4e2a\u200b\u5143\u200b\u6570\u636e\u200b\u5bf9\u5e94\u200b\u4e86\u200b\u8be5\u200bHive\u200b\u8def\u5f84\u200b\u4e0b\u200b\u6240\u6709\u200b\u7248\u672c\u200b\u7684\u200b\u6570\u636e\u6587\u4ef6\u200b\u3002</p>"},{"location":"bigdata/pyspark/#spark105","title":"\u95ee\u9898\u200b\u5341\u4e8c\u200b\uff1a Spark\u200b\u4efb\u52a1\u200b\u6b63\u5e38\u200b\u6267\u884c\u200b10\u200b\u5206\u949f\u200b\u5de6\u53f3\u200b\uff0c\u200b\u4f46\u662f\u200b\u5076\u5c14\u200b\u4f1a\u200b\u51fa\u73b0\u200b\u4efb\u52a1\u200b\u8fd0\u884c\u200b\u65f6\u95f4\u200b\u8fc7\u957f\u200b\u6bd4\u5982\u200b5\u200b\u4e2a\u200b\u5c0f\u65f6\u200b\u5de6\u53f3","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a \u200b\u901a\u8fc7\u200bspark ui\u200b\u770b\u5230\u200bspark\u200b\u4efb\u52a1\u200b\u7684\u200btask\u200b\u8fd0\u884c\u200b\u90fd\u200b\u662f\u200b\u5728\u200b10\u200b\u5206\u949f\u200b\u5de6\u53f3\u200b\uff0c\u200b\u6709\u200b\u4e00\u4e2a\u200btask\u200b\u8fd0\u884c\u200b\u65f6\u95f4\u200b\u8fbe\u5230\u200b\u4e86\u200b5.4h\u200b\u4e00\u76f4\u200b\u6ca1\u6709\u200b\u8fd0\u884c\u200b\u5b8c\u6210\u200b\u3002 \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a \u200b\u8bbe\u7f6e\u200b\u8fd9\u4e2a\u200b\u53c2\u6570\u200bspark.speculation=true\uff1b \u200b\u539f\u7406\u200b\uff1a\u200b\u5728\u200bSpark\u200b\u4e2d\u200b\u4efb\u52a1\u200b\u4f1a\u4ee5\u200bDAG\u200b\u56fe\u200b\u7684\u200b\u65b9\u5f0f\u200b\u5e76\u884c\u6267\u884c\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u8282\u70b9\u200b\u90fd\u200b\u4f1a\u200b\u5e76\u884c\u200b\u7684\u200b\u8fd0\u884c\u200b\u5728\u200b\u4e0d\u540c\u200b\u7684\u200bexecutor\u200b\u4e2d\u200b\uff0c\u200b\u4f46\u662f\u200b\u6709\u200b\u7684\u200b\u4efb\u52a1\u200b\u53ef\u80fd\u200b\u6267\u884c\u200b\u5f88\u5feb\u200b\uff0c\u200b\u6709\u200b\u7684\u200b\u4efb\u52a1\u200b\u6267\u884c\u200b\u5f88\u200b\u6162\u200b\uff0c\u200b\u6bd4\u5982\u200b\u7f51\u7edc\u200b\u6296\u52a8\u200b\u3001\u200b\u6027\u80fd\u200b\u4e0d\u540c\u200b\u3001\u200b\u6570\u636e\u200b\u503e\u659c\u200b\u7b49\u7b49\u200b\u3002\u200b\u6709\u200b\u7684\u200bTask\u200b\u5f88\u6162\u200b\u5c31\u200b\u4f1a\u200b\u6210\u4e3a\u200b\u6574\u4e2a\u200b\u4efb\u52a1\u200b\u7684\u200b\u74f6\u9888\u200b\uff0c\u200b\u6b64\u65f6\u200b\u53ef\u4ee5\u200b\u89e6\u53d1\u200b \u200b\u63a8\u6d4b\u200b\u6267\u884c\u200b (speculative) \u200b\u529f\u80fd\u200b\uff0c\u200b\u4e3a\u200b\u957f\u65f6\u95f4\u200b\u7684\u200btask\u200b\u91cd\u65b0\u542f\u52a8\u200b\u4e00\u4e2a\u200btask\uff0c\u200b\u54ea\u4e2a\u200b\u5148\u200b\u5b8c\u6210\u200b\u5c31\u200b\u4f7f\u7528\u200b\u54ea\u4e2a\u200b\u7684\u200b\u7ed3\u679c\u200b\uff0c\u200b\u5e76\u200bKill\u200b\u6389\u200b\u53e6\u200b\u4e00\u4e2a\u200btask\u3002</p>"},{"location":"bigdata/pyspark/#orgapachesparkshufflefetchfailedexception-the-relative-remote-executorid-21-which-maintains-the-block-data-to-fetch-is-dead","title":"\u95ee\u9898\u200b\u5341\u4e09\u200b\uff1a org.apache.spark.shuffle.FetchFailedException: The relative remote executor(Id: 21), which maintains the block data to fetch is dead.","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a \u200b\u8d44\u6e90\u200b\u4e0d\u8db3\u200b\u5bfc\u81f4\u200bexecutor\u200b\u6ca1\u6709\u200b\u5fc3\u8df3\u200b\uff0cdriver\u200b\u5c31\u200b\u5224\u5b9a\u200b\u5176\u200b\u4e22\u5931\u200b\uff0c\u200b\u5c31\u200b\u53bb\u200b\u8fde\u200b\u5176\u4ed6\u200b\u7684\u200bexecutor\uff0c\u200b\u4f46\u200b\u5176\u4ed6\u200b\u7684\u200b\u56e0\u4e3a\u200b\u914d\u7f6e\u200b\u90fd\u200b\u4e00\u6837\u200b\uff0c\u200b\u6240\u4ee5\u200b\u4e5f\u200b\u8fde\u4e0d\u4e0a\u200b\u3002\u200b\u91cd\u8bd5\u200bn\u200b\u6b21\u540e\u200b\uff0c\u200b\u5c31\u200b\u4f1a\u200b\u62a5\u9519\u200b</p> <p>\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a \u200b\u51cf\u5c11\u200b\u4f7f\u7528\u200b\u89e6\u53d1\u200bshuffle\u200b\u7684\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4f8b\u5982\u200breduceByKey\uff0c\u200b\u4ece\u800c\u200b\u51cf\u5c11\u200b\u4f7f\u7528\u200b\u5185\u5b58\u200b \u200b\u589e\u5927\u200bspark.network.timeout\uff0c\u200b\u4ece\u800c\u200b\u5141\u8bb8\u200b\u6709\u200b\u66f4\u200b\u591a\u200b\u65f6\u95f4\u200b\u53bb\u200b\u7b49\u5f85\u200b\u5fc3\u8df3\u200b\u54cd\u5e94\u200b \u200b\u589e\u52a0\u200bspark.executor.cores\uff0c\u200b\u4ece\u800c\u200b\u51cf\u5c11\u200b\u521b\u5efa\u200b\u7684\u200bExecutor\u200b\u6570\u91cf\u200b\uff0c\u200b\u4f7f\u5f97\u200b\u603b\u200b\u4f7f\u7528\u200b\u5185\u5b58\u200b\u51cf\u5c11\u200b \u200b\u540c\u65f6\u200b\u589e\u5927\u200bspark.executor.memory\uff0c\u200b\u4fdd\u8bc1\u200b\u6bcf\u4e2a\u200bExecutor\u200b\u6709\u200b\u8db3\u591f\u200b\u7684\u200b\u53ef\u7528\u5185\u5b58\u200b \u200b\u589e\u5927\u200bspark.shuffle.memoryFraction\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b0.2(\u200b\u9700\u8981\u200bspark.memory.useLegacyMode\u200b\u914d\u7f6e\u200b\u4e3a\u200btrue\uff0c\u200b\u9002\u7528\u200b\u4e8e\u200b1.5\u200b\u6216\u200b\u66f4\u200b\u65e7\u7248\u672c\u200b\uff0c\u200b\u5df2\u7ecf\u200bdeprecated) \u200b\u4f8b\u200b\uff1a -conf spark.driver.memory=10g \u2014conf spark.executor.cores=2 --conf spark.executor.memory=24g --conf spark.executor.memoryOverhead=4g --conf spark.default.parallelism=1500 --conf spark.sql.shuffle.partitions=1500 \u2014conf spark.network.timeout=300 -conf spark.driver.memory=10g -conf spark.executor.cores=2 --conf spark.executor.memory=24g --conf spark.executor. memory\u200b\u5f00\u9500\u200b=4g --conf spark.default.parallelism=1500 --conf spark.sql.shuffle.partitions=1500 -conf spark.network.timeout=300  </p>"},{"location":"bigdata/pyspark/#javaioioexception-javaioeofexception-unexpected-end-of-input-stream","title":"\u95ee\u9898\u200b\u5341\u56db\u200b\uff1a java.io.IOException: java.io.EOFException: Unexpected end of input stream","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a spark\u200b\u4efb\u52a1\u200b\u8f93\u5165\u200b\u6570\u636e\u200b\u5f02\u5e38\u200b\uff0cspark\u200b\u4efb\u52a1\u200b\u8bfb\u53d6\u200bgz\u200b\u683c\u5f0f\u200b\u538b\u7f29\u200b\u7684\u200bcsv\u200b\u6587\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u7531\u4e8e\u200b\u5b58\u5728\u200b\u5f02\u5e38\u200b\u6570\u636e\u200b\u53d1\u751f\u200b\u62a5\u9519\u200b\u3002gz\u200b\u683c\u5f0f\u200b\u538b\u7f29\u200b\u7684\u200b\u6587\u4ef6\u200b\u5b58\u5728\u200b\u7a7a\u200b\u6570\u636e\u200b \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a 1.\u200b\u5b9a\u4f4d\u200b\u5230\u200b\u5f02\u5e38\u200b\u6570\u636e\u200b\u6e05\u9664\u200b\u5373\u53ef\u200b 2.\u200b\u8fc7\u6ee4\u200b\u5f02\u5e38\u200b\u6570\u636e\u200b\u76f4\u63a5\u200b\u5199\u5165\u200b  </p>"},{"location":"bigdata/pyspark/#exception-in-thread-main-javalangnosuchmethoderror-scalapredefrefarrayopsljavalangobjectljavalangobject","title":"\u95ee\u9898\u200b\u5341\u4e94\u200b\uff1a Exception in thread \u201cmain\u201d java.lang.NoSuchMethodError: scala.Predef$.refArrayOps([Ljava/lang/Object;)[Ljava/lang/Object;","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a scala\u200b\u7248\u672c\u200b\u4e0d\u200b\u4e00\u81f4\u200b \u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a \u200b\u66f4\u6362\u200b \u200b\u670d\u52a1\u200bscala\u200b\u7248\u672c\u200b\u4e00\u81f4\u200b\u7684\u200b\u955c\u50cf\u200b</p>"},{"location":"bigdata/pyspark/#javalangstackoverflowerror-at-orgcodehausjaninocodecontextextract16bitvaluecodecontextjava763-at-orgcodehausjaninocodecontextflowanalysiscodecontextjava600","title":"\u95ee\u9898\u200b\u5341\u516d\u200b\uff1a : java.lang.StackOverflowError at org.codehaus.janino.CodeContext.extract16BitValue(CodeContext.java:763) at org.codehaus.janino.CodeContext.flowAnalysis(CodeContext.java:600)","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a jvm\u200b\u5806\u6808\u200b\u6ea2\u51fa\u200b\uff0c\u200b\u4e00\u822c\u6765\u8bf4\u200b\uff0c\u200b\u51fa\u73b0\u200b\u8fd9\u4e2a\u200b\u9519\u8bef\u200b\u6709\u200b\u53ef\u80fd\u200b\u662f\u56e0\u4e3a\u200b\u4ee3\u7801\u200b\u4e2d\u200b\u51fa\u73b0\u200b\u4e86\u200b\u9012\u5f52\u200b\u67e5\u8be2\u200b\u6216\u8005\u200b\u6267\u884c\u200b\u8ba1\u5212\u200bDAG\u200b\u592a\u5927\u200b\u4e86\u200b\uff0c\u200b\u5728\u200b\u6211\u200b\u7684\u200b\u4f8b\u5b50\u200b\u4e2d\u200b\uff0c\u200b\u51fa\u73b0\u200b\u8fd9\u4e2a\u200b\u95ee\u9898\u200b\u7684\u200b\u539f\u56e0\u200b\u662f\u200b\u6211\u200b\u4f7f\u7528\u200bfor \u200b\u5faa\u73af\u200b union\u200b\u4e86\u200b56\u200b\u4e2a\u200bdf\uff0c\u200b\u5e76\u4e14\u200b\u6211\u200b\u7684\u200bsql\u200b\u4e2d\u6709\u200b\u5f88\u591a\u200blike\u200b\u8bed\u53e5\u200b\u7684\u200bor\u200b\u8bed\u53e5\u200b\uff08or\u200b\u7684\u200b\u5904\u7406\u200b\u662f\u200b\u9012\u5f52\u200b\uff0cor\u200b\u975e\u5e38\u200b\u591a\u65f6\u200b\uff0c\u200b\u4f1a\u200b\u53d1\u751f\u200b\u5927\u91cf\u200b\u7684\u200b\u9012\u5f52\u200b\uff09\uff0c\u200b\u8fd9\u200b\u5bfc\u81f4\u200b\u4e86\u200b\u6211\u200b\u7684\u200b\u6267\u884c\u200b\u8ba1\u5212\u200b\u975e\u5e38\u200b\u5927\u200b\u3002  \u200b\u5f53\u200bSparkSQL\u200b\u7684\u200bsql\u200b\u8bed\u53e5\u200b\u6709\u200b\u6210\u767e\u4e0a\u5343\u200b\u7684\u200bor\u200b\u5173\u952e\u5b57\u200b\u65f6\u200b\uff0c\u200b\u5c31\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u51fa\u73b0\u200bDriver\u200b\u7aef\u7684\u200bJVM\u200b\u6808\u200b\u5185\u5b58\u200b\u6ea2\u51fa\u200b\u3002 \u200b\u901a\u5e38\u200b\u7684\u200b\u5904\u7406\u200b\u65b9\u5f0f\u200b\u662f\u200b\u5c06\u200b\u4e00\u6761\u200bsql\u200b\u8bed\u53e5\u200b\u62c6\u200b\u5206\u4e3a\u200b\u591a\u6761\u200bsql\u200b\u8bed\u53e5\u200b\u6765\u200b\u6267\u884c\u200b\uff0c\u200b\u6bcf\u6761\u200bsql\u200b\u8bed\u53e5\u200b\u5c3d\u91cf\u200b\u4fdd\u8bc1\u200b100\u200b\u4e2a\u200b\u4ee5\u5185\u200b\u7684\u200b\u5b50\u53e5\u200b\uff0c\u200b\u4e00\u6761\u200bsql\u200b\u8bed\u53e5\u200b\u7684\u200bor\u200b\u5173\u952e\u5b57\u200b\u63a7\u5236\u200b\u5728\u200b100\u200b\u4e2a\u200b\u4ee5\u5185\u200b\uff0c\u200b\u901a\u5e38\u200b\u4e0d\u4f1a\u200b\u5bfc\u81f4\u200bJVM\u200b\u6808\u200b\u5185\u5b58\u200b\u6ea2\u51fa\u200b\u3002</p> <p>\u200b\u89e3\u51b3\u65b9\u6848\u200b\u662f\u200b\uff1a  1. spark.driver.extraJavaOptions spark.executor.extraJavaOptions  </p> <p>\u200b\u6709\u5173\u200b\u4e0e\u200b\u8fd9\u200b\u4e24\u4e2a\u200b\u53c2\u6570\u200b\u7684\u200b\u7528\u6cd5\u200b\u53ef\u200b\u53c2\u8003\u200b\uff1a https://tsaiprabhanj.medium.com/spark-extrajavaoptions-2d8799ff9181</p> <ol> <li>\u200b\u6839\u636e\u200b\u6587\u7ae0\u200b\uff1a https://botkampa.medium.com/how-to-fix-java-lang-stackoverflow-when-training-your-ml-model-in-spark-d4db3ff6af37 \u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200bcheckpoint()\u200b\u6216\u8005\u200bcache()\u200b\u6765\u200b\u51cf\u5c0f\u200bDAG\u200b\u7684\u200b\u5927\u5c0f\u200b\u3002 \u200b\u4ee5\u4e0b\u200b\u662f\u200b\u8be5\u200b\u6587\u7ae0\u200b\u7684\u200b\u89e3\u51b3\u200b\u65b9\u6cd5\u200b\u793a\u4f8b\u200b\uff1a <pre><code>spark = SparkSession.builder \\\n    .appName(\"Confidence Model\") \\\n    .enableHiveSupport() \\\n    .getOrCreate()\n\n# I told spark to use dir called `checkpoint` to \n# store checkpoints.\nsc = spark.sparkContext\nsc.setCheckpointDir('checkpoint')\n\n#... some other things\n\n# Feature engineering section\n# assuming lot more features to be computed and added here.\n# Or there are so many JOINs.\nwindow = Window.partitionBy('id')\nfeature_profile_df = feature_profile_df\\\n.withColumn(\"crazy_logic_1\", \"crazy logics here\")\\\n.withColumn(\"crazy_logic_2\", \"crazy logics here\")\\\n.join(other_df, \"id\", \"outer\")\\\n#...lots of them coming here\n.withColumn(\"crazy_logic_1000\", \"crazy logics here\")\\\n# I'm sure the DAG size is pretty big now.\n\n# add checkpoint here to consolidate the DAG size in the next step.\nfeature_profile_df.checkpoint()\n\n# check the size of DAG\n# Use extended=True to appreciate the full length of physical plan\nfeature_profile_df.explain(extended=True)\n\n# Now you can use the data to train model.\n# Without feature_profile_df.checkpoint() in line 22\n# this may results in StackOverflow error.\nmodel = pipeline.fit(feature_profile_df)\n</code></pre> <pre><code>### This may cause Py4JJavaError: An error occurred while calling o1019.fit.: java.lang.StackOverflowError\ntrain_df = train_df.select(cols)\ntrain_df.cache()\ntrain_df.checkpoint()\ntrain_df.show(n=3, truncate=False, vertical=True)\ntrain_df.show\uff08n=3\uff0ctruncate=False\uff0cvertical=True\uff09\n\n#... many cache() and .checkpoint() thingies in between, but not relevant to train_df at all\n\nmodel_pred = pipeline_pred.fit(train_df)\n\n### However, the problem above can be resolved by just moving\n### cache() and show() right before .fit() like this:\n\ntrain_df = train_df.select(cols)\n\n#... many cache() and .checkpoint() thingies in between, but not relevant to train_df at all\n#...\u200b\u8bb8\u591a\u200bcache\uff08\uff09\u200b\u548c\u200b.checkpoint\uff08\uff09\u200b\u7684\u200b\u4e1c\u897f\u200b\u5728\u200b\u4e2d\u95f4\u200b\uff0c\u200b\u4f46\u200b\u4e0e\u200btrain_df\u200b\u5b8c\u5168\u200b\u65e0\u5173\u200b\n\ntrain_df.cache()\n# Note that .checkpoint() is not even used here:\ntrain_df.show(n=3, truncate=False, vertical=True)\n</code></pre> \u200b\u540c\u65f6\u200b\uff0c\u200b\u6587\u7ae0\u200b\u6307\u51fa\u200b\u628a\u200bdf\u200b\u8f6c\u4e3a\u200brdd\u200b\u5728\u200b\u8f6c\u4e3a\u200bdf\u200b\u4e5f\u200b\u662f\u200b\u4e00\u79cd\u200b\u53ef\u4ee5\u200b\u6709\u6548\u200b\u51cf\u5c11\u200bDAG\u200b\u7684\u200b\u65b9\u6cd5\u200b <pre><code>train_df = spark.createDataFrame(train_df.rdd, schema=train_df.schema)\n</code></pre></li> </ol>"},{"location":"bigdata/pyspark/#error-codegenerator-failed-to-compile-orgcodehausjaninointernalcompilerexception-compiling-generatedclass-in-generatedjava-code-of-method-processnextv-of-class-orgapachesparksqlcatalystexpressionsgeneratedclassgeneratediteratorforcodegenstage1-grows-beyond-64-kb","title":"\u95ee\u9898\u200b\u5341\u4e03\u200b\uff1a  ERROR CodeGenerator: failed to compile: org.codehaus.janino.InternalCompilerException: Compiling \"GeneratedClass\" in \"generated.java\": Code of method \"processNext()V\" of class \"org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1\" grows beyond 64 KB","text":"<p>\u200b\u539f\u56e0\u200b\u5206\u6790\u200b\uff1a \u200b\u6b64\u200b\u95ee\u9898\u200b\u4f34\u968f\u200b\u7740\u200b\u95ee\u9898\u200b\u5341\u516d\u200b\u4e00\u8d77\u200b\u51fa\u73b0\u200b\uff0c\u200b\u539f\u56e0\u200b\u5728\u4e8e\u200b\u4f7f\u7528\u200bCatalyst\u200b\u4ece\u200b\u4f7f\u7528\u200bDataFrame\u200b\u548c\u200bDataset\u200b\u7684\u200b\u7a0b\u5e8f\u200b\u751f\u6210\u200bJava\u200b\u7a0b\u5e8f\u200b\u7f16\u8bd1\u6210\u200bJava\u200b\u5b57\u8282\u200b\u7801\u65f6\u200b\uff0c\u200b\u4e00\u4e2a\u200b\u65b9\u6cd5\u200b\u7684\u200b\u5b57\u8282\u200b\u7801\u200b\u5927\u5c0f\u200b\u4e0d\u80fd\u200b\u8d85\u8fc7\u200b64 KB\uff0c\u200b\u8fd9\u200b\u4e0e\u200bJava\u200b\u7c7b\u200b\u6587\u4ef6\u200b\u7684\u200b\u9650\u5236\u200b\u76f8\u51b2\u7a81\u200b\u3002 \u200b\u89e3\u51b3\u65b9\u6848\u200b\u4e3a\u200b\uff1a spark.sql.codegen.wholeStage= \"false\" \u200b\u6765\u6e90\u200b\u4e0e\u200b\uff1ahttps://stackoverflow.com/questions/50891509/apache-spark-codegen-stage-grows-beyond-64-kb</p>"},{"location":"bigdata/pyspark/#spark-web-uilocality_level","title":"\u95ee\u9898\u200b\u5341\u516b\u200b\uff1a \u200b\u5173\u4e8e\u200bspark web ui\u200b\u4e0a\u200b\u7684\u200bLocality_level:","text":"<p>PROCESS_LOCAL \u200b\u8fdb\u7a0b\u200b\u672c\u5730\u5316\u200b\uff0c\u200b\u8868\u793a\u200b task \u200b\u8981\u200b\u8ba1\u7b97\u200b\u7684\u200b\u6570\u636e\u200b\u5728\u200b\u540c\u4e00\u4e2a\u200b Executor \u200b\u4e2d\u200b\u3002  </p> <p>NODE_LOCAL \u200b\u8282\u70b9\u200b\u672c\u5730\u5316\u200b\uff0c\u200b\u901f\u5ea6\u200b\u7a0d\u6162\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u6570\u636e\u200b\u9700\u8981\u200b\u5728\u200b\u4e0d\u540c\u200b\u7684\u200b\u8fdb\u7a0b\u200b\u4e4b\u95f4\u200b\u4f20\u9012\u200b\u6216\u200b\u4ece\u6587\u4ef6\u200b\u4e2d\u200b\u8bfb\u53d6\u200b\u3002\u200b\u5206\u4e3a\u200b\u4e24\u79cd\u200b\u60c5\u51b5\u200b\uff0c\u200b\u7b2c\u4e00\u79cd\u200b\uff1atask \u200b\u8981\u200b\u8ba1\u7b97\u200b\u7684\u200b\u6570\u636e\u200b\u662f\u200b\u5728\u200b\u540c\u4e00\u4e2a\u200b worker \u200b\u7684\u200b\u4e0d\u540c\u200b Executor \u200b\u8fdb\u7a0b\u200b\u4e2d\u200b\u3002\u200b\u7b2c\u4e8c\u79cd\u200b\uff1atask \u200b\u8981\u200b\u8ba1\u7b97\u200b\u7684\u200b\u6570\u636e\u200b\u662f\u200b\u5728\u200b\u540c\u4e00\u4e2a\u200b worker \u200b\u7684\u200b\u78c1\u76d8\u200b\u4e0a\u200b\uff0c\u200b\u6216\u200b\u5728\u200b HDFS \u200b\u4e0a\u200b\u6070\u597d\u200b\u6709\u200b block \u200b\u5728\u200b\u540c\u4e00\u4e2a\u200b\u8282\u70b9\u200b\u4e0a\u200b\u3002\u200b\u5982\u679c\u200b Spark \u200b\u8981\u200b\u8ba1\u7b97\u200b\u7684\u200b\u6570\u636e\u200b\u6765\u6e90\u4e8e\u200b HDFSD \u200b\u4e0a\u200b\uff0c\u200b\u90a3\u4e48\u200b\u6700\u597d\u200b\u7684\u200b\u672c\u5730\u5316\u200b\u7ea7\u522b\u200b\u5c31\u662f\u200b NODE_LOCAL\u3002  </p> <p>NO_PREF \u200b\u6ca1\u6709\u200b\u6700\u4f73\u200b\u4f4d\u7f6e\u200b\uff0c\u200b\u6570\u636e\u200b\u4ece\u200b\u54ea\u200b\u8bbf\u95ee\u200b\u90fd\u200b\u4e00\u6837\u200b\u5feb\u200b\uff0c\u200b\u4e0d\u200b\u9700\u8981\u200b\u4f4d\u7f6e\u200b\u4f18\u5148\u200b\u3002\u200b\u6bd4\u5982\u200b Spark SQL \u200b\u4ece\u200b Mysql \u200b\u4e2d\u200b\u8bfb\u53d6\u6570\u636e\u200b\u3002  </p> <p>RACK_LOCAL \u200b\u673a\u67b6\u200b\u672c\u5730\u5316\u200b\uff0c\u200b\u6570\u636e\u200b\u5728\u200b\u540c\u4e00\u200b\u673a\u67b6\u200b\u7684\u200b\u4e0d\u540c\u200b\u8282\u70b9\u200b\u4e0a\u200b\u3002\u200b\u9700\u8981\u200b\u901a\u8fc7\u200b\u7f51\u7edc\u200b\u4f20\u8f93\u6570\u636e\u200b\u4ee5\u53ca\u200b\u6587\u4ef6\u200b IO\uff0c\u200b\u6bd4\u200b NODE_LOCAL \u200b\u6162\u200b\u3002\u200b\u60c5\u51b5\u200b\u4e00\u200b\uff1atask \u200b\u8ba1\u7b97\u200b\u7684\u200b\u6570\u636e\u200b\u5728\u200b worker2 \u200b\u7684\u200b EXecutor \u200b\u4e2d\u200b\u3002\u200b\u60c5\u51b5\u200b\u4e8c\u200b\uff1atask \u200b\u8ba1\u7b97\u200b\u7684\u200b\u6570\u636e\u200b\u5728\u200b work2 \u200b\u7684\u200b\u78c1\u76d8\u200b\u4e0a\u200b\u3002  </p> <p>ANY \u200b\u8de8\u200b\u673a\u67b6\u200b\uff0c\u200b\u6570\u636e\u200b\u5728\u200b\u975e\u200b\u540c\u4e00\u200b\u673a\u67b6\u200b\u7684\u200b\u7f51\u7edc\u200b\u4e0a\u200b\uff0c\u200b\u901f\u5ea6\u200b\u6700\u6162\u200b\u3002  </p> <p>\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u8bbe\u7f6e\u200bspark.locality.wait\u200b\u589e\u52a0\u200b\u7b49\u5f85\u65f6\u95f4\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u662f\u200b3S\u3002</p>"},{"location":"bigdata/pyspark/#dfshow","title":"\u95ee\u9898\u200b\u5341\u4e5d\u200b\uff1a df.show()\u200b\u663e\u793a\u200b\u4e0d\u200b\u5b8c\u6574","text":"<p>\u200b\u89e3\u51b3\u65b9\u6848\u200b\uff1a \u200b\u4f7f\u7528\u200b df.show(truncate=False) \u200b\u6765\u200b\u5173\u95ed\u200b\u503c\u200b\u7684\u200b\u622a\u65ad\u200b\u884c\u4e3a\u200b\uff0c\u200b\u4ece\u800c\u200b\u663e\u793a\u200b\u5b8c\u6574\u200b\u7684\u200b\u503c\u200b\u3002\u200b\u4f46\u662f\u200b\u9700\u8981\u200b\u6ce8\u610f\u200b,\u200b\u5982\u679c\u200b\u503c\u200b\u5b9e\u5728\u200b\u592a\u200b\u957f\u200b,\u200b\u7ec8\u7aef\u200b\u53ef\u80fd\u200b\u65e0\u6cd5\u200b\u5b8c\u6574\u200b\u663e\u793a\u200b\u3002  </p> <p>\u200b\u4f7f\u7528\u200b df.show(truncate=False, vertical=True) \u200b\u53ef\u4ee5\u200b\u5782\u76f4\u200b\u663e\u793a\u200b DataFrame,\u200b\u6bcf\u884c\u200b\u663e\u793a\u200b\u4e00\u4e2a\u200b\u503c\u200b\u3002\u200b\u8fd9\u79cd\u200b\u65b9\u5f0f\u200b\u66f4\u200b\u9002\u5408\u200b\u663e\u793a\u200b\u8d85\u957f\u200b\u5b57\u7b26\u4e32\u200b\u3002  </p>"},{"location":"bigdata/python/","title":"Python","text":""},{"location":"bigdata/python/#python","title":"Python","text":""},{"location":"bigdata/python/#_1","title":"\u751f\u6210\u5f0f\u200b\uff08\u200b\u63a8\u5bfc\u200b\u5f0f\u200b\uff09\u200b\u7684\u200b\u7528\u6cd5","text":"<pre><code>prices = {\n    'AAPL': 191.88,\n    'GOOG': 1186.96,\n    'IBM': 149.24,\n    'ORCL': 48.44,\n    'ACN': 166.89,\n    'FB': 208.09,\n    'SYMC': 21.29\n}\n# \u200b\u7528\u200b\u80a1\u7968\u4ef7\u683c\u200b\u5927\u4e8e\u200b100\u200b\u5143\u200b\u7684\u200b\u80a1\u7968\u200b\u6784\u9020\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u5b57\u5178\u200b\nprices2 = {key: value for key, value in prices.items() if value &gt; 100}\nprint(prices2)\n</code></pre>"},{"location":"bigdata/python/#_2","title":"\u540e\u53f0\u200b\u6267\u884c","text":"<pre><code>nohup python3 main.py &gt;/dev/null 2&gt;&amp;1 &amp;\nnohup python3 main.py &gt;./log/runtime_`date +%Y-%m-%d-%H-%M-%S`.out 2&gt;&amp;1 &amp;\n</code></pre>"},{"location":"bigdata/python/#_3","title":"\u547d\u540d\u200b\u89c4\u8303","text":"<p>\u200b\u6587\u4ef6\u540d\u200b</p> <p>\u200b\u5168\u200b\u5c0f\u5199\u200b,\u200b\u53ef\u200b\u4f7f\u7528\u200b\u4e0b\u5212\u7ebf\u200b</p> <p>\u200b\u5305\u200b</p> <p>\u200b\u5e94\u8be5\u200b\u662f\u200b\u7b80\u77ed\u200b\u7684\u200b\u3001\u200b\u5c0f\u5199\u200b\u7684\u200b\u540d\u5b57\u200b\u3002\u200b\u5982\u679c\u200b\u4e0b\u5212\u7ebf\u200b\u53ef\u4ee5\u200b\u6539\u5584\u200b\u53ef\u8bfb\u6027\u200b\u53ef\u4ee5\u200b\u52a0\u5165\u200b\u3002\u200b\u5982\u200bmypackage\u3002</p> <p>\u200b\u6a21\u5757\u200b</p> <p>\u200b\u4e0e\u200b\u5305\u200b\u7684\u200b\u89c4\u8303\u200b\u540c\u200b\u3002\u200b\u5982\u200bmymodule\u3002</p> <p>\u200b\u7c7b\u200b</p> <p>\u200b\u603b\u662f\u200b\u4f7f\u7528\u200b\u9996\u5b57\u6bcd\u200b\u5927\u5199\u200b\u5355\u8bcd\u200b\u4e32\u200b\u3002\u200b\u5982\u200bMyClass\u3002\u200b\u5185\u90e8\u200b\u7c7b\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u989d\u5916\u200b\u7684\u200b\u524d\u5bfc\u200b\u4e0b\u5212\u7ebf\u200b\u3002</p> <p>\u200b\u51fd\u6570\u200b&amp;\u200b\u65b9\u6cd5\u200b</p> <p>\u200b\u51fd\u6570\u200b\u540d\u200b\u5e94\u8be5\u200b\u4e3a\u200b\u5c0f\u5199\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u7528\u200b\u4e0b\u5212\u7ebf\u200b\u98ce\u683c\u200b\u5355\u8bcd\u200b\u4ee5\u200b\u589e\u52a0\u200b\u53ef\u8bfb\u6027\u200b\u3002\u200b\u5982\u200b\uff1amyfunction\uff0cmy_example_function\u3002</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u6df7\u5408\u200b\u5927\u5c0f\u5199\u200b\u4ec5\u200b\u88ab\u200b\u5141\u8bb8\u200b\u7528\u4e8e\u200b\u8fd9\u79cd\u200b\u98ce\u683c\u200b\u5df2\u7ecf\u200b\u5360\u636e\u200b\u4f18\u52bf\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u4fdd\u6301\u200b\u5411\u200b\u540e\u200b\u517c\u5bb9\u200b\u3002</p> <p>\u200b\u51fd\u6570\u200b\u548c\u200b\u65b9\u6cd5\u200b\u7684\u200b\u53c2\u6570\u200b</p> <p>\u200b\u603b\u200b\u4f7f\u7528\u200b\u201cself\u201d\u200b\u4f5c\u4e3a\u200b\u5b9e\u4f8b\u200b\u65b9\u6cd5\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u53c2\u6570\u200b\u3002\u200b\u603b\u200b\u4f7f\u7528\u200b\u201ccls\u201d\u200b\u4f5c\u4e3a\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u53c2\u6570\u200b\u3002</p> <p>\u200b\u5982\u679c\u200b\u4e00\u4e2a\u200b\u51fd\u6570\u200b\u7684\u200b\u53c2\u6570\u200b\u540d\u79f0\u200b\u548c\u200b\u4fdd\u7559\u200b\u7684\u200b\u5173\u952e\u5b57\u200b\u51b2\u7a81\u200b\uff0c\u200b\u901a\u5e38\u200b\u4f7f\u7528\u200b\u4e00\u4e2a\u200b\u540e\u7f00\u200b\u4e0b\u5212\u7ebf\u200b\u597d\u4e8e\u200b\u4f7f\u7528\u200b\u7f29\u5199\u200b\u6216\u200b\u5947\u602a\u200b\u7684\u200b\u62fc\u5199\u200b\u3002</p> <p>\u200b\u5168\u5c40\u53d8\u91cf\u200b</p> <p>\u200b\u5bf9\u4e8e\u200bfrom M import *\u200b\u5bfc\u5165\u200b\u8bed\u53e5\u200b\uff0c\u200b\u5982\u679c\u200b\u60f3\u200b\u963b\u6b62\u200b\u5bfc\u5165\u200b\u6a21\u5757\u200b\u5185\u200b\u7684\u200b\u5168\u5c40\u53d8\u91cf\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u65e7\u6709\u200b\u7684\u200b\u89c4\u8303\u200b\uff0c\u200b\u5728\u200b\u5168\u5c40\u53d8\u91cf\u200b\u4e0a\u52a0\u200b\u4e00\u4e2a\u200b\u524d\u5bfc\u200b\u7684\u200b\u4e0b\u5212\u7ebf\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b:\u200b\u5e94\u200b\u907f\u514d\u200b\u4f7f\u7528\u200b\u5168\u5c40\u53d8\u91cf\u200b</p> <p>\u200b\u53d8\u91cf\u200b</p> <p>\u200b\u53d8\u91cf\u540d\u200b\u5168\u90e8\u200b\u5c0f\u5199\u200b\uff0c\u200b\u7531\u200b\u4e0b\u5212\u7ebf\u200b\u8fde\u63a5\u200b\u5404\u4e2a\u200b\u5355\u8bcd\u200b\u3002\u200b\u5982\u200bcolor = WHITE\uff0cthis_is_a_variable = 1</p> <p>\u200b\u6ce8\u610f\u200b\uff1a</p> <p>1.\u200b\u4e0d\u8bba\u662f\u200b\u7c7b\u200b\u6210\u5458\u200b\u53d8\u91cf\u200b\u8fd8\u662f\u200b\u5168\u5c40\u53d8\u91cf\u200b\uff0c\u200b\u5747\u200b\u4e0d\u200b\u4f7f\u7528\u200b m \u200b\u6216\u200b g \u200b\u524d\u7f00\u200b\u3002</p> <p>2.\u200b\u79c1\u6709\u200b\u7c7b\u200b\u6210\u5458\u200b\u4f7f\u7528\u200b\u5355\u4e00\u200b\u4e0b\u5212\u7ebf\u200b\u524d\u7f00\u200b\u6807\u8bc6\u200b\uff0c\u200b\u591a\u200b\u5b9a\u4e49\u200b\u516c\u5f00\u200b\u6210\u5458\u200b\uff0c\u200b\u5c11\u200b\u5b9a\u4e49\u200b\u79c1\u6709\u200b\u6210\u5458\u200b\u3002</p> <p>3.\u200b\u53d8\u91cf\u540d\u200b\u4e0d\u200b\u5e94\u200b\u5e26\u6709\u200b\u7c7b\u578b\u4fe1\u606f\u200b\uff0c\u200b\u56e0\u4e3a\u200bPython\u200b\u662f\u200b\u52a8\u6001\u200b\u7c7b\u578b\u200b\u8bed\u8a00\u200b\u3002\u200b\u5982\u200b iValue\u3001names_list\u3001dict_obj \u200b\u7b49\u200b\u90fd\u200b\u662f\u200b\u4e0d\u597d\u200b\u7684\u200b\u547d\u540d\u200b\u3002</p> <p>\u200b\u5e38\u91cf\u200b</p> <p>\u200b\u5e38\u91cf\u200b\u540d\u200b\u6240\u6709\u200b\u5b57\u6bcd\u200b\u5927\u5199\u200b\uff0c\u200b\u7531\u200b\u4e0b\u5212\u7ebf\u200b\u8fde\u63a5\u200b\u5404\u4e2a\u200b\u5355\u8bcd\u200b\u5982\u200bMAX_OVERFLOW\uff0cTOTAL\u3002</p> <p>\u200b\u5f02\u5e38\u200b</p> <p>\u200b\u4ee5\u200b\u201cError\u201d\u200b\u4f5c\u4e3a\u200b\u540e\u7f00\u200b\u3002</p> <p>\u200b\u7f29\u5199\u200b</p> <p>\u200b\u547d\u540d\u200b\u5e94\u5f53\u200b\u5c3d\u91cf\u200b\u4f7f\u7528\u200b\u5168\u200b\u62fc\u5199\u200b\u7684\u200b\u5355\u8bcd\u200b\uff0c\u200b\u7f29\u5199\u200b\u7684\u200b\u60c5\u51b5\u200b\u6709\u200b\u5982\u4e0b\u200b\u4e24\u79cd\u200b\uff1a</p> <p>1.\u200b\u5e38\u7528\u200b\u7684\u200b\u7f29\u5199\u200b\uff0c\u200b\u5982\u200bXML\u3001ID\u200b\u7b49\u200b\uff0c\u200b\u5728\u200b\u547d\u540d\u200b\u65f6\u200b\u4e5f\u200b\u5e94\u200b\u53ea\u200b\u5927\u5199\u200b\u9996\u5b57\u6bcd\u200b\uff0c\u200b\u5982\u200bXmlParser\u3002</p> <p>2.\u200b\u547d\u540d\u200b\u4e2d\u200b\u542b\u6709\u200b\u957f\u200b\u5355\u8bcd\u200b\uff0c\u200b\u5bf9\u200b\u67d0\u4e2a\u200b\u5355\u8bcd\u200b\u8fdb\u884c\u200b\u7f29\u5199\u200b\u3002\u200b\u8fd9\u65f6\u200b\u5e94\u200b\u4f7f\u7528\u200b\u7ea6\u5b9a\u6210\u4fd7\u200b\u7684\u200b\u7f29\u5199\u200b\u65b9\u5f0f\u200b\u3002</p> <p>\u200b\u4f8b\u5982\u200b\uff1a</p> <p>function \u200b\u7f29\u5199\u200b\u4e3a\u200b fn</p> <p>text \u200b\u7f29\u5199\u200b\u4e3a\u200b txt</p> <p>object \u200b\u7f29\u5199\u200b\u4e3a\u200b obj</p> <p>count \u200b\u7f29\u5199\u200b\u4e3a\u200b cnt</p> <p>number \u200b\u7f29\u5199\u200b\u4e3a\u200b num\uff0c\u200b\u7b49\u200b\u3002</p> <p>\u200b\u524d\u5bfc\u200b\u540e\u7f00\u200b\u4e0b\u5212\u7ebf\u200b</p> <p>\u200b\u4e00\u4e2a\u200b\u524d\u5bfc\u200b\u4e0b\u5212\u7ebf\u200b\uff1a\u200b\u8868\u793a\u200b\u975e\u516c\u6709\u200b\u3002</p> <p>\u200b\u4e00\u4e2a\u200b\u540e\u7f00\u200b\u4e0b\u5212\u7ebf\u200b\uff1a\u200b\u907f\u514d\u200b\u5173\u952e\u5b57\u200b\u51b2\u7a81\u200b\u3002</p> <p>\u200b\u4e24\u4e2a\u200b\u524d\u5bfc\u200b\u4e0b\u5212\u7ebf\u200b\uff1a\u200b\u5f53\u200b\u547d\u540d\u200b\u4e00\u4e2a\u200b\u7c7b\u200b\u5c5e\u6027\u200b\u5f15\u8d77\u200b\u540d\u79f0\u200b\u51b2\u7a81\u200b\u65f6\u200b\u4f7f\u7528\u200b\u3002</p> <p>\u200b\u4e24\u4e2a\u200b\u524d\u5bfc\u200b\u548c\u200b\u540e\u7f00\u200b\u4e0b\u5212\u7ebf\u200b\uff1a\u201c\u200b\u9b54\u200b\u201d\uff08\u200b\u6709\u200b\u7279\u6b8a\u200b\u7528\u56fe\u200b\uff09\u200b\u5bf9\u8c61\u200b\u6216\u8005\u200b\u5c5e\u6027\u200b\uff0c\u200b\u4f8b\u5982\u200b__init__\u200b\u6216\u8005\u200b__file__\u3002\u200b\u7edd\u5bf9\u200b\u4e0d\u8981\u200b\u521b\u9020\u200b\u8fd9\u6837\u200b\u7684\u200b\u540d\u5b57\u200b\uff0c\u200b\u800c\u200b\u53ea\u662f\u200b\u4f7f\u7528\u200b\u5b83\u4eec\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u5173\u4e8e\u200b\u4e0b\u5212\u7ebf\u200b\u7684\u200b\u4f7f\u7528\u200b\u5b58\u5728\u200b\u4e00\u4e9b\u200b\u4e89\u8bae\u200b\u3002</p> <p>\u200b\u7279\u5b9a\u200b\u547d\u540d\u200b\u65b9\u5f0f\u200b</p> <p>\u200b\u4e3b\u8981\u200b\u662f\u200b\u6307\u200b xxx \u200b\u5f62\u5f0f\u200b\u7684\u200b\u7cfb\u7edf\u200b\u4fdd\u7559\u5b57\u200b\u547d\u540d\u200b\u6cd5\u200b\u3002</p> <p>\u200b\u9879\u76ee\u200b\u4e2d\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u8fd9\u79cd\u200b\u547d\u540d\u200b\uff0c\u200b\u5b83\u200b\u7684\u200b\u610f\u4e49\u200b\u5728\u4e8e\u200b\u8fd9\u79cd\u200b\u5f62\u5f0f\u200b\u7684\u200b\u53d8\u91cf\u200b\u662f\u200b\u53ea\u8bfb\u200b\u7684\u200b\uff0c\u200b\u8fd9\u79cd\u200b\u5f62\u5f0f\u200b\u7684\u200b\u7c7b\u200b\u6210\u5458\u200b\u51fd\u6570\u200b\u5c3d\u91cf\u200b\u4e0d\u8981\u200b\u91cd\u8f7d\u200b\u3002\u200b\u5982\u200b</p> <p>class Base(object):</p> <p>def init(self, id, parent = None):</p> <p>self.id = id</p> <p>self.parent = parent</p> <p>def message(self, msgid):</p> <p>\u200b\u5176\u4e2d\u200b id\u3001parent \u200b\u548c\u200b message \u200b\u90fd\u200b\u91c7\u7528\u200b\u4e86\u200b\u7cfb\u7edf\u200b\u4fdd\u7559\u5b57\u200b\u547d\u540d\u200b\u6cd5\u200b\u3002</p> <p>\u200b\u9644\u200b:Google Python\u200b\u547d\u540d\u200b\u89c4\u8303\u200b</p> <p>module_name, package_name, ClassName, method_name, ExceptionName, function_name, GLOBAL_VAR_NAME, instance_var_name, function_parameter_name, local_var_name.</p> <p></p> <p>\u200b\u5b57\u5178\u200b\u7684\u200b\u5408\u5e76\u200b </p> <p>info_1 = {\"apple\": 13, \"orange\": 22} info_2 = {\"\u200b\u7206\u6b3e\u200b\u5199\u4f5c\u200b\": 48, \"\u200b\u8dc3\u8fc1\u200b\": 49}</p>"},{"location":"bigdata/python/#_4","title":"\u4e00\u884c\u200b\u4ee3\u7801\u200b\u641e\u5b9a\u200b\u5408\u5e76\u200b\u4e24\u4e2a\u200b\u5b57\u5178","text":"<p>new_info = {*info_1, *info_2} print(new_info) \u200b\u8f93\u51fa\u200b\uff1a</p>"},{"location":"bigdata/python/#numpy","title":"Numpy","text":""},{"location":"bigdata/python/#11-nparray","title":"1.1. \u200b\u4f7f\u7528\u200bnp.array\u200b\u521b\u5efa\u200b\u6570\u7ec4","text":"<pre><code>a = np.array([1,2,3,4])\n#\u200b\u6253\u5370\u200b\u6570\u7ec4\u200b\nprint(a)\n#\u200b\u67e5\u770b\u200b\u7c7b\u578b\u200b\nprint(type(a))\n</code></pre>"},{"location":"bigdata/python/#12-nparange","title":"1.2. \u200b\u4f7f\u7528\u200bnp.arange\u200b\u521b\u5efa\u200b\u6570\u7ec4","text":"<pre><code>#\u200b\u521b\u5efa\u200b0-10\u200b\u6b65\u6570\u200b\u4e3a\u200b2\u200b\u7684\u200b\u6570\u7ec4\u200b \u200b\u7ed3\u679c\u200b\u4e3a\u200b[0,2,4,6,8]\n#2. \u200b\u4f7f\u7528\u200bnp.arange\u200b\u521b\u5efa\u200b\u6570\u7ec4\u200b\nb = np.arange(0,10,2)\n</code></pre>"},{"location":"bigdata/python/#13-nprandomrandom","title":"1.3. np.random.random\u200b\u521b\u5efa\u200b\u6570\u7ec4","text":"<pre><code>#3. np.random.random\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200bN\u200b\u884c\u200bN\u200b\u5217\u200b\u7684\u200b\u6570\u7ec4\u200b\n# \u200b\u5176\u4e2d\u200b\u91cc\u9762\u200b\u7684\u200b\u503c\u200b\u662f\u200b0-1\u200b\u4e4b\u95f4\u200b\u7684\u200b\u968f\u673a\u6570\u200b\n# \u200b\u521b\u5efa\u200b2\u200b\u884c\u200b2\u200b\u5217\u200b\u7684\u200b\u6570\u7ec4\u200b\nc = np.random.random((2,2))\n</code></pre>"},{"location":"bigdata/python/#14-nprandomrandint","title":"1.4. np.random.randint\u200b\u521b\u5efa\u200b\u6570\u7ec4","text":"<pre><code>#4. np.random.randint\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200bN\u200b\u884c\u200bN\u200b\u5217\u200b\u7684\u200b\u6570\u7ec4\u200b\n# \u200b\u5176\u4e2d\u200b\u503c\u200b\u7684\u200b\u8303\u56f4\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u524d\u9762\u200b2\u200b\u4e2a\u200b\u53c2\u6570\u200b\u6765\u200b\u6307\u5b9a\u200b\n# \u200b\u521b\u5efa\u200b\u503c\u200b\u7684\u200b\u8303\u56f4\u200b\u4e3a\u200b[0,9)\u200b\u7684\u200b4\u200b\u884c\u200b4\u200b\u5217\u200b\u6570\u7ec4\u200b\nd = np.random.randint(0,9,size=(4,4))\n</code></pre>"},{"location":"bigdata/python/#15","title":"1.5. \u200b\u7279\u6b8a\u200b\u51fd\u6570","text":"<pre><code>#5. \u200b\u7279\u6b8a\u200b\u51fd\u6570\u200b\n#5.1 zeros\n## N\u200b\u884c\u200bN\u200b\u5217\u200b\u7684\u200b\u5168\u96f6\u200b\u6570\u7ec4\u200b\n### \u200b\u4f8b\u5982\u200b\uff1a3\u200b\u884c\u200b3\u200b\u5217\u5168\u200b\u96f6\u200b\u6570\u7ec4\u200b\narray_zeros = np.zeros((3,3))\n#5.2 ones\n## N\u200b\u884c\u200bN\u200b\u5217\u200b\u7684\u200b\u5168\u4e00\u200b\u6570\u7ec4\u200b\n### \u200b\u4f8b\u5982\u200b\uff1a4\u200b\u884c\u200b4\u200b\u5217\u5168\u200b\u4e00\u200b\u6570\u7ec4\u200b\narray_ones = np.ones((4,4))\n#5.3 full\n## \u200b\u5168\u90e8\u200b\u4e3a\u200b\u6307\u5b9a\u200b\u503c\u200b\u7684\u200bN\u200b\u884c\u200bN\u200b\u5217\u200b\u6570\u7ec4\u200b\n### \u200b\u4f8b\u5982\u200b\uff1a\u200b\u503c\u4e3a\u200b9\u200b\u7684\u200b2\u200b\u884c\u200b3\u200b\u5217\u200b\u6570\u7ec4\u200b\narray_full = np.full((2,3),9)\n#5.4 eye\n## \u200b\u751f\u6210\u200b\u4e00\u4e2a\u200b\u5728\u200b\u659c\u65b9\u5f62\u200b\u4e0a\u200b\u5143\u7d20\u200b\u4e3a\u200b1\uff0c\u200b\u5176\u4ed6\u200b\u5143\u7d20\u200b\u90fd\u200b\u4e3a\u200b0\u200b\u7684\u200bN\u200b\u884c\u200bN\u200b\u5217\u200b\u77e9\u9635\u200b\n### \u200b\u4f8b\u5982\u200b\uff1a4\u200b\u884c\u200b4\u200b\u5217\u200b\u77e9\u9635\u200b\narray_eye = np.eye(4)\n</code></pre>"},{"location":"bigdata/python/#21","title":"2.1 \u200b\u6570\u636e\u7c7b\u578b","text":"\u6570\u636e\u7c7b\u578b\u200b \u200b\u63cf\u8ff0\u200b \u200b\u552f\u4e00\u200b\u6807\u8bc6\u7b26\u200b bool \u200b\u7528\u200b\u4e00\u4e2a\u200b\u5b57\u8282\u200b\u5b58\u50a8\u200b\u7684\u200b\u5e03\u5c14\u200b\u7c7b\u578b\u200b\uff08True\u200b\u6216\u200bFalse\uff09 b int8 \u200b\u4e00\u4e2a\u200b\u5b57\u8282\u200b\u5927\u5c0f\u200b\uff0c-128 \u200b\u81f3\u200b 127 i1 int16 \u200b\u6574\u6570\u200b\uff0c16 \u200b\u4f4d\u200b\u6574\u6570\u200b(-32768 ~ 32767) i2 int32 \u200b\u6574\u6570\u200b\uff0c32 \u200b\u4f4d\u200b\u6574\u6570\u200b(-2147483648 ~ 2147483647) i4 int64 \u200b\u6574\u6570\u200b\uff0c64 \u200b\u4f4d\u200b\u6574\u6570\u200b(-9223372036854775808 ~ 9223372036854775807) i8 uint8 \u200b\u65e0\u200b\u7b26\u53f7\u200b\u6574\u6570\u200b\uff0c0 \u200b\u81f3\u200b 255 u1 uint16 \u200b\u65e0\u200b\u7b26\u53f7\u200b\u6574\u6570\u200b\uff0c0 \u200b\u81f3\u200b 65535 u2 uint32 \u200b\u65e0\u200b\u7b26\u53f7\u200b\u6574\u6570\u200b\uff0c0 \u200b\u81f3\u200b 2 ** 32 - 1 u4 uint64 \u200b\u65e0\u200b\u7b26\u53f7\u200b\u6574\u6570\u200b\uff0c0 \u200b\u81f3\u200b 2 ** 64 - 1 u8 float16 \u200b\u534a\u200b\u7cbe\u5ea6\u200b\u6d6e\u70b9\u6570\u200b\uff1a16\u200b\u4f4d\u200b\uff0c\u200b\u6b63\u8d1f\u53f7\u200b1\u200b\u4f4d\u200b\uff0c\u200b\u6307\u6570\u200b5\u200b\u4f4d\u200b\uff0c\u200b\u7cbe\u5ea6\u200b10\u200b\u4f4d\u200b f2 float32 \u200b\u5355\u7cbe\u5ea6\u200b\u6d6e\u70b9\u6570\u200b\uff1a32\u200b\u4f4d\u200b\uff0c\u200b\u6b63\u8d1f\u53f7\u200b1\u200b\u4f4d\u200b\uff0c\u200b\u6307\u6570\u200b8\u200b\u4f4d\u200b\uff0c\u200b\u7cbe\u5ea6\u200b23\u200b\u4f4d\u200b f4 float64 \u200b\u5355\u7cbe\u5ea6\u200b\u6d6e\u70b9\u6570\u200b\uff1a64\u200b\u4f4d\u200b\uff0c\u200b\u6b63\u8d1f\u53f7\u200b1\u200b\u4f4d\u200b\uff0c\u200b\u6307\u6570\u200b11\u200b\u4f4d\u200b\uff0c\u200b\u7cbe\u5ea6\u200b52\u200b\u4f4d\u200b f8 complex64 \u200b\u590d\u6570\u200b\uff0c\u200b\u5206\u522b\u200b\u7528\u200b\u4e24\u4e2a\u200b32\u200b\u4f4d\u200b\u6d6e\u70b9\u6570\u200b\u8868\u793a\u200b\u5b9e\u90e8\u200b\u548c\u200b\u865a\u90e8\u200b c8 complex128 \u200b\u590d\u6570\u200b\uff0c\u200b\u5206\u522b\u200b\u7528\u200b\u4e24\u4e2a\u200b64\u200b\u4f4d\u200b\u6d6e\u70b9\u6570\u200b\u8868\u793a\u200b\u5b9e\u90e8\u200b\u548c\u200b\u865a\u90e8\u200b c16 object_ python\u200b\u5bf9\u8c61\u200b O string_ \u200b\u5b57\u7b26\u4e32\u200b S unicode_ unicode\u200b\u7c7b\u578b\u200b U"},{"location":"bigdata/python/#22","title":"2.2 \u200b\u521b\u5efa\u200b\u6570\u7ec4\u200b\u6307\u5b9a\u200b\u6570\u636e\u7c7b\u578b","text":"<pre><code>import numpy as np\na = np.array([1,2,3,4,5],dtype='i1')\na = np.array([1,2,3,4,5],dtype=int32)\n</code></pre>"},{"location":"bigdata/python/#23","title":"2.3 \u200b\u67e5\u8be2\u200b\u6570\u636e\u7c7b\u578b","text":"<pre><code>class Person:\n    def __init__(self,name,age):\n        self.name = name\n        self.age = age\nd = np.array([Person('test1',18),Person('test2',20)])\nprint(d)\nprint(d.dtype)\n</code></pre>"},{"location":"bigdata/python/#24","title":"2.4 \u200b\u4fee\u6539\u200b\u6570\u636e\u7c7b\u578b","text":"<pre><code>f = a.astype('f2')\n</code></pre>"},{"location":"bigdata/python/#31","title":"3.1 \u200b\u6570\u7ec4\u200b\u7ef4\u5ea6\u200b\u67e5\u8be2","text":"<pre><code>import numpy as np\n# \u200b\u6570\u7ec4\u200b\u7ef4\u5ea6\u200b\n## \u200b\u7ef4\u5ea6\u200b\u4e3a\u200b1\na1 = np.array([1,2,3])\nprint(a1.ndim)\n## \u200b\u7ef4\u5ea6\u200b\u4e3a\u200b2\na2 = np.array([[1,2,3],[4,5,6]])\nprint(a2.ndim)\n## \u200b\u7ef4\u5ea6\u200b\u4e3a\u200b3\na3 = np.array([\n    [\n        [1,2,3],\n        [4,5,6]\n    ],\n    [\n        [7,8,9],\n        [10,11,12]\n    ]\n])\nprint(a3.ndim)\n</code></pre>"},{"location":"bigdata/python/#32","title":"3.2 \u200b\u6570\u7ec4\u200b\u5f62\u72b6\u200b\u67e5\u8be2","text":"<pre><code>a1 = np.array([1,2,3])\n# \u200b\u7ed3\u679c\u200b\u4e3a\u200b(3,)\nprint(a1.shape)\na2 = np.array([[1,2,3],[4,5,6]])\n# \u200b\u7ed3\u679c\u200b\u4e3a\u200b(2,3)\nprint(a2.shape)\na3 = np.array([\n    [\n        [1,2,3],\n        [4,5,6]\n    ],\n    [\n        [7,8,9],\n        [10,11,12]\n    ]\n])\n# \u200b\u7ed3\u679c\u200b\u4e3a\u200b(2,2,3)\nprint(a3.shape)\n</code></pre>"},{"location":"bigdata/python/#33","title":"3.3 \u200b\u4fee\u6539\u200b\u6570\u7ec4\u200b\u5f62\u72b6","text":"<pre><code>a1 = np.array([\n    [\n        [1,2,3],\n        [4,5,6]\n    ],\n    [\n        [7,8,9],\n        [10,11,12]\n    ]\n])\na2 = a1.reshape((2,6))\nprint(a2)\n#\u200b\u7ed3\u679c\u200b\u4e3a\u200b(2, 6)\nprint(a2.shape)\n# \u200b\u6241\u5e73\u5316\u200b \uff08\u200b\u591a\u7ef4\u200b\u6570\u7ec4\u200b\u8f6c\u5316\u200b\u4e3a\u200b\u4e00\u7ef4\u200b\u6570\u7ec4\u200b\uff09\na3 = a2.flatten()\nprint(a3)\nprint(a3.ndim)\n</code></pre>"},{"location":"bigdata/python/#34","title":"3.4 \u200b\u6570\u7ec4\u200b\u5143\u7d20\u200b\u4e2a\u6570\u200b\u4e0e\u200b\u6240\u200b\u5360\u200b\u5185\u5b58","text":"<pre><code>a1 = np.array([\n    [\n        [1,2,3],\n        [4,5,6]\n    ],\n    [\n        [7,8,9],\n        [10,11,12]\n    ]\n])\n#\u200b\u6570\u7ec4\u200b\u7684\u200b\u5143\u7d20\u200b\u4e2a\u6570\u200b\ncount = a1.size\nprint(count)\n#\u200b\u5404\u200b\u5143\u7d20\u200b\u6240\u200b\u5360\u200b\u5185\u5b58\u200b\nprint(a1.itemsize)\n#\u200b\u5404\u200b\u5143\u7d20\u200b\u6570\u636e\u7c7b\u578b\u200b\nprint(a1.dtype)\n#\u200b\u6570\u7ec4\u200b\u6240\u200b\u5360\u200b\u5185\u5b58\u200b\nprint(a1.itemsize * a1.size)\n</code></pre>"},{"location":"bigdata/python/#35","title":"3.5 \u200b\u603b\u7ed3","text":"<pre><code>\uff081\uff09\u200b\u4e00\u822c\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c\u200b\u6570\u7ec4\u200b\u7ef4\u5ea6\u200b\u6700\u5927\u200b\u5230\u200b\u4e09\u7ef4\u200b\uff0c\u200b\u4e00\u822c\u200b\u4f1a\u200b\u628a\u200b\u4e09\u7ef4\u200b\u4ee5\u4e0a\u200b\u7684\u200b\u6570\u7ec4\u200b\u8f6c\u5316\u200b\u4e3a\u200b\u4e8c\u7ef4\u200b\u6570\u7ec4\u200b\u6765\u200b\u8ba1\u7b97\u200b\n\uff082\uff09ndarray.ndmin\u200b\u67e5\u8be2\u200b\u6570\u7ec4\u200b\u7684\u200b\u7ef4\u5ea6\u200b\n\uff083\uff09ndarray.shape\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u6570\u7ec4\u200b\u7684\u200b\u5f62\u72b6\u200b\uff08\u200b\u51e0\u884c\u200b\u51e0\u5217\u200b\uff09\uff0cshape\u200b\u662f\u200b\u4e00\u4e2a\u200b\u5143\u7ec4\u200b\uff0c\u200b\u91cc\u9762\u200b\u6709\u200b\u51e0\u4e2a\u200b\u5143\u7d20\u200b\u4ee3\u8868\u200b\u662f\u200b\u51e0\u7ef4\u200b\u6570\u7ec4\u200b\n\uff084\uff09ndarray.reshape\u200b\u53ef\u4ee5\u200b\u4fee\u6539\u200b\u6570\u7ec4\u200b\u7684\u200b\u5f62\u72b6\u200b\u3002\u200b\u6761\u4ef6\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200b\uff0c\u200b\u5c31\u662f\u200b\u4fee\u6539\u200b\u540e\u200b\u7684\u200b\u5f62\u72b6\u200b\u7684\u200b\u5143\u7d20\u200b\u4e2a\u6570\u200b\u5fc5\u987b\u200b\u548c\u200b\u539f\u6765\u200b\u7684\u200b\u4e2a\u6570\u200b\u4e00\u81f4\u200b\u3002\u200b\u6bd4\u5982\u200b\u539f\u6765\u200b\u662f\u200b\uff082,6\uff09\uff0c\u200b\u90a3\u4e48\u200b\u4fee\u6539\u200b\u5b8c\u6210\u200b\u540e\u200b\u53ef\u4ee5\u200b\u53d8\u6210\u200b\uff083,4\uff09\uff0c\u200b\u4f46\u662f\u200b\u4e0d\u80fd\u200b\u53d8\u6210\u200b\uff081,4\uff09\u3002reshape\u200b\u4e0d\u4f1a\u200b\u4fee\u6539\u200b\u539f\u6765\u200b\u6570\u7ec4\u200b\u7684\u200b\u5f62\u72b6\u200b\uff0c\u200b\u53ea\u4f1a\u200b\u5c06\u200b\u4fee\u6539\u200b\u540e\u200b\u7684\u200b\u7ed3\u679c\u200b\u8fd4\u56de\u200b\u3002\n\uff085\uff09ndarray.size\u200b\u67e5\u8be2\u200b\u6570\u7ec4\u200b\u5143\u7d20\u200b\u4e2a\u6570\u200b\n\uff086\uff09ndarray.itemsize\u200b\u53ef\u4ee5\u200b\u770b\u5230\u200b\u6570\u7ec4\u200b\u4e2d\u200b\u6bcf\u4e2a\u200b\u5143\u7d20\u200b\u6240\u200b\u5360\u200b\u5185\u5b58\u200b\u7684\u200b\u5927\u5c0f\u200b\uff0c\u200b\u5355\u4f4d\u200b\u662f\u200b\u5b57\u8282\u200b\u3002\uff081\u200b\u4e2a\u200b\u5b57\u8282\u200b=8\u200b\u4f4d\u200b\uff09\n</code></pre>"},{"location":"bigdata/python/#42","title":"4.2 \u200b\u4e8c\u7ef4\u200b\u6570\u7ec4","text":"<pre><code># 2. \u200b\u591a\u7ef4\u200b\u6570\u7ec4\u200b\n# \u200b\u901a\u8fc7\u200b\u4e2d\u62ec\u53f7\u200b\u6765\u200b\u7d22\u5f15\u200b\u548c\u200b\u5207\u7247\u200b\uff0c\u200b\u5728\u200b\u4e2d\u62ec\u53f7\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u9017\u53f7\u200b\u8fdb\u884c\u200b\u5206\u5272\u200b\n#\u200b\u9017\u53f7\u200b\u524d\u9762\u200b\u7684\u200b\u662f\u200b\u884c\u200b\uff0c\u200b\u9017\u53f7\u200b\u540e\u9762\u200b\u7684\u200b\u662f\u200b\u5217\u200b\uff0c\u200b\u5982\u679c\u200b\u591a\u7ef4\u200b\u6570\u7ec4\u200b\u4e2d\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200b\u503c\u200b\uff0c\u200b\u90a3\u4e48\u200b\u8fd9\u4e2a\u200b\u503c\u200b\u5c31\u662f\u200b\u884c\u200b\na2 = np.random.randint(0,10,size=(4,6))\nprint(a2)\n#\u200b\u83b7\u53d6\u200b\u7b2c\u200b0\u200b\u884c\u200b\u6570\u636e\u200b\nprint(a2[0])\n#\u200b\u83b7\u53d6\u200b\u7b2c\u200b1,2\u200b\u884c\u200b\u6570\u636e\u200b\nprint(a2[1:3])\n#\u200b\u83b7\u53d6\u200b\u591a\u884c\u200b\u6570\u636e\u200b \u200b\u4f8b\u200b0,2,3\u200b\u884c\u200b\u6570\u636e\u200b\nprint(a2[[0,2,3]])\n#\u200b\u83b7\u53d6\u200b\u7b2c\u4e8c\u884c\u200b\u7b2c\u4e00\u5217\u200b\u6570\u636e\u200b\nprint(a2[2,1])\n#\u200b\u83b7\u53d6\u200b\u591a\u4e2a\u200b\u6570\u636e\u200b \u200b\u4f8b\u200b:\u200b\u7b2c\u4e00\u884c\u200b\u7b2c\u56db\u200b\u5217\u200b\u3001\u200b\u7b2c\u4e8c\u884c\u200b\u7b2c\u4e94\u200b\u5217\u200b\u6570\u636e\u200b\nprint(a2[[1,2],[4,5]])\n#\u200b\u83b7\u53d6\u200b\u591a\u4e2a\u200b\u6570\u636e\u200b \u200b\u4f8b\u200b:\u200b\u7b2c\u4e00\u200b\u3001\u200b\u4e8c\u884c\u200b\u7684\u200b\u7b2c\u56db\u200b\u3001\u200b\u4e94\u5217\u200b\u7684\u200b\u6570\u636e\u200b\nprint(a2[1:3,4:6])\n#\u200b\u83b7\u53d6\u200b\u67d0\u200b\u4e00\u5217\u200b\u6570\u636e\u200b \u200b\u4f8b\u200b:\u200b\u7b2c\u4e00\u5217\u200b\u7684\u200b\u5168\u90e8\u200b\u6570\u636e\u200b\nprint(a2[:,1])\n#\u200b\u83b7\u53d6\u200b\u591a\u5217\u200b\u6570\u636e\u200b \u200b\u4f8b\u200b:\u200b\u7b2c\u4e00\u200b\u3001\u200b\u4e09\u5217\u200b\u7684\u200b\u5168\u90e8\u200b\u6570\u636e\u200b\nprint(a2[:,[1,3]])\n</code></pre>"},{"location":"bigdata/python/#5classmethodstaticmethod","title":"5.\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\uff08<code>classmethod</code>\uff09\u200b\u548c\u200b\u9759\u6001\u65b9\u6cd5\u200b\uff08<code>staticmethod</code>\uff09","text":"<p>\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\uff08Class Method\uff09 \u200b\u5b9a\u4e49\u200b \u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u4f7f\u7528\u200b @classmethod \u200b\u88c5\u9970\u200b\u5668\u6765\u200b\u5b9a\u4e49\u200b\u3002\u200b\u5b83\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u53c2\u6570\u200b\u662f\u200b\u7c7b\u200b\u672c\u8eab\u200b\uff08\u200b\u901a\u5e38\u200b\u547d\u540d\u200b\u4e3a\u200b cls\uff09\u3002</p> <p>\u200b\u7279\u70b9\u200b \u200b\u7ed1\u5b9a\u200b\u5230\u200b\u7c7b\u200b\uff1a\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u7ed1\u5b9a\u200b\u5230\u200b\u7c7b\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u7c7b\u200b\u7684\u200b\u5b9e\u4f8b\u200b\u3002 \u200b\u8bbf\u95ee\u200b\u7c7b\u200b\u5c5e\u6027\u200b\u548c\u200b\u65b9\u6cd5\u200b\uff1a\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u8bbf\u95ee\u200b\u548c\u200b\u4fee\u6539\u200b\u7c7b\u200b\u7684\u200b\u72b6\u6001\u200b\uff08\u200b\u7c7b\u200b\u5c5e\u6027\u200b\u548c\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\uff09\u3002 \u200b\u652f\u6301\u200b\u7ee7\u627f\u200b\uff1a\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u5728\u200b\u5b50\u7c7b\u200b\u4e2d\u200b\u91cd\u8f7d\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u591a\u6001\u200b\u884c\u4e3a\u200b\u3002 \u200b\u7528\u6cd5\u200b \u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u901a\u5e38\u200b\u7528\u4e8e\u200b\u9700\u8981\u200b\u5728\u200b\u7c7b\u200b\u7ea7\u522b\u200b\u8fdb\u884c\u200b\u64cd\u4f5c\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u5982\u200b\u8bbf\u95ee\u200b\u6216\u200b\u4fee\u6539\u200b\u7c7b\u200b\u5c5e\u6027\u200b\uff0c\u200b\u6216\u200b\u521b\u5efa\u200b\u7c7b\u200b\u7684\u200b\u5b9e\u4f8b\u200b\uff08\u200b\u5de5\u5382\u200b\u65b9\u6cd5\u200b\uff09\u3002</p> <pre><code>class MyClass:\n    class_variable = 'Hello, World!'\n\n    @classmethod\n    def get_class_variable(cls):\n        return cls.class_variable\n\n# \u200b\u8c03\u7528\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\nprint(MyClass.get_class_variable())  # \u200b\u8f93\u51fa\u200b\uff1aHello, World!\n\n# \u200b\u901a\u8fc7\u200b\u5b9e\u4f8b\u200b\u8c03\u7528\u200b\ninstance = MyClass()\nprint(instance.get_class_variable())  # \u200b\u8f93\u51fa\u200b\uff1aHello, World!\n</code></pre> <pre><code>from abc import ABC, abstractmethod\n\n# \u200b\u57fa\u7c7b\u200b\nclass Product(ABC):\n    @abstractmethod\n    def operation(self):\n        pass\n\n# \u200b\u5177\u4f53\u200b\u4ea7\u54c1\u200bA\nclass ConcreteProductA(Product):\n    def operation(self):\n        return \"Result of ConcreteProductA\"\n\n# \u200b\u5177\u4f53\u200b\u4ea7\u54c1\u200bB\nclass ConcreteProductB(Product):\n    def operation(self):\n        return \"Result of ConcreteProductB\"\n\n# \u200b\u5de5\u5382\u200b\u7c7b\u200b\nclass ProductFactory:\n    @classmethod\n    def create_product(cls, product_type: str) -&gt; Product:\n        if product_type == 'A':\n            return ConcreteProductA()\n        elif product_type == 'B':\n            return ConcreteProductB()\n        else:\n            raise ValueError(f\"Unknown product type: {product_type}\")\n\n# \u200b\u4f7f\u7528\u200b\u5de5\u5382\u200b\u65b9\u6cd5\u200b\u521b\u5efa\u200b\u4ea7\u54c1\u200b\u5b9e\u4f8b\u200b\nif __name__ == \"__main__\":\n    product_a = ProductFactory.create_product('A')\n    product_b = ProductFactory.create_product('B')\n\n    print(product_a.operation())  # Output: Result of ConcreteProductA\n    print(product_b.operation())  # Output: Result of ConcreteProductB\n</code></pre> <p>\u200b\u9759\u6001\u65b9\u6cd5\u200b\uff08Static Method\uff09</p> <p>\u200b\u9759\u6001\u65b9\u6cd5\u200b\u4f7f\u7528\u200b @staticmethod \u200b\u88c5\u9970\u200b\u5668\u6765\u200b\u5b9a\u4e49\u200b\u3002\u200b\u5b83\u200b\u4e0d\u200b\u63a5\u6536\u200b\u7279\u6b8a\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u53c2\u6570\u200b\uff08\u200b\u65e2\u200b\u4e0d\u200b\u63a5\u6536\u200b self \u200b\u4e5f\u200b\u4e0d\u200b\u63a5\u6536\u200b cls\uff09\u3002</p> <p>\u200b\u7279\u70b9\u200b \u200b\u7ed1\u5b9a\u200b\u5230\u200b\u7c7b\u200b\uff1a\u200b\u9759\u6001\u65b9\u6cd5\u200b\u7ed1\u5b9a\u200b\u5230\u200b\u7c7b\u200b\uff0c\u200b\u800c\u200b\u4e0d\u662f\u200b\u7c7b\u200b\u7684\u200b\u5b9e\u4f8b\u200b\u3002 \u200b\u4e0d\u200b\u8bbf\u95ee\u200b\u7c7b\u200b\u6216\u200b\u5b9e\u4f8b\u200b\u7684\u200b\u72b6\u6001\u200b\uff1a\u200b\u9759\u6001\u65b9\u6cd5\u200b\u4e0d\u80fd\u200b\u8bbf\u95ee\u200b\u6216\u200b\u4fee\u6539\u200b\u7c7b\u200b\u6216\u200b\u5b9e\u4f8b\u200b\u7684\u200b\u72b6\u6001\u200b\u3002 \u200b\u72ec\u7acb\u6027\u200b\u5f3a\u200b\uff1a\u200b\u9759\u6001\u65b9\u6cd5\u200b\u72ec\u7acb\u200b\u4e8e\u7c7b\u200b\u548c\u200b\u5b9e\u4f8b\u200b\uff0c\u200b\u901a\u5e38\u200b\u7528\u4e8e\u200b\u903b\u8f91\u200b\u4e0a\u200b\u5c5e\u4e8e\u200b\u7c7b\u200b\u4f46\u200b\u4e0d\u200b\u4f9d\u8d56\u4e8e\u200b\u7c7b\u200b\u6216\u200b\u5b9e\u4f8b\u200b\u72b6\u6001\u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002 \u200b\u7528\u6cd5\u200b: \u200b\u9759\u6001\u65b9\u6cd5\u200b\u901a\u5e38\u200b\u7528\u4e8e\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\u6216\u200b\u903b\u8f91\u200b\u4e0a\u200b\u5c5e\u4e8e\u200b\u7c7b\u200b\u4f46\u200b\u4e0d\u200b\u4f9d\u8d56\u4e8e\u200b\u7c7b\u200b\u6216\u200b\u5b9e\u4f8b\u200b\u72b6\u6001\u200b\u7684\u200b\u65b9\u6cd5\u200b\u3002</p> <pre><code>class MathUtils:\n    @staticmethod\n    def add(a, b):\n        return a + b\n\n# \u200b\u8c03\u7528\u200b\u9759\u6001\u65b9\u6cd5\u200b\nresult = MathUtils.add(5, 7)\nprint(result)  # \u200b\u8f93\u51fa\u200b\uff1a12\n</code></pre> \u200b\u7279\u70b9\u200b \u200b\u7c7b\u200b\u65b9\u6cd5\u200b\uff08Class Method\uff09 \u200b\u9759\u6001\u65b9\u6cd5\u200b\uff08Static Method\uff09 \u200b\u88c5\u9970\u200b\u5668\u200b @classmethod @staticmethod \u200b\u7b2c\u4e00\u4e2a\u200b\u53c2\u6570\u200b \u200b\u7c7b\u200b\u672c\u8eab\u200b\uff08<code>cls</code>\uff09 \u200b\u65e0\u200b\u7279\u6b8a\u200b\u53c2\u6570\u200b \u200b\u8bbf\u95ee\u200b\u6743\u9650\u200b \u200b\u53ef\u4ee5\u200b\u8bbf\u95ee\u200b\u548c\u200b\u4fee\u6539\u200b\u7c7b\u200b\u5c5e\u6027\u200b\u548c\u200b\u65b9\u6cd5\u200b \u200b\u4e0d\u80fd\u200b\u8bbf\u95ee\u200b\u7c7b\u200b\u6216\u200b\u5b9e\u4f8b\u200b\u5c5e\u6027\u200b\u548c\u200b\u65b9\u6cd5\u200b \u200b\u7ed1\u5b9a\u200b \u200b\u7ed1\u5b9a\u200b\u5230\u200b\u7c7b\u200b \u200b\u7ed1\u5b9a\u200b\u5230\u200b\u7c7b\u200b \u200b\u7528\u9014\u200b \u200b\u9700\u8981\u200b\u5728\u200b\u7c7b\u200b\u7ea7\u522b\u200b\u8fdb\u884c\u200b\u64cd\u4f5c\u200b\u7684\u200b\u573a\u666f\u200b\uff0c\u200b\u5982\u200b\u5de5\u5382\u200b\u65b9\u6cd5\u200b \u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\u6216\u200b\u903b\u8f91\u200b\u4e0a\u200b\u5c5e\u4e8e\u200b\u7c7b\u200b\u4f46\u200b\u4e0d\u200b\u4f9d\u8d56\u200b\u7c7b\u200b\u6216\u200b\u5b9e\u4f8b\u200b\u72b6\u6001\u200b\u7684\u200b\u65b9\u6cd5\u200b <p>\u200b\u7528\u6cd5\u200b\u4e0a\u200b\u7684\u200b\u4e0d\u540c\u70b9\u200b \u200b\u8bbf\u95ee\u200b\u548c\u200b\u4fee\u6539\u200b\u7c7b\u200b\u72b6\u6001\u200b\uff1a</p> <p>\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u8bbf\u95ee\u200b\u548c\u200b\u4fee\u6539\u200b\u7c7b\u200b\u5c5e\u6027\u200b\u548c\u200b\u65b9\u6cd5\u200b\u3002 \u200b\u9759\u6001\u65b9\u6cd5\u200b\u4e0d\u80fd\u200b\u8bbf\u95ee\u200b\u7c7b\u200b\u6216\u200b\u5b9e\u4f8b\u200b\u5c5e\u6027\u200b\u548c\u200b\u65b9\u6cd5\u200b\uff0c\u200b\u53ea\u80fd\u200b\u8bbf\u95ee\u200b\u5176\u200b\u81ea\u8eab\u200b\u7684\u200b\u53c2\u6570\u200b\u548c\u200b\u5c40\u90e8\u53d8\u91cf\u200b\u3002 \u200b\u5b9e\u4f8b\u200b\u5316\u200b\uff1a</p> <p>\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u5e38\u7528\u200b\u4f5c\u200b\u5de5\u5382\u200b\u65b9\u6cd5\u200b\u6765\u200b\u521b\u5efa\u200b\u7c7b\u200b\u5b9e\u4f8b\u200b\u3002 \u200b\u9759\u6001\u65b9\u6cd5\u200b\u4e00\u822c\u200b\u7528\u4e8e\u200b\u903b\u8f91\u200b\u4e0a\u200b\u5c5e\u4e8e\u200b\u7c7b\u200b\u7684\u200b\u5de5\u5177\u200b\u51fd\u6570\u200b\uff0c\u200b\u4e0d\u200b\u6d89\u53ca\u200b\u7c7b\u200b\u7684\u200b\u5b9e\u4f8b\u200b\u5316\u200b\u3002 \u200b\u7ee7\u627f\u200b\uff1a</p> <p>\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u652f\u6301\u200b\u7ee7\u627f\u200b\uff0c\u200b\u5e76\u200b\u53ef\u4ee5\u200b\u5728\u200b\u5b50\u7c7b\u200b\u4e2d\u200b\u91cd\u8f7d\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u591a\u6001\u200b\u3002 \u200b\u9759\u6001\u65b9\u6cd5\u200b\u4e0d\u200b\u652f\u6301\u200b\u7ee7\u627f\u200b\u7279\u6027\u200b\uff0c\u200b\u901a\u5e38\u200b\u7528\u4e8e\u200b\u4e0d\u200b\u9700\u8981\u200b\u4f9d\u8d56\u4e8e\u200b\u7c7b\u200b\u7684\u200b\u7ee7\u627f\u200b\u7ed3\u6784\u200b\u7684\u200b\u529f\u80fd\u200b\u3002 \u200b\u901a\u8fc7\u200b\u4e0a\u8ff0\u200b\u89e3\u91ca\u200b\u548c\u200b\u793a\u4f8b\u200b\uff0c\u200b\u5e0c\u671b\u200b\u80fd\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u7406\u89e3\u200b\u7c7b\u200b\u65b9\u6cd5\u200b\u548c\u200b\u9759\u6001\u65b9\u6cd5\u200b\u7684\u200b\u533a\u522b\u200b\u53ca\u5176\u200b\u7528\u6cd5\u200b\u3002</p>"},{"location":"bigdata/python/#httpx","title":"httpx","text":"<p>httpx\u200b\u662f\u200b\u4e00\u4e2a\u200b\u5f02\u6b65\u200b\u534f\u7a0b\u200bhttp\u200b\u8bf7\u6c42\u200b</p>"},{"location":"bigdata/python/#dataclass","title":"dataclass","text":"<p>Python 3.7 \u200b\u4e2d\u200b\u7684\u200b<code>dataclasses</code>\u200b\u6a21\u5757\u200b\u662f\u200b\u4e00\u79cd\u200b\u66f4\u200b\u6709\u6548\u200b\u7684\u200b\u65b9\u6cd5\u200b\u6765\u200b\u5b58\u50a8\u200b\u5c06\u200b\u5728\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u4e0d\u540c\u200b\u90e8\u5206\u200b\u4e4b\u95f4\u200b\u4f20\u9012\u200b\u7684\u200b\u6570\u636e\u200b</p> <pre><code>from dataclasses import dataclass\n\n@dataclass\nclass Employee:\n    id_: int\n    name: str\n    salary: float\n\n    def __repr__(self):\n       return f\"{self.name} earns ${self.salary}.\"\n\ne1 = Employee(id_=1, name='Tusk', salary=69999.99)\nprint(e1) # Tusk earns $69999.99.\n</code></pre>"},{"location":"bigdata/python/#asyncioaiohttp","title":"asyncio\u200b\u548c\u200baiohttp","text":"<p><code>asyncio</code> \u200b\u534f\u7a0b\u200b\u4e3b\u8981\u200b\u4f7f\u7528\u200b <code>async</code> \u200b\u548c\u200b <code>await</code> \u200b\u5173\u952e\u5b57\u200b\u8fdb\u884c\u200b\u5b9a\u4e49\u200b\u548c\u200b\u8c03\u7528\u200b\uff1a</p> <ul> <li><code>async def</code>\uff1a\u200b\u5b9a\u4e49\u200b\u4e00\u4e2a\u200b\u5f02\u6b65\u200b\u51fd\u6570\u200b\uff08\u200b\u534f\u7a0b\u200b\uff09\u3002</li> <li><code>await</code>\uff1a\u200b\u5728\u200b\u534f\u7a0b\u200b\u4e2d\u200b\u7b49\u5f85\u200b\u4e00\u4e2a\u200b\u53ef\u200b\u7b49\u5f85\u200b\u5bf9\u8c61\u200b\uff08\u200b\u5982\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u534f\u7a0b\u200b\u3001Future\u3001Task \u200b\u7b49\u200b\uff09\u200b\u7684\u200b\u5b8c\u6210\u200b\u3002</li> </ul> <p>\u200b\u6280\u5de7\u200b\u548c\u200b\u6ce8\u610f\u4e8b\u9879\u200b\uff1a</p> <ul> <li>\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\uff08Event Loop\uff09\uff1a \u200b\u534f\u7a0b\u200b\u9700\u8981\u200b\u8fd0\u884c\u200b\u5728\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u4e2d\u200b\uff0c<code>asyncio.run()</code> \u200b\u4f1a\u200b\u81ea\u52a8\u200b\u521b\u5efa\u200b\u4e00\u4e2a\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u5e76\u200b\u8fd0\u884c\u200b\u3002</li> <li>\u200b\u4efb\u52a1\u200b\uff08Task\uff09\uff1a \u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b <code>asyncio.create_task()</code> \u200b\u5c06\u200b\u534f\u7a0b\u200b\u5c01\u88c5\u200b\u6210\u200b\u4efb\u52a1\u200b\uff0c\u200b\u4ee5\u4fbf\u200b\u66f4\u200b\u7075\u6d3b\u200b\u5730\u200b\u63a7\u5236\u200b\u534f\u7a0b\u200b\u7684\u200b\u6267\u884c\u200b\u3002</li> <li>Future\uff1a Future \u200b\u5bf9\u8c61\u200b\u8868\u793a\u200b\u4e00\u4e2a\u200b\u5f02\u6b65\u200b\u64cd\u4f5c\u200b\u7684\u200b\u6700\u7ec8\u200b\u7ed3\u679c\u200b\u3002</li> <li>\u200b\u5f02\u6b65\u200b I/O\uff1a \u200b\u534f\u7a0b\u200b\u4e3b\u8981\u200b\u7528\u4e8e\u200b\u5904\u7406\u200b I/O \u200b\u5bc6\u96c6\u578b\u200b\u4efb\u52a1\u200b\uff0c\u200b\u5982\u200b\u7f51\u7edc\u200b\u8bf7\u6c42\u200b\u3001\u200b\u6587\u4ef6\u200b\u8bfb\u5199\u200b\u7b49\u200b\u3002\u200b\u4f7f\u7528\u200b\u5f02\u6b65\u200b I/O \u200b\u53ef\u4ee5\u200b\u907f\u514d\u200b\u963b\u585e\u200b\uff0c\u200b\u63d0\u9ad8\u200b\u7a0b\u5e8f\u200b\u7684\u200b\u5e76\u53d1\u200b\u6027\u80fd\u200b\u3002</li> <li>\u200b\u907f\u514d\u200b\u963b\u585e\u200b\u64cd\u4f5c\u200b\uff1a \u200b\u5728\u200b\u534f\u7a0b\u200b\u4e2d\u5e94\u200b\u907f\u514d\u200b\u6267\u884c\u200b\u963b\u585e\u200b\u64cd\u4f5c\u200b\uff08\u200b\u5982\u200b time.sleep()\uff09\uff0c\u200b\u5426\u5219\u200b\u4f1a\u200b\u963b\u585e\u200b\u6574\u4e2a\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u3002\u200b\u5e94\u200b\u4f7f\u7528\u200b <code>asyncio.sleep()</code> \u200b\u6216\u200b\u5176\u4ed6\u200b\u5f02\u6b65\u200b I/O \u200b\u64cd\u4f5c\u200b\u3002</li> <li>\u200b\u4e0a\u4e0b\u6587\u200b\u7ba1\u7406\u200b\uff1a \u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b <code>async with</code> \u200b\u8bed\u53e5\u200b\u8fdb\u884c\u200b\u5f02\u6b65\u200b\u4e0a\u4e0b\u6587\u200b\u7ba1\u7406\u200b\uff0c\u200b\u4f8b\u5982\u200b\u5f02\u6b65\u200b\u6587\u4ef6\u200b\u64cd\u4f5c\u200b\u3001\u200b\u5f02\u6b65\u200b\u9501\u200b\u7b49\u200b\u3002</li> </ul> <p>\u200b\u534f\u7a0b\u200b\u6bd4\u200b\u591a\u7ebf\u7a0b\u200b\u5feb\u200b\u7684\u200b\u539f\u56e0\u200b\uff1a</p> <p>\u200b\u534f\u7a0b\u200b\u7684\u200b\u201c\u200b\u5feb\u200b\u201d\u200b\u4e3b\u8981\u200b\u4f53\u73b0\u200b\u5728\u200b\u4ee5\u4e0b\u200b\u51e0\u4e2a\u200b\u65b9\u9762\u200b\uff1a</p> <ol> <li>\u200b\u5207\u6362\u200b\u5f00\u9500\u200b\u5c0f\u200b\uff1a \u200b\u534f\u7a0b\u200b\u7684\u200b\u5207\u6362\u200b\u7531\u200b\u7a0b\u5e8f\u200b\u81ea\u8eab\u200b\u63a7\u5236\u200b\uff0c\u200b\u4ec5\u200b\u6d89\u53ca\u200b\u5c11\u91cf\u200b\u5bc4\u5b58\u5668\u200b\u548c\u200b\u6808\u200b\u4fe1\u606f\u200b\u7684\u200b\u4fdd\u5b58\u200b\u548c\u200b\u6062\u590d\u200b\uff0c\u200b\u5f00\u9500\u200b\u8fdc\u200b\u5c0f\u4e8e\u200b\u7ebf\u7a0b\u200b\u5207\u6362\u200b\uff08\u200b\u9700\u8981\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u5185\u6838\u200b\u4ecb\u5165\u200b\uff09\u3002</li> <li>\u200b\u907f\u514d\u200b\u4e86\u200b\u9501\u200b\u7ade\u4e89\u200b\uff1a \u200b\u7531\u4e8e\u200b\u534f\u7a0b\u200b\u662f\u200b\u5355\u7ebf\u7a0b\u200b\u7684\u200b\uff0c\u200b\u4e0d\u200b\u5b58\u5728\u200b\u591a\u4e2a\u200b\u7ebf\u7a0b\u200b\u540c\u65f6\u200b\u8bbf\u95ee\u5171\u4eab\u200b\u8d44\u6e90\u200b\u7684\u200b\u60c5\u51b5\u200b\uff0c\u200b\u56e0\u6b64\u200b\u907f\u514d\u200b\u4e86\u200b\u9501\u200b\u7684\u200b\u7ade\u4e89\u200b\u548c\u200b\u6b7b\u9501\u200b\u7b49\u200b\u95ee\u9898\u200b\uff0c\u200b\u7b80\u5316\u200b\u4e86\u200b\u5e76\u53d1\u200b\u7f16\u7a0b\u200b\u7684\u200b\u590d\u6742\u6027\u200b\u3002</li> <li>\u200b\u66f4\u200b\u9ad8\u6548\u200b\u7684\u200b I/O \u200b\u64cd\u4f5c\u200b\uff1a \u200b\u534f\u7a0b\u200b\u7ed3\u5408\u200b\u5f02\u6b65\u200b I/O\uff0c\u200b\u53ef\u4ee5\u200b\u5728\u200b I/O \u200b\u7b49\u5f85\u200b\u671f\u95f4\u200b\u5207\u6362\u200b\u5230\u200b\u5176\u4ed6\u200b\u4efb\u52a1\u200b\u6267\u884c\u200b\uff0c\u200b\u6700\u5927\u200b\u9650\u5ea6\u200b\u5730\u200b\u5229\u7528\u200b CPU \u200b\u8d44\u6e90\u200b\uff0c\u200b\u63d0\u9ad8\u200b\u4e86\u200b I/O \u200b\u5bc6\u96c6\u578b\u200b\u4efb\u52a1\u200b\u7684\u200b\u6548\u7387\u200b\u3002</li> </ol>"},{"location":"bigdata/python/#1windowsruntimeerror-event-loop-is-closed","title":"1.\u200b\u5728\u200bwindows\u200b\u4e0a\u200b\u4f7f\u7528\u200b\u65f6\u200b\uff0c\u200b\u6709\u65f6\u200b\u4f1a\u200b\u62a5\u9519\u200b\u9047\u5230\u200b<code>RuntimeError: Event loop is closed</code>\u200b\u7684\u200b\u95ee\u9898","text":"<pre><code>\u200b\u5c06\u200basyncio.run(main())\u200b\u6539\u4e3a\u200b\uff1a\nloop = asyncio.get_event_loop()\nloop.run_until_complete(main())\n\u200b\u539f\u56e0\u200b\u662f\u200b\uff1a \nasyncio \u200b\u5bf9\u200b Windows \u200b\u7684\u200b\u652f\u6301\u200b\u672c\u6765\u200b\u5c31\u200b\u4e0d\u597d\u200b\u3002Python3.8 \u200b\u540e\u200b\u9ed8\u8ba4\u200b Windows \u200b\u7cfb\u7edf\u200b\u4e0a\u200b\u7684\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u91c7\u7528\u200b ProactorEventLoop \uff08\u200b\u4ec5\u200b\u7528\u4e8e\u200b Windows \uff09\u200b\u8fd9\u7bc7\u200b\u6587\u6863\u200b\u63cf\u8ff0\u200b\u4e86\u200b\u5176\u200b\u5728\u200b Windows \u200b\u4e0b\u200b\u7684\u200b\u7f3a\u9677\u200b\uff1ahttps://docs.python.org/zh-cn/3/library/asyncio-platforms.html#windows\n\n\u200b\u53c2\u8003\u200b\uff1ahttps://www.cnblogs.com/james-wangx/p/16111485.html\n</code></pre>"},{"location":"bigdata/python/#2","title":"2.\u200b\u6027\u80fd\u200b\u6d4b\u8bd5","text":"<pre><code># -*- encoding: utf-8 -*-\n\"\"\"\n@file    :   asyn_aiohttp_demo.py  \n@contact :   wuwenliang@wxchina.com\n@license :   (c)copyright 2018-2023\n\n@modify time      @author    @version    @description\n------------      -------    --------    -----------\n2024/12/17 15:46   wwl        1.0         asyn_aiohttp_demo\n\"\"\"\nimport asyncio\nimport time\n\nimport aiohttp\nimport requests\n\n\n# \u200b\u540c\u6b65\u200b\u8bf7\u6c42\u200b\u51fd\u6570\u200b\ndef fetch2(url):\n    response = requests.get(url)\n    return response.text\n\n\n# \u200b\u4e3b\u200b\u51fd\u6570\u200b\uff0c\u200b\u6267\u884c\u200b\u540c\u6b65\u200b\u8bf7\u6c42\u200b\ndef main2():\n    urls = [\"https://jsonplaceholder.typicode.com/posts\"] * 100  # \u200b\u8bf7\u6c42\u200b\u7684\u200bURL\n\n    start_time = time.time()  # \u200b\u8bb0\u5f55\u200b\u5f00\u59cb\u200b\u65f6\u95f4\u200b\n    results = [fetch2(url) for url in urls]  # \u200b\u521b\u5efa\u200b\u4efb\u52a1\u200b\u5217\u8868\u200b\u5e76\u200b\u540c\u6b65\u200b\u6267\u884c\u200b\n    end_time = time.time()  # \u200b\u8bb0\u5f55\u200b\u7ed3\u675f\u200b\u65f6\u95f4\u200b\n\n    print(f\"\u200b\u540c\u6b65\u200b\u8bf7\u6c42\u200b\u7684\u200b\u603b\u200b\u65f6\u95f4\u200b: {end_time - start_time}\u200b\u79d2\u200b\")\n    return results\n\n\nasync def fetch(url, semaphore):\n\n    async with semaphore:\n\n        async with aiohttp.ClientSession() as session:\n\n            async with session.get(url) as response:\n\n                return await response.text()\n\n\nasync def main():\n\n    urls = [\"https://jsonplaceholder.typicode.com/posts\"] * 100\n\n    semaphore = asyncio.Semaphore(100)\n\n    tasks = [fetch(url, semaphore) for url in urls]\n\n    start_time = time.time()  # \u200b\u8bb0\u5f55\u200b\u5f00\u59cb\u200b\u65f6\u95f4\u200b\n    results = await asyncio.gather(*tasks)\n    end_time = time.time()  # \u200b\u8bb0\u5f55\u200b\u7ed3\u675f\u200b\u65f6\u95f4\u200b\n\n    print(f\"100\u200b\u4e2a\u200b\u5e76\u53d1\u200b\u8bf7\u6c42\u200b\u7684\u200b\u603b\u200b\u65f6\u95f4\u200b: {end_time - start_time}\u200b\u79d2\u200b\")\n\n    # print(results)\n\n\nif __name__ == \"__main__\":\n\n    # \u200b\u534f\u7a0b\u200b\u6d4b\u8bd5\u200b\n    loop = asyncio.get_event_loop()\n    loop.run_until_complete(main())\n\n    # \u200b\u540c\u6b65\u200b\u6d4b\u8bd5\u200b\n    # main2()\n</code></pre> <p>\u200b\u7ed3\u679c\u200b\uff1a</p> <p>\u200b\u6d4b\u8bd5\u200b\u8bf7\u6c42\u200b100\u200b\u6761\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u534f\u7a0b\u200b\uff0cSemaphore=100\uff0c\u200b\u8017\u65f6\u200b\uff1a1.899681568145752\u200b\u79d2\u200b-2\u200b\u79d2\u5de6\u53f3\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u534f\u7a0b\u200b\uff0cSemaphore=10\uff0c\u200b\u8017\u65f6\u200b\uff1a5.349802017211914\u200b\u79d2\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u534f\u7a0b\u200b\uff0cSemaphore=1\uff0c\u200b\u8017\u65f6\u200b\uff1a48.74130725860596\u200b\u79d2\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u591a\u7ebf\u7a0b\u200b\uff0cworkers=100\uff0c\u200b\u8017\u65f6\u200b 1.5306212902069092\u200b\u79d2\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u591a\u7ebf\u7a0b\u200b\uff0cworkers=10\uff0c\u200b\u8017\u65f6\u200b 3.461984157562256\u200b\u79d2\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u591a\u7ebf\u7a0b\u200b\uff0cworkers=1\uff0c\u200b\u8017\u65f6\u200b 32.65285873413086\u200b\u79d2\u200b</p> <p>\u200b\u6d4b\u8bd5\u200b\u8bf7\u6c42\u200b10000\u200b\u6761\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u534f\u7a0b\u200b\uff0cSemaphore=100\uff0c\u200b\u8017\u65f6\u200b\uff1a99.30082130432129\u200b\u79d2\u5de6\u53f3\u200b\uff0c\u200b\u5927\u6982\u200b100/S\uff0c\u200b\u548c\u200bSemaphore\u200b\u4e00\u81f4\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u591a\u7ebf\u7a0b\u200b\uff0cworkers=100\uff0c\u200b\u62a5\u9519\u200b</p>"},{"location":"bigdata/python/#3asynciorunlock","title":"3.asyncio.run()\u200b\u548c\u200block","text":"<p>\u200b\u5f53\u200b\u4ee3\u7801\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u4e86\u200b<code>lock = asyncio.Lock()</code>\u200b\u521b\u5efa\u200b\u9501\u200b\uff0c\u200b\u5e76\u4e14\u200b\u4f7f\u7528\u200b<code>asyncio.run()</code>\u200b\u8fd0\u884c\u200b\u4ee3\u7801\u200b\uff0c\u200b\u6709\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u51fa\u73b0\u200b<code>Task &lt;Task pending ...&gt; got Future &lt;Future pending&gt; attached to a different loop Task was destroyed but it is pending!</code>\u200b\u7684\u200b\u62a5\u9519\u200b\u3002</p> <p>\u200b\u53ef\u80fd\u200b\u7684\u200b\u539f\u56e0\u200b\u662f\u200b\uff1a<code>syncio.Lock</code>\u200b\u4e0e\u200b<code>asyncio.run</code>\u200b\u4e4b\u95f4\u200b\u7684\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u53ef\u80fd\u200b\u4e0d\u200b\u5339\u914d\u200b\uff0c\u200b\u901a\u5e38\u200b\u4f1a\u200b\u5728\u200b\u67d0\u4e9b\u200b\u73af\u5883\u200b\u4e2d\u200b\uff08\u200b\u5982\u200b\u7279\u5b9a\u200b\u7684\u200b IDE \u200b\u6216\u200b\u811a\u672c\u200b\u8fd0\u884c\u200b\u73af\u5883\u200b\uff09\u200b\u51fa\u73b0\u200b\u95ee\u9898\u200b\u3002\u200b\u539f\u56e0\u200b\u5728\u4e8e\u200b<code>asyncio.run</code> \u200b\u521b\u5efa\u200b\u5e76\u200b\u7ba1\u7406\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\uff0c\u200b\u800c\u9501\u200b (<code>asyncio.Lock</code>) \u200b\u53ef\u80fd\u200b\u4f1a\u200b\u88ab\u200b\u4e0d\u540c\u200b\u7684\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u4f7f\u7528\u200b\uff0c\u200b\u4ece\u800c\u200b\u5bfc\u81f4\u200b\u4e0d\u200b\u4e00\u81f4\u200b\u3002\u200b\u4e3a\u200b\u907f\u514d\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u663e\u5f0f\u200b\u521b\u5efa\u200b\u5e76\u200b\u4f7f\u7528\u200b\u4e00\u4e2a\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b:</p> <pre><code>loop = asyncio.get_event_loop()\nloop.run_until_complete(main())\n</code></pre>"},{"location":"bigdata/python/#4asyncioto_thread","title":"4.asyncio.to_thread()","text":"<p><code>asyncio.to_thread()</code> \u200b\u662f\u200b Python 3.9 \u200b\u5f15\u5165\u200b\u7684\u200b\u4e00\u4e2a\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b83\u200b\u7684\u200b\u4e3b\u8981\u200b\u4f5c\u7528\u200b\u662f\u200b\u5728\u200b\u5355\u72ec\u200b\u7684\u200b\u7ebf\u7a0b\u200b\u4e2d\u200b\u8fd0\u884c\u200b\u4e00\u4e2a\u200b\u51fd\u6570\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u5176\u200b\u7ed3\u679c\u200b\u4f5c\u4e3a\u200b\u4e00\u4e2a\u200b\u534f\u7a0b\u200b\u8fd4\u56de\u200b\u3002\u200b\u8fd9\u200b\u4f7f\u5f97\u200b\u6211\u4eec\u200b\u53ef\u4ee5\u200b\u5728\u200b <code>asyncio</code> \u200b\u7684\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u4e2d\u200b\u5b89\u5168\u200b\u5730\u200b\u8c03\u7528\u200b\u963b\u585e\u200b\u7684\u200b\u540c\u6b65\u200b\u51fd\u6570\u200b\uff0c\u200b\u800c\u200b\u4e0d\u4f1a\u200b\u963b\u585e\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u3002</p> <p>\u200b\u4e3a\u4ec0\u4e48\u200b\u9700\u8981\u200b <code>asyncio.to_thread()</code>\uff1f</p> <p>\u200b\u5728\u200b\u5f02\u6b65\u200b\u7f16\u7a0b\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u5e94\u8be5\u200b\u5c3d\u91cf\u907f\u514d\u200b\u6267\u884c\u200b\u963b\u585e\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u4eec\u200b\u4f1a\u200b\u963b\u585e\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\uff0c\u200b\u5bfc\u81f4\u200b\u6574\u4e2a\u200b\u7a0b\u5e8f\u200b\u505c\u987f\u200b\u3002\u200b\u7136\u800c\u200b\uff0c\u200b\u5728\u200b\u5b9e\u9645\u200b\u5f00\u53d1\u200b\u4e2d\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u9047\u5230\u200b\u4e00\u4e9b\u200b\u65e0\u6cd5\u200b\u907f\u514d\u200b\u7684\u200b\u963b\u585e\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a</p> <ul> <li>\u200b\u8c03\u7528\u200b\u4e00\u4e9b\u200b\u6ca1\u6709\u200b\u63d0\u4f9b\u200b\u5f02\u6b65\u200b\u63a5\u53e3\u200b\u7684\u200b\u7b2c\u4e09\u65b9\u200b\u5e93\u200b\u3002</li> <li>\u200b\u6267\u884c\u200b\u4e00\u4e9b\u200b CPU \u200b\u5bc6\u96c6\u578b\u200b\u8ba1\u7b97\u200b\u3002</li> <li>\u200b\u8fdb\u884c\u200b\u6587\u4ef6\u200b I/O \u200b\u64cd\u4f5c\u200b\uff08\u200b\u867d\u7136\u200b <code>aiofiles</code> \u200b\u7b49\u5e93\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u5f02\u6b65\u200b\u6587\u4ef6\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u4f46\u200b\u5728\u200b\u67d0\u4e9b\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u53ef\u80fd\u200b\u4e0d\u200b\u9002\u7528\u200b\uff09\u3002</li> </ul> <p>\u200b\u5728\u200b\u8fd9\u79cd\u200b\u60c5\u51b5\u200b\u4e0b\u200b\uff0c<code>asyncio.to_thread()</code> \u200b\u5c31\u200b\u6d3e\u200b\u4e0a\u200b\u4e86\u200b\u7528\u573a\u200b\u3002\u200b\u5b83\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u8fd9\u4e9b\u200b\u963b\u585e\u200b\u64cd\u4f5c\u200b\u653e\u5230\u200b\u5355\u72ec\u200b\u7684\u200b\u7ebf\u7a0b\u200b\u4e2d\u200b\u6267\u884c\u200b\uff0c\u200b\u4ece\u800c\u200b\u907f\u514d\u200b\u963b\u585e\u200b\u4e8b\u4ef6\u200b\u5faa\u73af\u200b\u3002</p> <p><code>asyncio.to_thread()</code> \u200b\u7684\u200b\u7528\u6cd5\u200b</p> <p><code>asyncio.to_thread()</code> \u200b\u7684\u200b\u57fa\u672c\u200b\u7528\u6cd5\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>import asyncio\n\nasync def main():\n    def blocking_io():\n        print(f\"start blocking_io at {asyncio.get_running_loop()}\")\n        # \u200b\u6a21\u62df\u200b\u963b\u585e\u200b\u64cd\u4f5c\u200b\n        import time\n        time.sleep(1)\n        print(f\"blocking_io complete at {asyncio.get_running_loop()}\")\n        return \"Blocking result\"\n\n    print(f\"start main at {asyncio.get_running_loop()}\")\n    result = await asyncio.to_thread(blocking_io)\n    print(f\"end main with result: {result} at {asyncio.get_running_loop()}\")\n\nasyncio.run(main())\n</code></pre> <p>\u200b\u6ce8\u610f\u4e8b\u9879\u200b</p> <ul> <li>GIL \u200b\u7684\u200b\u5f71\u54cd\u200b\uff1a \u200b\u7531\u4e8e\u200b Python \u200b\u7684\u200b\u5168\u5c40\u200b\u89e3\u91ca\u5668\u200b\u9501\u200b\uff08GIL\uff09\u200b\u7684\u200b\u5b58\u5728\u200b\uff0c<code>asyncio.to_thread()</code> \u200b\u5bf9\u4e8e\u200b CPU \u200b\u5bc6\u96c6\u578b\u200b\u4efb\u52a1\u200b\u7684\u200b\u6027\u80fd\u200b\u63d0\u5347\u200b\u6709\u9650\u200b\u3002\u200b\u5bf9\u4e8e\u200b CPU \u200b\u5bc6\u96c6\u578b\u200b\u4efb\u52a1\u200b\uff0c\u200b\u5e94\u8be5\u200b\u4f7f\u7528\u200b <code>concurrent.futures.ProcessPoolExecutor()</code> \u200b\u6765\u200b\u5229\u7528\u200b\u591a\u6838\u200b CPU\u3002\u200b\u4f46\u662f\u200b\u5bf9\u4e8e\u200b I/O \u200b\u5bc6\u96c6\u578b\u200b\u4efb\u52a1\u200b\uff0c<code>asyncio.to_thread()</code> \u200b\u4ecd\u7136\u200b\u975e\u5e38\u200b\u6709\u6548\u200b\u3002</li> <li>\u200b\u7ebf\u7a0b\u200b\u5b89\u5168\u200b\uff1a \u200b\u4f20\u9012\u200b\u7ed9\u200b <code>asyncio.to_thread()</code> \u200b\u7684\u200b\u51fd\u6570\u200b\u5e94\u8be5\u200b\u662f\u200b\u7ebf\u7a0b\u200b\u5b89\u5168\u200b\u7684\u200b\u3002\u200b\u5982\u679c\u200b\u51fd\u6570\u200b\u8bbf\u95ee\u200b\u4e86\u200b\u5171\u4eab\u200b\u7684\u200b\u53ef\u53d8\u200b\u6570\u636e\u200b\uff0c\u200b\u9700\u8981\u200b\u4f7f\u7528\u200b\u9002\u5f53\u200b\u7684\u200b\u540c\u6b65\u200b\u673a\u5236\u200b\uff08\u200b\u5982\u9501\u200b\uff09\u200b\u6765\u200b\u4fdd\u62a4\u200b\u6570\u636e\u200b\u3002</li> <li>\u200b\u5f02\u5e38\u200b\u5904\u7406\u200b\uff1a \u200b\u5982\u679c\u200b\u5728\u7ebf\u200b\u7a0b\u4e2d\u200b\u6267\u884c\u200b\u7684\u200b\u51fd\u6570\u200b\u629b\u51fa\u200b\u5f02\u5e38\u200b\uff0c<code>asyncio.to_thread()</code> \u200b\u8fd4\u56de\u200b\u7684\u200b\u534f\u7a0b\u200b\u4e5f\u200b\u4f1a\u200b\u629b\u51fa\u200b\u76f8\u540c\u200b\u7684\u200b\u5f02\u5e38\u200b\u3002\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b <code>try...except</code> \u200b\u8bed\u53e5\u200b\u6765\u200b\u6355\u83b7\u200b\u5f02\u5e38\u200b\u3002</li> </ul> <p>\u200b\u4e0e\u200b <code>loop.run_in_executor()</code> \u200b\u7684\u200b\u6bd4\u8f83\u200b</p> <p>\u200b\u5728\u200b Python 3.9 \u200b\u4e4b\u524d\u200b\uff0c\u200b\u901a\u5e38\u200b\u4f7f\u7528\u200b <code>loop.run_in_executor()</code> \u200b\u6765\u200b\u5728\u200b\u5355\u72ec\u200b\u7684\u200b\u7ebf\u7a0b\u200b\u6216\u200b\u8fdb\u7a0b\u200b\u4e2d\u200b\u8fd0\u884c\u200b\u51fd\u6570\u200b\u3002<code>asyncio.to_thread()</code> \u200b\u53ef\u4ee5\u200b\u770b\u4f5c\u200b\u662f\u200b <code>loop.run_in_executor()</code> \u200b\u7684\u200b\u4e00\u4e2a\u200b\u7b80\u5316\u200b\u7248\u672c\u200b\uff0c\u200b\u5b83\u200b\u9ed8\u8ba4\u200b\u4f7f\u7528\u200b\u7ebf\u7a0b\u200b\u6c60\u200b\u6267\u884c\u5668\u200b\uff0c\u200b\u4f7f\u7528\u200b\u8d77\u6765\u200b\u66f4\u52a0\u200b\u65b9\u4fbf\u200b\u3002</p>"},{"location":"bigdata/python/#aiolimite","title":"aiolimite","text":"<p><code>AsyncLimiter</code> \u200b\u662f\u200b\u4e00\u4e2a\u200b\u5b9e\u73b0\u200b\u4e86\u200b \u200b\u6f0f\u6876\u200b\u7b97\u6cd5\u200b\uff08Leaky Bucket Algorithm\uff09 \u200b\u7684\u200b\u901f\u7387\u200b\u9650\u5236\u5668\u200b\uff0c\u200b\u5141\u8bb8\u200b\u6211\u4eec\u200b\u63a7\u5236\u200b\u5e76\u53d1\u200b\u8bf7\u6c42\u200b\u7684\u200b\u901f\u7387\u200b\u3002\u200b\u5728\u200b\u5f02\u6b65\u200b\u7f16\u7a0b\u200b\u4e2d\u200b\uff0c<code>AsyncLimiter</code> \u200b\u53ef\u4ee5\u200b\u7528\u4f5c\u200b\u5f02\u6b65\u200b\u4e0a\u4e0b\u6587\u200b\u7ba1\u7406\u5668\u200b\uff08<code>async with</code>\uff09\uff0c\u200b\u7528\u4e8e\u200b\u9650\u5236\u200b\u5728\u200b\u4e00\u5b9a\u200b\u65f6\u95f4\u200b\u5185\u200b\u8fdb\u884c\u200b\u7684\u200b\u64cd\u4f5c\u200b\u6b21\u6570\u200b\u3002\u200b\u4f8b\u5982\u200b\uff0c\u200b\u9650\u5236\u200b\u6bcf\u5206\u949f\u200b\u6700\u200b\u591a\u200b\u6267\u884c\u200b 10 \u200b\u6b21\u200b\u4efb\u52a1\u200b\uff0c\u200b\u6216\u8005\u200b\u6bcf\u79d2\u200b\u6700\u200b\u591a\u200b\u6267\u884c\u200b\u4e00\u5b9a\u200b\u6570\u91cf\u200b\u7684\u200b\u8bf7\u6c42\u200b\u3002</p> <pre><code>GTP\u200b\u6e90\u7801\u200b\u4ecb\u7ecd\u200b\uff1a\nhttps://chatgpt.com/share/676532aa-9794-8004-b724-358e921655e6\n\n\u200b\u987a\u4fbf\u200b\u4e00\u63d0\u200b\uff1a\n\u200b\u6e90\u7801\u200b\u4e2d\u200b\u7684\u200b__aenter__\uff1a\n\u200b\u5728\u200b Python \u200b\u4e2d\u200b\uff0c__aenter__ \u200b\u548c\u200b __aexit__ \u200b\u662f\u200b\u5f02\u6b65\u200b\u4e0a\u4e0b\u6587\u200b\u7ba1\u7406\u5668\u200b\u7684\u200b\u4e00\u90e8\u5206\u200b\uff0c\u200b\u5b83\u4eec\u200b\u7528\u4e8e\u200b\u5b9a\u4e49\u200b\u4e00\u4e2a\u200b\u5bf9\u8c61\u200b\u7684\u200b\u5f02\u6b65\u200b\u4e0a\u4e0b\u6587\u200b\u7ba1\u7406\u200b\u534f\u8bae\u200b\u3002\u200b\u8fd9\u4e9b\u200b\u65b9\u6cd5\u200b\u901a\u5e38\u200b\u5728\u200b async with \u200b\u8bed\u53e5\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u3002\n__aenter__ \u200b\u65b9\u6cd5\u200b\u5728\u200b\u8fdb\u5165\u200b async with \u200b\u8bed\u53e5\u200b\u7684\u200b\u4e0a\u4e0b\u6587\u200b\u7ba1\u7406\u5668\u200b\u65f6\u200b\u8c03\u7528\u200b\u3002\u200b\u8fd9\u200b\u901a\u5e38\u200b\u7528\u4e8e\u200b\u8bbe\u7f6e\u200b\u8d44\u6e90\u200b\uff0c\u200b\u4f8b\u5982\u200b\u6253\u5f00\u200b\u6587\u4ef6\u200b\uff0c\u200b\u6216\u8005\u200b\u5efa\u7acb\u200b\u7f51\u7edc\u8fde\u63a5\u200b\u3002\n__aexit__ \u200b\u65b9\u6cd5\u200b\u5728\u200b\u79bb\u5f00\u200b async with \u200b\u8bed\u53e5\u200b\u7684\u200b\u4e0a\u4e0b\u6587\u200b\u7ba1\u7406\u5668\u200b\u65f6\u200b\u8c03\u7528\u200b\u3002\u200b\u8fd9\u200b\u901a\u5e38\u200b\u7528\u4e8e\u200b\u6e05\u7406\u200b\u8d44\u6e90\u200b\uff0c\u200b\u4f8b\u5982\u200b\u5173\u95ed\u200b\u6587\u4ef6\u200b\uff0c\u200b\u6216\u8005\u200b\u65ad\u5f00\u200b\u7f51\u7edc\u8fde\u63a5\u200b\u3002\n</code></pre> <p>\u200b\u4f7f\u7528\u200b<code>aiolimite</code>\u200b\u7684\u200b\u539f\u56e0\u200b\u662f\u200b\u66ff\u6362\u200b<code>asyncio</code>\u200b\u4e2d\u200b\u7684\u200b<code>semaphore</code>\uff0c\u200b\u539f\u56e0\u200b\u662f\u200b\u4f7f\u7528\u200b\u4e86\u200b<code>semaphore</code>\u200b\u540e\u200b\uff0c\u200b\u53d1\u73b0\u200b\u8c03\u7528\u200b\u767e\u5ea6\u200bAPI\u200b\u7684\u200bQPS\u200b\u8fdc\u8d85\u200b90\uff0c\u200b\u540e\u9762\u200b\u624d\u200b\u53d1\u73b0\u200b\u662f\u200b\u6df7\u6dc6\u200b\u4e86\u200b\u6982\u5ff5\u200b\uff0csemaphore\u200b\u662f\u200b\u8868\u793a\u200b\u534f\u7a0b\u200b\u7684\u200b\u5e76\u53d1\u200b\u6570\u200b\uff0c\u200b\u548c\u200bQPS\u200b\u7684\u200b\u6982\u7387\u200b\u4e0d\u540c\u200b\uff0c\u200b\u5e76\u200b\u4e0d\u662f\u200b\u4e00\u79d2\u200b\u5185\u200b\u7684\u200b\u5e76\u884c\u200b\u6570\u91cf\u200b\uff0c\u200b\u4f7f\u7528\u200b<code>aiolimite</code>\u200b\u53ef\u4ee5\u200b\u8bbe\u7f6e\u200b\u5468\u671f\u200b\u5185\u200b\u7684\u200b\u5e76\u53d1\u200b\u6570\u200b\uff0c\u200b\u9002\u5408\u200b\u7528\u4e8e\u200b\u8c03\u7528\u200b\u6709\u200bQPS\u200b\u9650\u5236\u200b\u7684\u200bAPI\uff0c\u200b\u4f7f\u7528\u200b\u65b9\u5f0f\u200b\u4e5f\u200b\u5f88\u200b\u7b80\u5355\u200b\uff0c\u200b\u5b9a\u4e49\u200b<code>limiter = AsyncLimiter(90, 1)</code>,\u200b\u5bf9\u200b\u9700\u8981\u200b\u663e\u793a\u200b\u7684\u200b\u4ee3\u7801\u200b\u4f7f\u7528\u200bwith\u200b\u7ba1\u7406\u200b\uff0c<code>async with self.limiter</code></p>"},{"location":"bigdata/python/#conda","title":"conda\u200b\u73af\u5883\u200b\u642d\u5efa","text":"<pre><code># \u200b\u4e0b\u8f7d\u200b\nwget https://repo.anaconda.com/archive/Anaconda3-2023.03-1-Linux-x86_64.sh\n\n1\u3001\u200b\u8f93\u5165\u200b\u547d\u4ee4\u200b\uff1abash Anaconda-3-5.3.1-Linux-x86_64.sh\n2\u3001\u200b\u56de\u8f66\u200b\n3\u3001\u200b\u8f93\u5165\u200b\uff1ayes\n4\u3001\u200b\u9009\u62e9\u200b\u5b89\u88c5\u200b\u8def\u5f84\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4fee\u6539\u200b\u5b89\u88c5\u200b\u8def\u5f84\u200b\n5\u3001\u200b\u8f93\u5165\u200b\uff1ayes\n# \u200b\u63d0\u793a\u200b\u201cThank you for installing Anaconda3!\u201d\u200b\u89c6\u4e3a\u200b\u5b89\u88c5\u200b\u6210\u529f\u200b\n\n# \u200b\u6587\u4ef6\u200b\u914d\u7f6e\u200b\n\n1\u3001\u200b\u6253\u5f00\u200b\u914d\u7f6e\u6587\u4ef6\u200b\uff1a\n    vim /etc/profile\n2\u3001 \u200b\u5728\u200b\u6587\u4ef6\u200b\u7684\u200b\u6700\u540e\u200b\u52a0\u4e0a\u200b\u5982\u4e0b\u200b\u914d\u7f6e\u200b\n    export ANACONDA_HOME=/home/data/xw_bigdata/anaconda3           # \u200b\u6b65\u9aa4\u200b2.4 \u200b\u4e2d\u200b\u7684\u200b\u5b89\u88c5\u200b\u8def\u5f84\u200b\n    export PATH=$ANACONDA_HOME/bin:$PATH\n    export PYSPARK_PYTHON=$ANACONDA_HOME/bin/python            # \u200b\u53ef\u4e0d\u200b\u6dfb\u52a0\u200b\n3\u3001source /etc/profile     # \u200b\u4f7f\u200b\u6587\u4ef6\u200b\u4fee\u6539\u200b\u751f\u6548\u200b\n\n#\u200b\u6dfb\u52a0\u200b\u6570\u636e\u6e90\u200b\uff1a\u200b\u4f8b\u5982\u200b, \u200b\u6dfb\u52a0\u200b\u6e05\u534e\u200banaconda\u200b\u955c\u50cf\u200b\uff1a\nconda config --add channels https://mirrors.aliyun.com/conda/pkgs/free/\nconda config --add channels https://mirrors.aliyun.com/conda/pkgs/main/\nconda config --add channels https://mirrors.aliyun.com/conda/pkgs/r/\n\n#\u200b\u79fb\u9664\u200b\nconda config --remove channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/\n\n# \u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u5728\u200b/root/.condarc\u200b\u4fee\u6539\u200b\nchannels:\n  - defaults\nshow_channel_urls: true\ndefault_channels:\n  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main\n  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r\n  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2\ncustom_channels:\n  conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\n  msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\n  bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\n  menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\n  pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\n  pytorch-lts: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\n  simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud\n  deepmodeling: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/\n\n# \u200b\u5176\u4ed6\u200b\u7684\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\uff1a\nhttps://zhuanlan.zhihu.com/p/584580420\n</code></pre>"},{"location":"bigdata/python/#_5","title":"\u547d\u4ee4","text":"<pre><code>1. conda --version #\u200b\u67e5\u770b\u200bconda\u200b\u7248\u672c\u200b\uff0c\u200b\u9a8c\u8bc1\u200b\u662f\u5426\u200b\u5b89\u88c5\u200b\n2. conda update conda #\u200b\u66f4\u65b0\u200b\u81f3\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\uff0c\u200b\u4e5f\u200b\u4f1a\u200b\u66f4\u65b0\u200b\u5176\u5b83\u200b\u76f8\u5173\u200b\u5305\u200b\nconda update -n base conda #update\u200b\u6700\u65b0\u200b\u7248\u672c\u200b\u7684\u200bconda\n3. conda update --all #\u200b\u66f4\u65b0\u200b\u6240\u6709\u200b\u5305\u200b\n4. conda update package_name #\u200b\u66f4\u65b0\u200b\u6307\u5b9a\u200b\u7684\u200b\u5305\u200b\n5. conda create -n env_name package_name #\u200b\u521b\u5efa\u200b\u540d\u4e3a\u200benv_name\u200b\u7684\u200b\u65b0\u200b\u73af\u5883\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u8be5\u200b\u73af\u5883\u200b\u4e0b\u200b\u5b89\u88c5\u200b\u540d\u4e3a\u200bpackage_name \u200b\u7684\u200b\u5305\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u6307\u5b9a\u200b\u65b0\u200b\u73af\u5883\u200b\u7684\u200b\u7248\u672c\u53f7\u200b\uff0c\n\u200b\u4f8b\u5982\u200b\uff1aconda create -n test_env python=3.10 numpy pandas\uff0c\u200b\u521b\u5efa\u200b\u4e86\u200bpython2\u200b\u73af\u5883\u200b\uff0cpython\u200b\u7248\u672c\u200b\u4e3a\u200b2.7\uff0c\u200b\u540c\u65f6\u200b\u8fd8\u200b\u5b89\u88c5\u200b\u4e86\u200bnumpy pandas\u200b\u5305\u200b\n6. conda activate env_name #\u200b\u5207\u6362\u200b\u81f3\u200benv_name\u200b\u73af\u5883\u200b\n7. conda deactivate #\u200b\u9000\u51fa\u200b\u73af\u5883\u200b\n8. conda info -e #\u200b\u663e\u793a\u200b\u6240\u6709\u200b\u5df2\u7ecf\u200b\u521b\u5efa\u200b\u7684\u200b\u73af\u5883\u200b\n\u200b\u6216\u200b conda env list\n\u200b\u6216\u200b conda info --envs\n9. conda create --name new_env_name --clone old_env_name #\u200b\u590d\u5236\u200bold_env_name\u200b\u4e3a\u200bnew_env_name\n10. conda remove --name env_name \u2013all #\u200b\u5220\u9664\u200b\u73af\u5883\u200b\n11. conda list # \u200b\u67e5\u770b\u200b\u6240\u6709\u200b\u5df2\u7ecf\u200b\u5b89\u88c5\u200b\u7684\u200b\u5305\u200b\n12. conda install package_name #\u200b\u5728\u200b\u5f53\u524d\u200b\u73af\u5883\u200b\u4e2d\u200b\u5b89\u88c5\u5305\u200b\n13. conda install --name env_name package_name #\u200b\u5728\u200b\u6307\u5b9a\u200b\u73af\u5883\u200b\u4e2d\u200b\u5b89\u88c5\u5305\u200b\n14. conda remove -- name env_name package #\u200b\u5220\u9664\u200b\u6307\u5b9a\u200b\u73af\u5883\u200b\u4e2d\u200b\u7684\u200b\u5305\u200b\n15. conda remove package #\u200b\u5220\u9664\u200b\u5f53\u524d\u200b\u73af\u5883\u200b\u4e2d\u200b\u7684\u200b\u5305\u200b\n16. conda env remove -n env_name #\u200b\u91c7\u7528\u200b\u7b2c\u200b10\u200b\u6761\u200b\u7684\u200b\u65b9\u6cd5\u200b\u5220\u9664\u200b\u73af\u5883\u200b\u5931\u8d25\u200b\u65f6\u200b\uff0c\u200b\u53ef\u200b\u91c7\u7528\u200b\u8fd9\u79cd\u200b\u65b9\u6cd5\u200b\n\n\n17. \u200b\u4ee5\u4e0b\u200b\u4e24\u4e2a\u200b\u547d\u4ee4\u200b\u5fc5\u987b\u200b\u5728\u200b base \u200b\u73af\u5883\u200b\u4e0b\u200b\u8fdb\u884c\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u5426\u5219\u200b\u4f1a\u200b\u62a5\u9519\u200b\nconda create --name newname --clone oldname      # \u200b\u514b\u9686\u200boldname \u200b\u73af\u5883\u200b\u4e3a\u200bnewname \u200b\u73af\u5883\u200b\nconda remove --name oldname --all       # \u200b\u5f7b\u5e95\u200b\u5220\u9664\u200b\u65e7\u200b\u73af\u5883\u200b\n</code></pre> <p>conda \u200b\u81ea\u52a8\u200b\u5f00\u542f\u200b/\u200b\u5173\u95ed\u200b\u6fc0\u6d3b\u200b</p> <pre><code>conda config --set auto_activate_base false  #\u200b\u5173\u95ed\u200b\u81ea\u52a8\u200b\u6fc0\u6d3b\u72b6\u6001\u200b\nconda config --set auto_activate_base true  #\u200b\u5173\u95ed\u200b\u81ea\u52a8\u200b\u6fc0\u6d3b\u72b6\u6001\u200b\n</code></pre> <p>conda\u200b\u7626\u8eab\u200b</p> <pre><code> conda clean \u200b\u53ef\u4ee5\u200b\u8f7b\u677e\u200b\u641e\u5b9a\u200b\nconda clean -p        # \u200b\u5220\u9664\u200b\u6ca1\u6709\u200b\u7528\u200b\u7684\u200b\u5305\u200b\nconda clean -r        # \u200b\u5220\u9664\u200b tar \u200b\u5305\u200b\nconda clean -y --all    # \u200b\u5220\u9664\u200b\u6240\u6709\u200b\u7684\u200b\u5b89\u88c5\u5305\u200b\u53ca\u200bcache\n</code></pre> <p>\u200b\u5982\u4f55\u200b\u4f7f\u7528\u200b\u56de\u200b\u670d\u52a1\u5668\u200b\u7684\u200bpython</p> <pre><code>vi /etc/profile\n\u200b\u628a\u200bexport PATH=$ANACONDA_HOME/bin:$PATH\n\u200b\u4fee\u6539\u200b\u4e3a\u200b\uff1a\nexport PATH=$PATH:$ANACONDA_HOME/bin\nsource /etc/profile\n\nvi ~/.bashrc\n\u200b\u4fee\u6539\u200bPATH\u200b\u4e3a\u200bexport PATH=\"$PATH:/home/data/anaconda3/bin\"\nsource ~/.bashrc\n\n\u200b\u67e5\u770b\u200b\uff1a\necho $PATH\nWHICH python3\n</code></pre> <p>\u200b\u91cd\u65b0\u90e8\u7f72\u200b</p> <pre><code>1.conda create -n store-server python=3.11\n\u200b\u62a5\u9519\u200b\uff1a\nRetrieving notices: ...working... done\nCollecting package metadata (current_repodata.json): failed\n\nUnavailableInvalidChannel: HTTP 404 NOT FOUND for channel pkgs/r &lt;https://mirrors.aliyun.com/conda/pkgs/r&gt;\n\nThe channel is not accessible or is invalid.\n\nYou will need to adjust your conda configuration to proceed.\nUse `conda config --show channels` to view your configuration's current state,\nand use `conda config --show-sources` to view config file locations.\n\nconda config --show-sources\n==&gt; /root/.condarc &lt;==\nauto_activate_base: False\nchannels:\n  - https://mirrors.aliyun.com/conda/pkgs/r/\n  - https://mirrors.aliyun.com/conda/pkgs/main/\n  - https://mirrors.aliyun.com/conda/pkgs/free/\n  - conda-forge\n  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/\n  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/\n  - defaults\n\n# \u200b\u79fb\u9664\u200b\n\nconda config --remove channels https://mirrors.aliyun.com/conda/pkgs/r/\nconda config --remove channels https://mirrors.aliyun.com/conda/pkgs/main/\nconda config --remove channels https://mirrors.aliyun.com/conda/pkgs/free/\n\n# \u200b\u6dfb\u52a0\u200b\nconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/\nconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/\nconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r/\nconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/pro/\n\n# \u200b\u91cd\u65b0\u200b\nconda create -n store-server python=3.11\nconda activate store-server\npip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/\n</code></pre>"},{"location":"bigdata/python/#pydantic27","title":"pydantic2.7","text":"<p>Pydantic \u200b\u662f\u200b\u4e00\u4e2a\u200b\u7528\u4e8e\u200b\u6570\u636e\u200b\u9a8c\u8bc1\u200b\u548c\u200b\u89e3\u6790\u200b\u7684\u200b Python \u200b\u5e93\u200b\uff0c\u200b\u5b83\u200b\u901a\u8fc7\u200b\u58f0\u660e\u200b\u5f0f\u200b\u7684\u200b\u65b9\u5f0f\u200b\u5b9a\u4e49\u6570\u636e\u200b\u6a21\u578b\u200b\uff0c\u200b\u5e76\u200b\u63d0\u4f9b\u200b\u4e86\u200b\u81ea\u52a8\u200b\u751f\u6210\u200b\u6587\u6863\u200b\u3001\u200b\u9a8c\u8bc1\u200b\u6570\u636e\u200b\u7b49\u200b\u529f\u80fd\u200b\u3002</p>"},{"location":"bigdata/python/#_6","title":"\u57fa\u7840\u200b\u7528\u6cd5","text":"<pre><code>from pydantic import BaseModel\n\n\nclass User(BaseModel):\n    id: int\n    name: str = 'Jane Doe'\n\nuser = User(id='123')\n\n\nassert user.model_dump() == {'id': 123, 'name': 'Jane Doe'}\nassert user.model_fields_set == {'id'}\nassert user.name == 'Jane Doe'\n</code></pre>"},{"location":"bigdata/python/#orm","title":"orm\u200b\u6a21\u578b","text":"<p>\u200b\u4f7f\u7528\u200bmodel_validate\u200b\u65b9\u6cd5\u200b\u5c06\u200bsqlalchemy-orm\u200b\u8f6c\u4e3a\u200bpydantic\u200b\u6a21\u578b\u200b</p> <p>model_validate(): \u200b\u5b83\u200b\u63a5\u53d7\u200b\u4e00\u4e2a\u200bdict\u200b\u6216\u200b\u4e00\u4e2a\u200b\u5bf9\u8c61\u200b\u800c\u200b\u4e0d\u662f\u200b\u5173\u952e\u5b57\u200b\u53c2\u6570\u200b\u3002\u200b\u5982\u679c\u200b\u4f20\u9012\u200b\u7684\u200b\u5bf9\u8c61\u200b\u4e0d\u80fd\u200b\u88ab\u200b\u9a8c\u8bc1\u200b\uff0c\u200b\u6216\u8005\u200b\u5b83\u200b\u4e0d\u662f\u200b\u4e00\u4e2a\u200b\u5b57\u5178\u200b\u6216\u200b\u6a21\u578b\u200b\u7684\u200b\u5b9e\u4f8b\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5c06\u200b\u5f15\u53d1\u200b\u4e00\u4e2a\u200b ValidationError \u3002</p> <p>model_validate_json():\u200b\u63a5\u53d7\u200b\u4e00\u4e2a\u200bstr\u200b\u6216\u200bbytes\u200b\u5e76\u200b\u5c06\u200b\u5176\u200b\u89e3\u6790\u200b\u4e3a\u200bjson\uff0c\u200b\u7136\u540e\u200b\u5c06\u200b\u7ed3\u679c\u200b\u4f20\u9012\u200b\u7ed9\u200b <code>model_validate()</code> \u3002</p> <pre><code>from typing import List\n\nfrom sqlalchemy import Column, Integer, String\nfrom sqlalchemy.dialects.postgresql import ARRAY\nfrom sqlalchemy.orm import declarative_base\nfrom typing_extensions import Annotated\n\nfrom pydantic import BaseModel, ConfigDict, StringConstraints\n\nBase = declarative_base()\n\n\nclass CompanyOrm(Base):\n    __tablename__ = 'companies'\n\n    id = Column(Integer, primary_key=True, nullable=False)\n    public_key = Column(String(20), index=True, nullable=False, unique=True)\n    name = Column(String(63), unique=True)\n    domains = Column(ARRAY(String(255)))\n\n\nclass CompanyModel(BaseModel):\n    model_config = ConfigDict(from_attributes=True)\n\n    id: int\n    public_key: Annotated[str, StringConstraints(max_length=20)]\n    name: Annotated[str, StringConstraints(max_length=63)]\n    domains: List[Annotated[str, StringConstraints(max_length=255)]]\n\n\nco_orm = CompanyOrm(\n    id=123,\n    public_key='foobar',\n    name='Testing',\n    domains=['example.com', 'foobar.com'],\n)\nprint(co_orm)\n#&gt; &lt;__main__.CompanyOrm object at 0x0123456789ab&gt;\nco_model = CompanyModel.model_validate(co_orm)\nprint(co_model)\n\"\"\"\nid=123 public_key='foobar' name='Testing' domains=['example.com', 'foobar.com']\n\"\"\"\n\n# model_validate_json()\nclass User(BaseModel):\n    id: int\n    name: str = 'John Doe'\n    signup_ts: Optional[datetime] = None\n\n\nm = User.model_validate({'id': 123, 'name': 'James'})\nprint(m)\n#&gt; id=123 name='James' signup_ts=None\n\ntry:\n    User.model_validate(['not', 'a', 'dict'])\nexcept ValidationError as e:\n    print(e)\n    \"\"\"\n    1 validation error for User\n      Input should be a valid dictionary or instance of User [type=model_type, input_value=['not', 'a', 'dict'], input_type=list]\n    \"\"\"\n\nm = User.model_validate_json('{\"id\": 123, \"name\": \"James\"}')\nprint(m)\n</code></pre> <pre><code>from pydantic import BaseModel, ConfigDict\n\n\nclass User(BaseModel):\n    model_config = ConfigDict(extra='ignore')  \n\n    name: str\n\n\nuser = User(name='John Doe', age=20)  \nprint(user)\n#&gt; name='John Doe'\n</code></pre>"},{"location":"bigdata/python/#transformers","title":"Transformers","text":"<p>Python\u200b\u7684\u200b<code>transformers</code>\u200b\u5e93\u662f\u200b\u7531\u200bHugging Face\u200b\u5f00\u53d1\u200b\u7684\u200b\u5f00\u6e90\u200b\u5de5\u5177\u200b\uff0c\u200b\u65e8\u5728\u200b\u7b80\u5316\u200b\u81ea\u7136\u8bed\u8a00\u200b\u5904\u7406\u200b\uff08NLP\uff09\u200b\u4efb\u52a1\u200b\u7684\u200b\u5b9e\u73b0\u200b\u3002</p>"},{"location":"bigdata/python/#1","title":"1. \u200b\u7b80\u4ecb\u200b\u4e0e\u200b\u80cc\u666f","text":"<ul> <li>\u200b\u80cc\u666f\u200b\uff1aHugging Face\u200b\u7684\u200b<code>transformers</code>\u200b\u5e93\u200b\u96c6\u6210\u200b\u4e86\u200b\u591a\u79cd\u200b\u9884\u200b\u8bad\u7ec3\u200b\u6a21\u578b\u200b\uff08\u200b\u5982\u200bBERT\u3001GPT\u3001T5\u3001RoBERTa\u200b\u7b49\u200b\uff09\uff0c\u200b\u652f\u6301\u200bPyTorch\u3001TensorFlow\u200b\u548c\u200bJAX\u200b\u6846\u67b6\u200b\uff0c\u200b\u5e7f\u6cdb\u5e94\u7528\u200b\u4e8e\u200b\u6587\u672c\u200b\u5206\u7c7b\u200b\u3001\u200b\u751f\u6210\u200b\u3001\u200b\u7ffb\u8bd1\u200b\u7b49\u200b\u4efb\u52a1\u200b\u3002</li> <li>\u200b\u4f18\u52bf\u200b\uff1a\u200b\u63d0\u4f9b\u200b\u7edf\u4e00\u200b\u7684\u200bAPI\uff0c\u200b\u7528\u6237\u200b\u65e0\u9700\u200b\u4ece\u5934\u200b\u8bad\u7ec3\u200b\u6a21\u578b\u200b\uff0c\u200b\u53ef\u200b\u76f4\u63a5\u200b\u4f7f\u7528\u200b\u6216\u200b\u5fae\u8c03\u200b\u9884\u200b\u8bad\u7ec3\u200b\u6a21\u578b\u200b\uff0c\u200b\u8282\u7701\u200b\u8d44\u6e90\u200b\u3002</li> </ul>"},{"location":"bigdata/python/#2_1","title":"2. \u200b\u5b89\u88c5\u200b\u4e0e\u200b\u57fa\u672c\u200b\u7528\u6cd5","text":"<ul> <li>\u200b\u5b89\u88c5\u200b\uff1a</li> </ul> <pre><code>pip install transformers\n</code></pre> <ul> <li>\u200b\u5feb\u901f\u200b\u793a\u4f8b\u200b\uff08\u200b\u6587\u672c\u200b\u5206\u7c7b\u200b\uff09\uff1a</li> </ul> <pre><code>from transformers import pipeline\n\n# \u200b\u4f7f\u7528\u200b\u9884\u200b\u6784\u5efa\u200b\u7684\u200bpipeline\nclassifier = pipeline(\"sentiment-analysis\")\nresult = classifier(\"I love using transformers!\")\nprint(result)  # \u200b\u8f93\u51fa\u200b\uff1a[{'label': 'POSITIVE', 'score': 0.9998}]\n</code></pre>"},{"location":"bigdata/python/#3","title":"3. \u200b\u6838\u5fc3\u200b\u7ec4\u4ef6","text":"<ul> <li> <p>\u200b\u5206\u8bcd\u5668\u200b\uff08Tokenizer\uff09\uff1a</p> </li> <li> <p>\u200b\u5c06\u200b\u6587\u672c\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u6a21\u578b\u200b\u6240\u200b\u9700\u200b\u7684\u200b\u8f93\u5165\u200b\u683c\u5f0f\u200b\uff08\u200b\u5982\u200btoken ID\u3001attention mask\uff09\u3002</p> </li> <li> <p>\u200b\u793a\u4f8b\u200b\uff1a</p> <pre><code>from transformers import AutoTokenizer\n\ntokenizer = AutoTokenizer.from_pretrained(\"bert-base-uncased\")\ninputs = tokenizer(\"Hello, my dog is cute\", return_tensors=\"pt\")  # \u200b\u8fd4\u56de\u200bPyTorch\u200b\u5f20\u91cf\u200b\n</code></pre> </li> <li> <p>\u200b\u6a21\u578b\u200b\uff08Model\uff09\uff1a</p> </li> <li> <p>\u200b\u52a0\u8f7d\u200b\u9884\u200b\u8bad\u7ec3\u200b\u6a21\u578b\u200b\uff0c\u200b\u652f\u6301\u200b\u591a\u79cd\u200b\u67b6\u6784\u200b\uff08\u200b\u5982\u200b<code>BertModel</code>, <code>GPT2LMHeadModel</code>\uff09\u3002</p> </li> <li> <p>\u200b\u793a\u4f8b\u200b\uff1a</p> <pre><code>from transformers import AutoModel\n\nmodel = AutoModel.from_pretrained(\"bert-base-uncased\")\noutputs = model(**inputs)  # \u200b\u524d\u5411\u200b\u4f20\u64ad\u200b\n</code></pre> </li> <li> <p>\u200b\u914d\u7f6e\u200b\uff08Config\uff09\uff1a</p> </li> <li> <p>\u200b\u63a7\u5236\u200b\u6a21\u578b\u200b\u7ed3\u6784\u200b\u53c2\u6570\u200b\uff08\u200b\u5982\u200b\u5c42\u6570\u200b\u3001\u200b\u6ce8\u610f\u529b\u200b\u5934\u6570\u200b\uff09\u3002</p> </li> <li> <p>\u200b\u793a\u4f8b\u200b\uff1a</p> <pre><code>from transformers import BertConfig\n\nconfig = BertConfig.from_pretrained(\"bert-base-uncased\")\nmodel = BertModel(config)  # \u200b\u6839\u636e\u200b\u914d\u7f6e\u200b\u521d\u59cb\u5316\u200b\u6a21\u578b\u200b\n</code></pre> </li> </ul>"},{"location":"bigdata/python/#4","title":"4. \u200b\u4f7f\u7528\u200b\u793a\u4f8b","text":""},{"location":"bigdata/python/#gpt-2","title":"\u6587\u672c\u200b\u751f\u6210\u200b\uff08GPT-2\uff09","text":"<pre><code>from transformers import GPT2LMHeadModel, GPT2Tokenizer\n\ntokenizer = GPT2Tokenizer.from_pretrained(\"gpt2\")\nmodel = GPT2LMHeadModel.from_pretrained(\"gpt2\")\n\ninputs = tokenizer(\"Once upon a time,\", return_tensors=\"pt\")\noutputs = model.generate(**inputs, max_length=50)\nprint(tokenizer.decode(outputs[0]))\n</code></pre>"},{"location":"bigdata/python/#_7","title":"\u5fae\u8c03\u200b\u6a21\u578b\u200b\uff08\u200b\u4ee5\u200b\u6587\u672c\u200b\u5206\u7c7b\u200b\u4e3a\u4f8b\u200b\uff09","text":"<pre><code>from transformers import Trainer, TrainingArguments, AutoModelForSequenceClassification\nfrom datasets import load_dataset\n\ndataset = load_dataset(\"imdb\")  # \u200b\u52a0\u8f7d\u200b\u6570\u636e\u200b\u96c6\u200b\nmodel = AutoModelForSequenceClassification.from_pretrained(\"bert-base-uncased\", num_labels=2)\n\n# \u200b\u5b9a\u4e49\u200b\u8bad\u7ec3\u200b\u53c2\u6570\u200b\ntraining_args = TrainingArguments(\n    output_dir=\"./results\",\n    num_train_epochs=3,\n    per_device_train_batch_size=16,\n)\n\n# \u200b\u4f7f\u7528\u200bTrainer\u200b\u7b80\u5316\u200b\u8bad\u7ec3\u200b\ntrainer = Trainer(\n    model=model,\n    args=training_args,\n    train_dataset=dataset[\"train\"],\n    eval_dataset=dataset[\"test\"],\n)\ntrainer.train()\n</code></pre>"},{"location":"bigdata/python/#5","title":"5. \u200b\u5e38\u89c1\u200b\u4efb\u52a1\u200b\u4e0e\u200b\u5e94\u7528\u200b\u573a\u666f","text":"<ul> <li>\u200b\u6587\u672c\u200b\u5206\u7c7b\u200b\uff1a\u200b\u60c5\u611f\u200b\u5206\u6790\u200b\u3001\u200b\u5783\u573e\u90ae\u4ef6\u200b\u68c0\u6d4b\u200b\u3002</li> <li>\u200b\u6587\u672c\u200b\u751f\u6210\u200b\uff1a\u200b\u6545\u4e8b\u200b\u521b\u4f5c\u200b\u3001\u200b\u4ee3\u7801\u200b\u8865\u5168\u200b\uff08\u200b\u5982\u200bCodeGen\uff09\u3002</li> <li>\u200b\u95ee\u7b54\u200b\u7cfb\u7edf\u200b\uff1a\u200b\u57fa\u4e8e\u200bBERT\u200b\u7684\u200b\u62bd\u53d6\u200b\u5f0f\u200b\u95ee\u7b54\u200b\u3002</li> <li>\u200b\u7ffb\u8bd1\u200b\u4e0e\u200b\u6458\u8981\u200b\uff1a\u200b\u4f7f\u7528\u200bT5\u200b\u6216\u200bBART\u200b\u6a21\u578b\u200b\u3002</li> <li>\u200b\u547d\u540d\u200b\u5b9e\u4f53\u200b\u8bc6\u522b\u200b\uff08NER\uff09\uff1a\u200b\u6807\u8bb0\u200b\u6587\u672c\u200b\u4e2d\u200b\u7684\u200b\u5b9e\u4f53\u200b\u3002</li> </ul>"},{"location":"bigdata/python/#6","title":"6. \u200b\u9ad8\u7ea7\u200b\u529f\u80fd\u200b\u4e0e\u200b\u6280\u5de7","text":"<ul> <li> <p>\u200b\u6a21\u578b\u200b\u538b\u7f29\u200b\uff1a\u200b\u4f7f\u7528\u200b<code>bitsandbytes</code>\u200b\u8fdb\u884c\u200b8\u200b\u4f4d\u200b\u91cf\u5316\u200b\uff0c\u200b\u51cf\u5c11\u200b\u5185\u5b58\u200b\u5360\u7528\u200b\u3002</p> </li> <li> <p>\u200b\u5206\u5e03\u5f0f\u200b\u8bad\u7ec3\u200b\uff1a\u200b\u5229\u7528\u200b<code>accelerate</code>\u200b\u5e93\u200b\u5b9e\u73b0\u200b\u591a\u200bGPU/TPU\u200b\u8bad\u7ec3\u200b\u3002</p> </li> <li> <p>\u200b\u81ea\u5b9a\u4e49\u200b\u6a21\u578b\u200b</p> </li> </ul> <p>\uff1a\u200b\u6dfb\u52a0\u200b\u4efb\u52a1\u200b\u7279\u5b9a\u200b\u5c42\u200b\uff08\u200b\u5982\u200b\u5206\u7c7b\u200b\u5934\u200b\uff09\u200b\u5e76\u200b\u5fae\u8c03\u200b\u3002</p> <pre><code>from transformers import BertForSequenceClassification\n\nmodel = BertForSequenceClassification.from_pretrained(\"bert-base-uncased\", num_labels=5)\n</code></pre>"},{"location":"bigdata/python/#7","title":"7. \u200b\u8d44\u6e90\u200b\u4e0e\u200b\u793e\u533a","text":"<ul> <li>Hugging Face Hub\uff1a\u200b\u6258\u7ba1\u200b\u6570\u5343\u4e2a\u200b\u9884\u200b\u8bad\u7ec3\u200b\u6a21\u578b\u200b\uff08\u200b\u94fe\u63a5\u200b\uff09\u3002</li> <li>\u200b\u6587\u6863\u200b\u4e0e\u200b\u6559\u7a0b\u200b\uff1a\u200b\u8be6\u7ec6\u200b\u6307\u5357\u200b\u548c\u200b\u793a\u4f8b\u200b\uff08\u200b\u6587\u6863\u200b\uff09\u3002</li> <li>\u200b\u793e\u533a\u200b\u652f\u6301\u200b\uff1a\u200b\u6d3b\u8dc3\u200b\u7684\u200b\u8bba\u575b\u200b\u548c\u200bGitHub\u200b\u4ed3\u5e93\u200b\uff0c\u200b\u4fbf\u4e8e\u200b\u95ee\u9898\u89e3\u7b54\u200b\u3002</li> </ul>"},{"location":"bigdata/python/#8","title":"8. \u200b\u6ce8\u610f\u4e8b\u9879","text":"<ul> <li>\u200b\u8f93\u5165\u200b\u957f\u5ea6\u200b\u9650\u5236\u200b\uff1a\u200b\u5982\u200bBERT\u200b\u6700\u200b\u591a\u200b\u5904\u7406\u200b512\u200b\u4e2a\u200btoken\uff0c\u200b\u8d85\u957f\u200b\u6587\u672c\u200b\u9700\u200b\u622a\u65ad\u200b\u6216\u200b\u5206\u6bb5\u200b\u3002</li> <li>\u200b\u786c\u4ef6\u200b\u8981\u6c42\u200b\uff1a\u200b\u5927\u578b\u200b\u6a21\u578b\u200b\uff08\u200b\u5982\u200bGPT-3\uff09\u200b\u9700\u9ad8\u200b\u663e\u5b58\u200b\uff0c\u200b\u53ef\u200b\u9009\u7528\u200b\u5c0f\u89c4\u6a21\u200b\u53d8\u4f53\u200b\uff08\u200b\u5982\u200b<code>distilbert</code>\uff09\u3002</li> <li>\u200b\u5206\u8bcd\u5668\u200b\u5339\u914d\u200b\uff1a\u200b\u786e\u4fdd\u200b\u5206\u8bcd\u5668\u200b\u4e0e\u200b\u6a21\u578b\u200b\u5339\u914d\u200b\uff08\u200b\u5982\u200bBERT\u200b\u5206\u8bcd\u5668\u200b\u4e0d\u53ef\u200b\u7528\u4e8e\u200bGPT-2\uff09\u3002</li> </ul>"},{"location":"bigdata/tools/","title":"\u4e00\u4e9b\u200b\u6709\u7528\u200b\u7684\u200b\u5de5\u5177\u200b\u6216\u200b\u63d2\u4ef6","text":""},{"location":"bigdata/tools/#pycharm","title":"pycharm","text":""},{"location":"bigdata/tools/#chatgpt-easycode","title":"ChatGPT - Easycode","text":"<p>\u200b\u5728\u200bIDE\u200b\u4e2d\u200b\u4f7f\u7528\u200bChatGPT\uff0c\u200b\u65e0\u9700\u200bOpenAI\u200b\u5bc6\u94a5\u200b\u6216\u200b\u8bbf\u95ee\u200b\u4ee4\u724c\u200b \u200b\u9700\u8981\u200b - \u200b\u7531\u200bEasyCode\u200b\u4e3a\u200b\u60a8\u200b\u5e26\u6765\u200b\u3002\u200b\u66f4\u200b\u591a\u200b\u7684\u200b\u529f\u80fd\u200b\u5373\u5c06\u200b\u63a8\u51fa\u200b\u3002 \u200b\u76ee\u524d\u200b\u652f\u6301\u200b4\u200b\u79cd\u200b\u6a21\u5f0f\u200b\uff1a EasyCode - \u200b\u4e0d\u200b\u9700\u8981\u200bOpenAI\u200b\u5bc6\u94a5\u200b\u6216\u200b\u8bbf\u95ee\u200b\u4ee4\u724c\u200b\u3002 ChatGPT - \u200b\u9700\u8981\u200b\u8bbf\u95ee\u200b\u4ee4\u724c\u200b \uff08\u200b\u5373\u5c06\u200b\u5e9f\u5f03\u200b\uff09\u3002 OpenAI API - \u200b\u9700\u8981\u200b\u5b98\u65b9\u200bAPI\u200b\u5bc6\u94a5\u200b Online ChatGPT - \u200b\u9700\u8981\u200b\u901a\u8fc7\u200bwebview\u200b\u767b\u5f55\u200bChatGPT (\u200b\u5373\u5c06\u200b\u5e9f\u5f03\u200b)</p> <p>\u200b\u53ef\u200b\u5728\u200b\uff1ahttps://github.com/chatanywhere/GPT_API_free \u200b\u9886\u53d6\u200b\u514d\u8d39\u200b\u7684\u200bAPIkey\u3002 \u200b\u514d\u8d39\u200bAPI Key\u200b\u9650\u5236\u200b60\u200b\u8bf7\u6c42\u200b/\u200b\u5c0f\u65f6\u200b/IP&amp;Key\u200b\u8c03\u7528\u200b\u9891\u7387\u200b \u200b\u7136\u540e\u200b\u5728\u200bSettings &gt; Tools &gt; OpenAI &gt; GPT 3.5 Turbo\u200b\u8f93\u5165\u200bapikey,\u200b\u52fe\u9009\u200bCustomize Server,\u200b\u5c06\u200bServer Settings \u200b\u4fee\u6539\u200b\u4e3a\u200b https://api.chatanywhere.com.cn/v1/chat/completions</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/","title":"\u5927\u200b\u6570\u636e\u200b\u6846\u67b6\u200b\u547d\u4ee4","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#linuxvivim","title":"Linux\uff08vi/vim\uff09","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_1","title":"\u4e00\u822c\u200b\u6a21\u5f0f","text":"\u8bed\u6cd5\u200b \u200b\u529f\u80fd\u200b\u63cf\u8ff0\u200b yy \u200b\u590d\u5236\u200b\u5149\u6807\u200b\u5f53\u524d\u200b\u4e00\u884c\u200b y\u200b\u6570\u5b57\u200by \u200b\u590d\u5236\u200b\u4e00\u6bb5\u200b\uff08\u200b\u4ece\u200b\u7b2c\u200b\u51e0\u884c\u200b\u5230\u200b\u7b2c\u200b\u51e0\u884c\u200b\uff09 p \u200b\u7bad\u5934\u200b\u79fb\u52a8\u200b\u5230\u200b\u76ee\u7684\u200b\u884c\u200b\u7c98\u8d34\u200b u \u200b\u64a4\u9500\u200b\u4e0a\u200b\u4e00\u6b65\u200b dd \u200b\u5220\u9664\u200b\u5149\u6807\u200b\u5f53\u524d\u200b\u884c\u200b d\u200b\u6570\u5b57\u200bd \u200b\u5220\u9664\u200b\u5149\u6807\u200b\uff08\u200b\u542b\u200b\uff09\u200b\u540e\u200b\u591a\u5c11\u200b\u884c\u200b x \u200b\u5220\u9664\u200b\u4e00\u4e2a\u200b\u5b57\u6bcd\u200b\uff0c\u200b\u76f8\u5f53\u4e8e\u200bdel X \u200b\u5220\u9664\u200b\u4e00\u4e2a\u200b\u5b57\u6bcd\u200b\uff0c\u200b\u76f8\u5f53\u4e8e\u200bBackspace yw \u200b\u590d\u5236\u200b\u4e00\u4e2a\u200b\u8bcd\u200b dw \u200b\u5220\u9664\u200b\u4e00\u4e2a\u200b\u8bcd\u200b shift+^ \u200b\u79fb\u52a8\u200b\u5230\u200b\u884c\u5934\u200b shift+$ \u200b\u79fb\u52a8\u200b\u5230\u200b\u884c\u5c3e\u200b 1+shift+g \u200b\u79fb\u52a8\u200b\u5230\u200b\u9875\u200b\u5934\u200b\uff0c\u200b\u6570\u5b57\u200b shift+g \u200b\u79fb\u52a8\u200b\u5230\u200b\u9875\u200b\u5c3e\u200b \u200b\u6570\u5b57\u200bN+shift+g \u200b\u79fb\u52a8\u200b\u5230\u200b\u76ee\u6807\u200b\u884c"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_2","title":"\u7f16\u8f91\u200b\u6a21\u5f0f","text":"\u6309\u952e\u200b \u200b\u529f\u80fd\u200b i \u200b\u5f53\u524d\u200b\u5149\u6807\u200b\u524d\u200b a \u200b\u5f53\u524d\u200b\u5149\u6807\u200b\u540e\u200b o \u200b\u5f53\u524d\u200b\u5149\u6807\u200b\u884c\u200b\u7684\u200b\u4e0b\u200b\u4e00\u884c\u200b I \u200b\u5149\u6807\u200b\u6240\u5728\u200b\u884c\u200b\u6700\u524d\u200b A \u200b\u5149\u6807\u200b\u6240\u5728\u200b\u884c\u200b\u6700\u540e\u200b O \u200b\u5f53\u524d\u200b\u5149\u6807\u200b\u884c\u200b\u7684\u200b\u4e0a\u200b\u4e00\u884c"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_3","title":"\u6307\u4ee4\u200b\u6a21\u5f0f","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b :w \u200b\u4fdd\u5b58\u200b :q \u200b\u9000\u51fa\u200b :! \u200b\u5f3a\u5236\u6267\u884c\u200b /\u200b\u8981\u200b\u67e5\u627e\u200b\u7684\u200b\u8bcd\u200b n \u200b\u67e5\u627e\u200b\u4e0b\u200b\u4e00\u4e2a\u200b\uff0cN \u200b\u5f80\u200b\u4e0a\u200b\u67e5\u627e\u200b ? \u200b\u8981\u200b\u67e5\u627e\u200b\u7684\u200b\u8bcd\u200b n\u200b\u662f\u200b\u67e5\u627e\u200b\u4e0a\u200b\u4e00\u4e2a\u200b\uff0cshift+n\u200b\u662f\u200b\u5f80\u200b\u4e0b\u200b\u67e5\u627e\u200b :set nu \u200b\u663e\u793a\u200b\u884c\u53f7\u200b :set nonu \u200b\u5173\u95ed\u200b\u884c\u53f7"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_4","title":"\u538b\u7f29\u200b\u548c\u200b\u89e3\u538b","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#gzipgunzip","title":"gzip/gunzip \u200b\u538b\u7f29","text":"<p>\uff081\uff09\u200b\u53ea\u80fd\u200b\u538b\u7f29\u6587\u4ef6\u200b\u4e0d\u80fd\u200b\u538b\u7f29\u200b\u76ee\u5f55\u200b</p> <p>\uff082\uff09\u200b\u4e0d\u200b\u4fdd\u7559\u200b\u539f\u6765\u200b\u7684\u200b\u6587\u4ef6\u200b</p> <p>gzip\u200b\u538b\u7f29\u200b\uff1agzip hello.txt</p> <p>gunzip\u200b\u89e3\u200b\u538b\u7f29\u6587\u4ef6\u200b\uff1agunzip hello.txt.gz</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#zipunzip","title":"zip/unzip \u200b\u538b\u7f29","text":"<p>\u200b\u53ef\u4ee5\u200b\u538b\u7f29\u200b\u76ee\u5f55\u200b\u4e14\u200b\u4fdd\u7559\u200b\u6e90\u6587\u4ef6\u200b</p> <p>zip\u200b\u538b\u7f29\u200b\uff08\u200b\u538b\u7f29\u200b 1.txt \u200b\u548c\u200b2.txt\uff0c\u200b\u538b\u7f29\u200b\u540e\u200b\u7684\u200b\u540d\u79f0\u200b\u4e3a\u200bmypackage.zip\uff09\uff1azip hello.zip hello.txt world.txt</p> <p>unzip\u200b\u89e3\u538b\u200b\uff1aunzip hello.zip</p> <p>unzip\u200b\u89e3\u538b\u200b\u5230\u200b\u6307\u5b9a\u200b\u76ee\u5f55\u200b\uff1aunzip hello.zip -d /opt</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#tar","title":"tar \u200b\u6253\u5305","text":"<p>tar\u200b\u538b\u7f29\u200b\u591a\u4e2a\u200b\u6587\u4ef6\u200b\uff1atar -zcvf hello.txt world.txt</p> <p>tar\u200b\u538b\u7f29\u200b\u76ee\u5f55\u200b\uff1atar -zcvf hello.tar.gz opt/</p> <p>tar\u200b\u89e3\u538b\u200b\u5230\u200b\u5f53\u524d\u76ee\u5f55\u200b\uff1atar -zxvf hello.tar.gz</p> <p>tar\u200b\u89e3\u538b\u200b\u5230\u200b\u6307\u5b9a\u200b\u76ee\u5f55\u200b\uff1atar -zxvf hello.tar.gz -C /opt</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#rpm","title":"RPM","text":"<p>RPM\u200b\u67e5\u8be2\u200b\u547d\u4ee4\u200b\uff1arpm -qa |grep firefox</p> <p>RPM\u200b\u5378\u8f7d\u200b\u547d\u4ee4\u200b\uff1a</p> <p>rpm -e xxxxxx</p> <p>rpm -e --nodeps xxxxxx\uff08\u200b\u4e0d\u200b\u68c0\u67e5\u200b\u4f9d\u8d56\u200b\uff09</p> <p>RPM\u200b\u5b89\u88c5\u200b\u547d\u4ee4\u200b\uff1a</p> <p>rpm -ivh xxxxxx.rpm</p> <p>rpm -ivh --nodeps fxxxxxx.rpm\uff08--nodeps\uff0c\u200b\u4e0d\u200b\u68c0\u6d4b\u200b\u4f9d\u8d56\u200b\u8fdb\u5ea6\u200b\uff09</p> \u200b\u9009\u9879\u200b \u200b\u529f\u80fd\u200b -i -i=install\uff0c\u200b\u5b89\u88c5\u200b -v -v=verbose\uff0c\u200b\u663e\u793a\u200b\u8be6\u7ec6\u4fe1\u606f\u200b -h -h=hash\uff0c\u200b\u8fdb\u5ea6\u6761\u200b --nodeps --nodeps\uff0c\u200b\u4e0d\u200b\u68c0\u6d4b\u200b\u4f9d\u8d56\u200b\u8fdb\u5ea6"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#shell","title":"Shell","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_5","title":"\u8f93\u5165\u200b/\u200b\u8f93\u51fa\u200b\u91cd\u5b9a\u5411","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b command &gt; file \u200b\u5c06\u200b\u8f93\u51fa\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file command &lt; file \u200b\u5c06\u200b\u8f93\u5165\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file command &gt;&gt; file \u200b\u5c06\u200b\u8f93\u51fa\u200b\u4ee5\u200b\u8ffd\u52a0\u200b\u7684\u200b\u65b9\u5f0f\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file n &gt; file \u200b\u5c06\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u4e3a\u200b n \u200b\u7684\u200b\u6587\u4ef6\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file n &gt;&gt; file \u200b\u5c06\u200b\u6587\u4ef6\u200b\u63cf\u8ff0\u7b26\u200b\u4e3a\u200b n \u200b\u7684\u200b\u6587\u4ef6\u200b\u4ee5\u200b\u8ffd\u52a0\u200b\u7684\u200b\u65b9\u5f0f\u200b\u91cd\u5b9a\u5411\u200b\u5230\u200b file n &gt;&amp; m \u200b\u5c06\u200b\u8f93\u51fa\u200b\u6587\u4ef6\u200b m \u200b\u548c\u200b n \u200b\u5408\u5e76\u200b n &lt;&amp; m \u200b\u5c06\u200b\u8f93\u5165\u200b\u6587\u4ef6\u200b m \u200b\u548c\u200b n \u200b\u5408\u5e76\u200b &lt;&lt; tag \u200b\u5c06\u200b\u5f00\u59cb\u200b\u6807\u8bb0\u200b tag \u200b\u548c\u200b\u7ed3\u675f\u200b\u6807\u8bb0\u200b tag \u200b\u4e4b\u95f4\u200b\u7684\u200b\u5185\u5bb9\u200b\u4f5c\u4e3a\u200b\u8f93\u5165"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_6","title":"\u811a\u672c\u200b\u7f16\u8f91","text":"\u5feb\u6377\u65b9\u5f0f\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b shift \u200b\u53c2\u6570\u200b\u5de6\u79fb\u200b $@ \u200b\u6240\u6709\u200b\u7684\u200b\u53c2\u6570\u200b $# \u200b\u53c2\u6570\u200b\u7684\u200b\u4e2a\u6570"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#hadoop","title":"Hadoop","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_7","title":"\u542f\u52a8\u200b\u7c7b\u200b\u547d\u4ee4","text":"\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u547d\u4ee4\u200b\u811a\u672c\u200b \u200b\u542f\u52a8\u200bhdfs\u200b\u96c6\u7fa4\u200b sbin/start-dfs.sh \u200b\u542f\u52a8\u200byarn sbin/start-yarn.sh"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#hadoop-fshdfs-dfs","title":"hadoop fs/hdfs dfs \u200b\u547d\u4ee4","text":"\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u547d\u4ee4\u200b \u200b\u521b\u5efa\u200b\u76ee\u5f55\u200b hdfs dfs -mkdir -p /data/flink \u200b\u663e\u793a\u76ee\u5f55\u200b hdfs dfs -ls / \u200b\u4ece\u200bHDFS\u200b\u62f7\u8d1d\u5230\u200b\u672c\u5730\u200b hdfs dfs -copyToLocal /data/data.txt ./ \u200b\u6587\u4ef6\u200b\u4e0a\u200b\u4f20\u5230\u200b\u96c6\u7fa4\u200b(\u200b\u4ece\u200b\u672c\u5730\u200b) hhdfs dfs -copyFromLocal data.txt / \u200b\u6587\u4ef6\u200b\u4e0b\u8f7d\u200b hdfs dfs -get /data/flink \u200b\u5220\u9664\u200b\u96c6\u7fa4\u200b\u7684\u200b\u6587\u4ef6\u200b hdfs dfs -rm /data/flink \u200b\u5220\u9664\u200b\u6587\u4ef6\u5939\u200b hdfs dfs -rm -r -skipTrash /data \u200b\u4ece\u200b\u672c\u5730\u200b\u526a\u5207\u200b\u7c98\u8d34\u200b\u5230\u200bHDFS hdfs dfs  -moveFromLocal data.txt /data/ \u200b\u8ffd\u52a0\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u5230\u200b\u5df2\u7ecf\u200b\u5b58\u5728\u200b\u7684\u200b\u6587\u4ef6\u200b\u672b\u5c3e\u200bhdfs dfs -appendToFile data1.txt /data/data.txt \u200b\u663e\u793a\u6587\u4ef6\u200b\u5185\u5bb9\u200b hdfs dfs -cat data.txt \u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u6240\u5c5e\u200b\u6743\u9650\u200b hdfs dfs  -chmod  777 xxx.sh \u200b\u4fee\u6539\u200b\u6587\u4ef6\u200b\u6240\u5c5e\u200b\u7528\u6237\u7ec4\u200b hdfs dfs  -chown  root:root data.txt \u200b\u4ece\u200bHDFS\u200b\u7684\u200b\u4e00\u4e2a\u200b\u8def\u5f84\u200b\u62f7\u8d1d\u5230\u200bHDFS\u200b\u7684\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u8def\u5f84\u200b hdfs dfs -cp data.txt /data1.txt \u200b\u5728\u200bHDFS\u200b\u76ee\u5f55\u200b\u4e2d\u200b\u79fb\u52a8\u200b\u6587\u4ef6\u200b hdfs dfs -mv data.txt /opt/ \u200b\u5408\u5e76\u200b\u4e0b\u8f7d\u200b\u591a\u4e2a\u200b\u6587\u4ef6\u200b hdfs dfs  -getmerge /data/* ./data_merge.txt hadoop fs -put \u200b\u7b49\u540c\u4e8e\u200bcopyFromLocal \u200b\u663e\u793a\u200b\u4e00\u4e2a\u200b\u6587\u4ef6\u200b\u7684\u200b\u672b\u5c3e\u200b hdfs dfs -tail data.txt \u200b\u5220\u9664\u200b\u6587\u4ef6\u200b\u6216\u200b\u6587\u4ef6\u5939\u200b hdfs dfs -rm /data/data.txt \u200b\u5220\u9664\u200b\u7a7a\u76ee\u5f55\u200b hdfs dfs -rmdir /data \u200b\u7edf\u8ba1\u200b\u6587\u4ef6\u5939\u200b\u7684\u200b\u5927\u5c0f\u200b\u4fe1\u606f\u200b hdfs dfs -s -h /data \u200b\u7edf\u8ba1\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\u7684\u200b\u6587\u4ef6\u5927\u5c0f\u200b\u4fe1\u606f\u200b hdfs dfs  -h /data \u200b\u8bbe\u7f6e\u200bHDFS\u200b\u4e2d\u200b\u6587\u4ef6\u200b\u7684\u200b\u526f\u672c\u200b\u6570\u91cf\u200b hdfs dfs -setrep 3 /data/data.txt"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#yarn","title":"yarn\u200b\u547d\u4ee4","text":"\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u547d\u4ee4\u200b \u200b\u67e5\u770b\u200b\u6b63\u5728\u200b\u8fd0\u884c\u200b\u7684\u200byarn\u200b\u4efb\u52a1\u200b\u5217\u8868\u200b yarn application -list appID kill\u200b\u6389\u200b\u6307\u5b9a\u200bid\u200b\u7684\u200byarn\u200b\u4efb\u52a1\u200b yarn application -kill appID \u200b\u67e5\u770b\u200b\u4efb\u52a1\u200b\u65e5\u5fd7\u200b\u4fe1\u606f\u200b yarn logs -applicationId appID"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#zookeeper","title":"Zookeeper","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_8","title":"\u542f\u52a8\u200b\u547d\u4ee4","text":"\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u547d\u4ee4\u200b\u811a\u672c\u200b \u200b\u542f\u52a8\u200bzookeeper\u200b\u670d\u52a1\u200b zkServer.sh start \u200b\u67e5\u770b\u200bzookeeper\u200b\u72b6\u6001\u200b zkServer.sh status \u200b\u505c\u6b62\u200bzookeeper\u200b\u670d\u52a1\u200b zkServer.sh stop \u200b\u542f\u52a8\u200bzookeeper\u200b\u5ba2\u6237\u7aef\u200b zkCli.sh -server 127.0.0.1:2181 \u200b\u9000\u51fa\u200bzookeeper\u200b\u5ba2\u6237\u7aef\u200b quit"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_9","title":"\u57fa\u672c\u64cd\u4f5c","text":"\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u547d\u4ee4\u200b\u811a\u672c\u200b \u200b\u5f53\u524d\u200bznode\u200b\u4e2d\u200b\u6240\u200b\u5305\u542b\u200b\u7684\u200b\u5185\u5bb9\u200b ls / \u200b\u521b\u5efa\u200b\u666e\u901a\u200b\u8282\u70b9\u200b(\u200b\u524d\u9762\u200b\u662f\u200b\u8282\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b\uff0c\u200b\u540e\u9762\u200b\u662f\u200b\u503c\u200b\uff09 create /bigdata/flink \"flink\" \u200b\u83b7\u53d6\u200b\u8282\u70b9\u200b\u7684\u200b\u503c\u200b get /bigdata \u200b\u4fee\u6539\u200b\u8282\u70b9\u200b\u7684\u200b\u503c\u200b set /bigdata/flink \"flinksql\" \u200b\u5220\u9664\u200b\u8282\u70b9\u200b delete /bigdata/flink \u200b\u9012\u5f52\u200b\u5220\u9664\u200b\u8282\u70b9\u200b rmr /bigdata"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_10","title":"\u56db\u200b\u5b57\u6bcd\u200b\u547d\u4ee4","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u4f8b\u5b50\u200b conf zk\u200b\u670d\u52a1\u200b\u914d\u7f6e\u200b\u7684\u200b\u8be6\u7ec6\u4fe1\u606f\u200b echo conf | nc 127.0.0.1 2181 stat \u200b\u5ba2\u6237\u7aef\u200b\u4e0e\u200bzk\u200b\u8fde\u63a5\u200b\u7684\u200b\u7b80\u8981\u200b\u4fe1\u606f\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b srvr zk\u200b\u670d\u52a1\u200b\u7684\u200b\u8be6\u7ec6\u4fe1\u606f\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b cons \u200b\u5ba2\u6237\u7aef\u200b\u4e0e\u200bzk\u200b\u8fde\u63a5\u200b\u7684\u200b\u8be6\u7ec6\u4fe1\u606f\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b mntr zk\u200b\u670d\u52a1\u200b\u76ee\u524d\u200b\u7684\u200b\u6027\u80fd\u200b\u72b6\u51b5\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b crst \u200b\u91cd\u7f6e\u200b\u5f53\u524d\u200b\u7684\u200b\u6240\u6709\u200b\u8fde\u63a5\u200b\u3001\u200b\u4f1a\u8bdd\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b dump \u200b\u5217\u51fa\u200b\u672a\u7ecf\u200b\u5904\u7406\u200b\u7684\u200b\u4f1a\u200b\u8bdd\u200b\u548c\u200b\u8fde\u63a5\u200b\u4fe1\u606f\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b envi \u200b\u5217\u51fa\u200bzk\u200b\u7684\u200b\u7248\u672c\u4fe1\u606f\u200b\u3001\u200b\u4e3b\u673a\u200b\u540d\u79f0\u200b\u3001Java\u200b\u7248\u672c\u200b\u3001\u200b\u670d\u52a1\u5668\u200b\u540d\u79f0\u200b\u7b49\u7b49\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b ruok \u200b\u6d4b\u8bd5\u200b\u670d\u52a1\u5668\u200b\u662f\u5426\u200b\u6b63\u5728\u200b\u8fd0\u884c\u200b\uff0c\u200b\u5982\u679c\u200b\u5728\u200b\u8fd0\u884c\u200b\u8fd4\u56de\u200bimok\uff0c\u200b\u5426\u5219\u200b\u8fd4\u56de\u200b\u7a7a\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b srst \u200b\u91cd\u7f6e\u200bZookeeper\u200b\u7684\u200b\u6240\u6709\u200b\u7edf\u8ba1\u200b\u4fe1\u606f\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b wchs \u200b\u5217\u51fa\u200bwatch\u200b\u7684\u200b\u603b\u6570\u200b\uff0c\u200b\u8fde\u63a5\u6570\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b wchp \u200b\u5217\u51fa\u200b\u6240\u6709\u200bwatch\u200b\u7684\u200b\u8def\u5f84\u200b\u53ca\u200bsessionID \u200b\u53c2\u8003\u200b\u4e0a\u9762\u200b mntr \u200b\u5217\u51fa\u200b\u96c6\u7fa4\u200b\u7684\u200b\u5173\u952e\u200b\u6027\u80fd\u200b\u6570\u636e\u200b\uff0c\u200b\u5305\u62ec\u200bzk\u200b\u7684\u200b\u7248\u672c\u200b\u3001node\u200b\u6570\u91cf\u200b\u3001\u200b\u4e34\u65f6\u200b\u8282\u70b9\u200b\u6570\u200b\u7b49\u7b49\u200b \u200b\u53c2\u8003\u200b\u4e0a\u9762"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#kafka","title":"Kafka","text":"<p>\u200b\u6ce8\u200b: \u200b\u8fd9\u91cc\u200b\u673a\u5668\u200b\u6211\u200b\u53ea\u200b\u5199\u200b\u4e00\u4e2a\u200b\u3002\u200b\u547d\u4ee4\u200b\u4f60\u4eec\u200b\u4e5f\u200b\u53ef\u200b\u4f7f\u7528\u200b ./bin/xx.sh (\u200b\u5982\u200b\uff1a./bin/kafka-topics.sh) </p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#topic","title":"\u67e5\u770b\u200b\u5f53\u524d\u200b\u670d\u52a1\u5668\u200b\u4e2d\u200b\u7684\u200b\u6240\u6709\u200btopic","text":"<pre><code>kafka-topics --zookeeper xxxxxx:2181 --list --exclude-internal \n\n\u200b\u8bf4\u660e\u200b\uff1a\n\nexclude-internal\uff1a\u200b\u6392\u9664\u200bkafka\u200b\u5185\u90e8\u200btopic\n\n\u200b\u6bd4\u5982\u200b\uff1a --exclude-internal  --topic \"test_.*\"\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#topic_1","title":"\u521b\u5efa\u200btopic","text":"<pre><code>kafka-topics --zookeeper xxxxxx:2181  --create \n--replication-factor \n--partitions 1 \n--topic topic_name\n\n\u200b\u8bf4\u660e\u200b\uff1a\n\n--topic \u200b\u5b9a\u4e49\u200btopic\u200b\u540d\u200b\n\n--replication-factor  \u200b\u5b9a\u4e49\u200b\u526f\u672c\u200b\u6570\u200b\n\n--partitions  \u200b\u5b9a\u4e49\u200b\u5206\u533a\u200b\u6570\u200b\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#topic_2","title":"\u5220\u9664\u200btopic","text":"<p>\u200b\u6ce8\u610f\u200b: \u200b\u9700\u8981\u200bserver.properties\u200b\u4e2d\u200b\u8bbe\u7f6e\u200bdelete.topic.enable=true\u200b\u5426\u5219\u200b\u53ea\u662f\u200b\u6807\u8bb0\u200b\u5220\u9664\u200b <pre><code>kafka-topics --zookeeper xxxxxx:2181 --delete --topic topic_name\n</code></pre></p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_11","title":"\u751f\u4ea7\u8005","text":"<pre><code>kafka-console-producer --broker-list xxxxxx:9092 --topic topic_name\n\n\u200b\u53ef\u200b\u52a0\u200b\uff1a--property parse.key=true\uff08\u200b\u6709\u200bkey\u200b\u6d88\u606f\u200b\uff09\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_12","title":"\u6d88\u8d39\u8005","text":"<pre><code>kafka-console-consumer --bootstrap-server xxxxxx:9092 --topic topic_name\n\n\u200b\u6ce8\u200b\uff1a\u200b\u53ef\u200b\u9009\u200b\n\n--from-beginning\uff1a\u200b\u4f1a\u200b\u628a\u200b\u4e3b\u9898\u200b\u4e2d\u200b\u4ee5\u5f80\u200b\u6240\u6709\u200b\u7684\u200b\u6570\u636e\u200b\u90fd\u200b\u8bfb\u53d6\u200b\u51fa\u6765\u200b\n\n--whitelist '.*' \uff1a\u200b\u6d88\u8d39\u200b\u6240\u6709\u200b\u7684\u200btopic\n\n--property print.key=true\uff1a\u200b\u663e\u793a\u200bkey\u200b\u8fdb\u884c\u200b\u6d88\u8d39\u200b\n\n--partition 0\uff1a\u200b\u6307\u5b9a\u200b\u5206\u533a\u200b\u6d88\u8d39\u200b\n\n--offset\uff1a\u200b\u6307\u5b9a\u200b\u8d77\u59cb\u200b\u504f\u79fb\u91cf\u200b\u6d88\u8d39\u200b\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#topic_3","title":"\u67e5\u770b\u200b\u67d0\u4e2a\u200bTopic\u200b\u7684\u200b\u8be6\u60c5","text":"<pre><code>kafka-topics --zookeeper xxxxxx:2181 --describe --topic topic_name\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_13","title":"\u4fee\u6539\u200b\u5206\u533a\u200b\u6570","text":"<pre><code>kafka-topics --zookeeper xxxxxx:2181 --alter --topic topic_name --partitions 6\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_14","title":"\u67e5\u770b\u200b\u67d0\u4e2a\u200b\u6d88\u8d39\u8005\u200b\u7ec4\u200b\u4fe1\u606f","text":"<pre><code>kafka-consumer-groups --bootstrap-server  xxxxxx:9092  --describe --group group_name \n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_15","title":"\u5220\u9664\u200b\u6d88\u8d39\u8005\u200b\u7ec4","text":"<pre><code>kafka-consumer-groups --bootstrap-server  xxxxxx:9092  ---delete --group group_name \n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#offset","title":"\u91cd\u7f6e\u200boffset","text":"<pre><code>kafka-consumer-groups --bootstrap-server  xxxxxx:9092  --group group_name\n\n--reset-offsets --all-topics --to-latest --execute \n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#leader","title":"leader\u200b\u91cd\u65b0\u200b\u9009\u4e3e","text":"<p>\u200b\u6307\u5b9a\u200bTopic\u200b\u6307\u5b9a\u200b\u5206\u533a\u200b\u7528\u200b\u91cd\u65b0\u200bPREFERRED\uff1a\u200b\u4f18\u5148\u200b\u526f\u672c\u200b\u7b56\u7565\u200b \u200b\u8fdb\u884c\u200bLeader\u200b\u91cd\u200b\u9009\u4e3e\u200b <pre><code>kafka-leader-election --bootstrap-server xxxxxx:9092 \n--topic topic_name --election-type PREFERRED --partition 0\n</code></pre></p> <p>\u200b\u6240\u6709\u200bTopic\u200b\u6240\u6709\u200b\u5206\u533a\u200b\u7528\u200b\u91cd\u65b0\u200bPREFERRED\uff1a\u200b\u4f18\u5148\u200b\u526f\u672c\u200b\u7b56\u7565\u200b \u200b\u8fdb\u884c\u200bLeader\u200b\u91cd\u200b\u9009\u4e3e\u200b <pre><code>kafka-leader-election --bootstrap-server xxxxxx:9092 \n--election-type preferred  --all-topic-partitions\n</code></pre></p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#kafka_1","title":"\u67e5\u8be2\u200bkafka\u200b\u7248\u672c\u4fe1\u606f","text":"<pre><code>kafka-configs --bootstrap-server xxxxxx:9092\n--describe --version\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_16","title":"\u589e\u5220\u200b\u6539\u200b\u914d\u7f6e","text":"\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u53c2\u6570\u200b \u200b\u9009\u62e9\u200b\u7c7b\u578b\u200b --entity-type (topics/clients/users/brokers/broker- loggers) \u200b\u7c7b\u578b\u200b\u540d\u79f0\u200b --entity-name \u200b\u5220\u9664\u200b\u914d\u7f6e\u200b --delete-config k1=v1,k2=v2 \u200b\u6dfb\u52a0\u200b/\u200b\u4fee\u6539\u200b\u914d\u7f6e\u200b --add-config k1,k2 <p>topic\u200b\u6dfb\u52a0\u200b/\u200b\u4fee\u6539\u200b\u52a8\u6001\u200b\u914d\u7f6e\u200b <pre><code>kafka-configs --bootstrap-server xxxxxx:9092\n--alter --entity-type topics --entity-name topic_name \n--add-config file.delete.delay.ms=222222,retention.ms=999999\n</code></pre></p> <p>topic\u200b\u5220\u9664\u200b\u52a8\u6001\u200b\u914d\u7f6e\u200b <pre><code>kafka-configs --bootstrap-server xxxxxx:9092 \n--alter --entity-type topics --entity-name topic_name \n--delete-config file.delete.delay.ms,retention.ms\n</code></pre></p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_17","title":"\u6301\u7eed\u200b\u6279\u91cf\u200b\u62c9\u53d6\u200b\u6d88\u606f","text":"<p>\u200b\u5355\u6b21\u200b\u6700\u5927\u200b\u6d88\u8d39\u200b10\u200b\u6761\u200b\u6d88\u606f\u200b(\u200b\u4e0d\u200b\u52a0\u200b\u53c2\u6570\u200b\u610f\u200b\u4e3a\u200b\u6301\u7eed\u200b\u6d88\u8d39\u200b) <pre><code>kafka-verifiable-consumer --bootstrap-server xxxxxx:9092 \n--group group_name\n--topic topic_name --max-messages 10\n</code></pre></p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_18","title":"\u5220\u9664\u200b\u6307\u5b9a\u200b\u5206\u533a\u200b\u7684\u200b\u6d88\u606f","text":"<p>\u200b\u5220\u9664\u200b\u6307\u5b9a\u200btopic\u200b\u7684\u200b\u67d0\u4e2a\u200b\u5206\u533a\u200b\u7684\u200b\u6d88\u606f\u200b\u5220\u9664\u200b\u81f3\u200boffset\u200b\u4e3a\u200b1024</p> <p>json\u200b\u6587\u4ef6\u200boffset-json-file.json <pre><code>{\n    \"partitions\": [\n        {\n            \"topic\": \"topic_name\",\n            \"partition\": 0,\n            \"offset\": 1024\n        }\n    ],\n    \"version\": 1\n}\n</code></pre></p> <pre><code>kafka-delete-records --bootstrap-server xxxxxx:9092 \n--offset-json-file offset-json-file.json\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#broker","title":"\u67e5\u770b\u200bBroker\u200b\u78c1\u76d8\u200b\u4fe1\u606f","text":"<p>\u200b\u67e5\u8be2\u200b\u6307\u5b9a\u200btopic\u200b\u78c1\u76d8\u200b\u4fe1\u606f\u200b <pre><code>kafka-log-dirs --bootstrap-server xxxxxx:9090 \n--describe --topic-list topic1,topic2\n</code></pre></p> <p>\u200b\u67e5\u8be2\u200b\u6307\u5b9a\u200bBroker\u200b\u78c1\u76d8\u200b\u4fe1\u606f\u200b <pre><code>kafka-log-dirs --bootstrap-server xxxxxx:9090 \n--describe --topic-list topic1 --broker-list 0\n</code></pre></p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#hive","title":"Hive","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_19","title":"\u542f\u52a8\u200b\u7c7b","text":"\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u547d\u4ee4\u200b \u200b\u542f\u52a8\u200bhiveserver2\u200b\u670d\u52a1\u200b bin/hiveserver2 \u200b\u542f\u52a8\u200bbeeline bin/beeline \u200b\u8fde\u63a5\u200bhiveserver2 beeline&gt; !connect jdbc:hive2://hadoop102:10000 metastroe\u200b\u670d\u52a1\u200b bin/hive --service metastore <p>hive \u200b\u542f\u52a8\u200b\u5143\u200b\u6570\u636e\u670d\u52a1\u200b\uff08metastore\u200b\u548c\u200bhiveserver2\uff09\u200b\u548c\u200b\u4f18\u96c5\u200b\u5173\u95ed\u200b\u811a\u672c\u200b <pre><code>\u200b\u542f\u52a8\u200b\uff1a hive.sh start\n\u200b\u5173\u95ed\u200b\uff1a hive.sh stop\n\u200b\u91cd\u542f\u200b\uff1a hive.sh restart\n\u200b\u72b6\u6001\u200b\uff1a hive.sh status\n</code></pre> \u200b\u811a\u672c\u200b\u5982\u4e0b\u200b <pre><code>#!/bin/bash\nHIVE_LOG_DIR=$HIVE_HOME/logs\n\nmkdir -p $HIVE_LOG_DIR\n\n#\u200b\u68c0\u67e5\u200b\u8fdb\u7a0b\u200b\u662f\u5426\u200b\u8fd0\u884c\u200b\u6b63\u5e38\u200b\uff0c\u200b\u53c2\u6570\u200b1\u200b\u4e3a\u200b\u8fdb\u7a0b\u200b\u540d\u200b\uff0c\u200b\u53c2\u6570\u200b2\u200b\u4e3a\u200b\u8fdb\u7a0b\u200b\u7aef\u53e3\u200b\nfunction check_process()\n{\n    pid=$(ps -ef 2&gt;/dev/null | grep -v grep | grep -i $1 | awk '{print $2}')\n    ppid=$(netstat -nltp 2&gt;/dev/null | grep $2 | awk '{print $7}' | cut -d '/' -f 1)\n    echo $pid\n    [[ \"$pid\" =~ \"$ppid\" ]] &amp;&amp; [ \"$ppid\" ] &amp;&amp; return 0 || return 1\n}\n\nfunction hive_start()\n{\n    metapid=$(check_process HiveMetastore 9083)\n    cmd=\"nohup hive --service metastore &gt;$HIVE_LOG_DIR/metastore.log 2&gt;&amp;1 &amp;\"\n    cmd=$cmd\" sleep4; hdfs dfsadmin -safemode wait &gt;/dev/null 2&gt;&amp;1\"\n    [ -z \"$metapid\" ] &amp;&amp; eval $cmd || echo \"Metastroe\u200b\u670d\u52a1\u200b\u5df2\u200b\u542f\u52a8\u200b\"\n    server2pid=$(check_process HiveServer2 10000)\n    cmd=\"nohup hive --service hiveserver2 &gt;$HIVE_LOG_DIR/hiveServer2.log 2&gt;&amp;1 &amp;\"\n    [ -z \"$server2pid\" ] &amp;&amp; eval $cmd || echo \"HiveServer2\u200b\u670d\u52a1\u200b\u5df2\u200b\u542f\u52a8\u200b\"\n}\n\nfunction hive_stop()\n{\n    metapid=$(check_process HiveMetastore 9083)\n    [ \"$metapid\" ] &amp;&amp; kill $metapid || echo \"Metastore\u200b\u670d\u52a1\u200b\u672a\u200b\u542f\u52a8\u200b\"\n    server2pid=$(check_process HiveServer2 10000)\n    [ \"$server2pid\" ] &amp;&amp; kill $server2pid || echo \"HiveServer2\u200b\u670d\u52a1\u200b\u672a\u200b\u542f\u52a8\u200b\"\n}\n\ncase $1 in\n\"start\")\n    hive_start\n    ;;\n\"stop\")\n    hive_stop\n    ;;\n\"restart\")\n    hive_stop\n    sleep 2\n    hive_start\n    ;;\n\"status\")\n    check_process HiveMetastore 9083 &gt;/dev/null &amp;&amp; echo \"Metastore\u200b\u670d\u52a1\u200b\u8fd0\u884c\u200b\u6b63\u5e38\u200b\" || echo \"Metastore\u200b\u670d\u52a1\u200b\u8fd0\u884c\u200b\u5f02\u5e38\u200b\"\n    check_process HiveServer2 10000 &gt;/dev/null &amp;&amp; echo \"HiveServer2\u200b\u670d\u52a1\u200b\u8fd0\u884c\u200b\u6b63\u5e38\u200b\" || echo \"HiveServer2\u200b\u670d\u52a1\u200b\u8fd0\u884c\u200b\u5f02\u5e38\u200b\"\n    ;;\n*)\n    echo Invalid Args!\n    echo 'Usage: '$(basename $0)' start|stop|restart|status'\n    ;;\nesac\n</code></pre></p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_20","title":"\u5e38\u7528\u200b\u4ea4\u4e92\u200b\u547d\u4ee4","text":"\u529f\u80fd\u200b\u8bf4\u660e\u200b \u200b\u547d\u4ee4\u200b \u200b\u4e0d\u200b\u8fdb\u5165\u200bhive\u200b\u7684\u200b\u4ea4\u4e92\u200b\u7a97\u53e3\u200b\u6267\u884c\u200bsql bin/hive -e \"sql\u200b\u8bed\u53e5\u200b\" \u200b\u6267\u884c\u200b\u811a\u672c\u200b\u4e2d\u200bsql\u200b\u8bed\u53e5\u200b bin/hive -f hive.sql \u200b\u9000\u51fa\u200bhive\u200b\u7a97\u53e3\u200b exit \u200b\u6216\u200b quit \u200b\u547d\u4ee4\u200b\u7a97\u53e3\u200b\u4e2d\u200b\u67e5\u770b\u200bhdfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b dfs -ls / \u200b\u547d\u4ee4\u200b\u7a97\u53e3\u200b\u4e2d\u200b\u67e5\u770b\u200bhdfs\u200b\u6587\u4ef6\u7cfb\u7edf\u200b ! ls /data/h"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#sql","title":"SQL\u200b\u7c7b\u200b(\u200b\u7279\u6b8a\u200b\u7684\u200b)","text":"\u8bf4\u660e\u200b \u200b\u8bed\u53e5\u200b \u200b\u67e5\u770b\u200bhive\u200b\u4e2d\u200b\u7684\u200b\u6240\u6709\u200b\u6570\u636e\u5e93\u200b show databases \u200b\u7528\u200bdefault\u200b\u6570\u636e\u5e93\u200b use default \u200b\u67e5\u8be2\u200b\u8868\u200b\u7ed3\u6784\u200b desc table_name \u200b\u67e5\u770b\u200b\u6570\u636e\u5e93\u200b show databases \u200b\u91cd\u547d\u540d\u200b\u8868\u540d\u200b alter table table1 rename to table2 \u200b\u4fee\u6539\u200b\u8868\u4e2d\u5b57\u200b\u6bb5\u200b alter table table_name change name user_name String \u200b\u4fee\u6539\u200b\u5b57\u200b\u6bb5\u200b\u7c7b\u578b\u200b alter table table_name change salary salary Double \u200b\u521b\u5efa\u200b\u5916\u90e8\u200b\u8868\u200b create external table .... \u200b\u67e5\u8be2\u200b\u5916\u90e8\u200b\u8868\u200b\u4fe1\u606f\u200b desc formatted outsidetable \u200b\u521b\u5efa\u200b\u89c6\u56fe\u200b create view view_name as select * from table_name ..... \u200b\u6dfb\u52a0\u200b\u6570\u636e\u200b load data local inpath 'xxx'  overwrite into table table_name partition(day='2021-12-01')"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_21","title":"\u5185\u7f6e\u200b\u51fd\u6570","text":"<p>\uff081\uff09 NVL</p> <p>\u200b\u7ed9\u503c\u200b\u4e3a\u200bNULL\u200b\u7684\u200b\u6570\u636e\u200b\u8d4b\u503c\u200b\uff0c\u200b\u5b83\u200b\u7684\u200b\u683c\u5f0f\u200b\u662f\u200bNVL( value\uff0cdefault_value)\u3002\u200b\u5b83\u200b\u7684\u200b\u529f\u80fd\u200b\u662f\u200b\u5982\u679c\u200bvalue\u200b\u4e3a\u200bNULL\uff0c\u200b\u5219\u200bNVL\u200b\u51fd\u6570\u200b\u8fd4\u56de\u200bdefault_value\u200b\u7684\u200b\u503c\u200b\uff0c\u200b\u5426\u5219\u200b\u8fd4\u56de\u200bvalue\u200b\u7684\u200b\u503c\u200b\uff0c\u200b\u5982\u679c\u200b\u4e24\u4e2a\u200b\u53c2\u6570\u200b\u90fd\u200b\u4e3a\u200bNULL \uff0c\u200b\u5219\u200b\u8fd4\u56de\u200bNULL</p> <pre><code>select nvl(column, 0) from xxx\uff1b\n</code></pre> <p>\uff082\uff09\u200b\u884c\u200b\u8f6c\u5217\u200b</p> \u200b\u51fd\u6570\u200b \u200b\u63cf\u8ff0\u200b CONCAT(string A/col, string B/col\u2026) \u200b\u8fd4\u56de\u200b\u8f93\u5165\u200b\u5b57\u7b26\u4e32\u200b\u8fde\u63a5\u200b\u540e\u200b\u7684\u200b\u7ed3\u679c\u200b\uff0c\u200b\u652f\u6301\u200b\u4efb\u610f\u200b\u4e2a\u200b\u8f93\u5165\u200b\u5b57\u7b26\u4e32\u200b CONCAT_WS(separator, str1, str2,...) \u200b\u7b2c\u4e00\u4e2a\u200b\u53c2\u6570\u200b\u53c2\u6570\u200b\u95f4\u200b\u7684\u200b\u5206\u9694\u7b26\u200b\uff0c\u200b\u5982\u679c\u200b\u5206\u9694\u7b26\u200b\u662f\u200b NULL\uff0c\u200b\u8fd4\u56de\u503c\u200b\u4e5f\u200b\u5c06\u200b\u4e3a\u200b NULL\u3002\u200b\u8fd9\u4e2a\u200b\u51fd\u6570\u200b\u4f1a\u200b\u8df3\u200b\u8fc7\u200b\u5206\u9694\u7b26\u200b\u53c2\u6570\u200b\u540e\u200b\u7684\u200b\u4efb\u4f55\u200b NULL \u200b\u548c\u200b\u7a7a\u200b\u5b57\u7b26\u4e32\u200b\u3002\u200b\u5206\u9694\u7b26\u200b\u5c06\u200b\u88ab\u200b\u52a0\u5230\u200b\u88ab\u200b\u8fde\u63a5\u200b\u7684\u200b\u5b57\u7b26\u4e32\u200b\u4e4b\u95f4\u200b\u3002 COLLECT_SET(col) \u200b\u5c06\u200b\u67d0\u5b57\u200b\u6bb5\u200b\u7684\u200b\u503c\u200b\u8fdb\u884c\u200b\u53bb\u200b\u91cd\u200b\u6c47\u603b\u200b\uff0c\u200b\u4ea7\u751f\u200barray\u200b\u7c7b\u578b\u200b\u5b57\u200b\u6bb5\u200b COLLECT_LIST(col) \u200b\u51fd\u6570\u200b\u53ea\u200b\u63a5\u53d7\u200b\u57fa\u672c\u200b\u6570\u636e\u7c7b\u578b\u200b\uff0c\u200b\u5b83\u200b\u7684\u200b\u4e3b\u8981\u200b\u4f5c\u7528\u200b\u662f\u200b\u5c06\u200b\u67d0\u5b57\u200b\u6bb5\u200b\u7684\u200b\u503c\u200b\u8fdb\u884c\u200b\u4e0d\u53bb\u200b\u91cd\u200b\u6c47\u603b\u200b\uff0c\u200b\u4ea7\u751f\u200barray\u200b\u7c7b\u578b\u200b\u5b57\u200b\u6bb5\u200b\u3002 <p>\uff083\uff09\u200b\u5217\u200b\u8f6c\u884c\u200b(\u200b\u4e00\u5217\u200b\u8f6c\u200b\u591a\u884c\u200b)</p> <p>Split(str, separator)\uff1a \u200b\u5c06\u200b\u5b57\u7b26\u4e32\u200b\u6309\u7167\u200b\u540e\u9762\u200b\u7684\u200b\u5206\u9694\u7b26\u200b\u5207\u5272\u200b\uff0c\u200b\u8f6c\u6362\u6210\u200b\u5b57\u7b26\u200barray\u3002</p> <p>EXPLODE(col)\uff1a \u200b\u5c06\u200bhive\u200b\u4e00\u5217\u200b\u4e2d\u200b\u590d\u6742\u200b\u7684\u200barray\u200b\u6216\u8005\u200bmap\u200b\u7ed3\u6784\u200b\u62c6\u200b\u5206\u6210\u200b\u591a\u884c\u200b\u3002</p> <p>LATERAL VIEW <pre><code>\u200b\u7528\u6cd5\u200b\uff1a\n\nLATERAL VIEW udtf(expression) tableAlias AS columnAlias\n</code></pre> \u200b\u89e3\u91ca\u200b\uff1alateral view\u200b\u7528\u4e8e\u200b\u548c\u200bsplit, explode\u200b\u7b49\u200bUDTF\u200b\u4e00\u8d77\u200b\u4f7f\u7528\u200b\uff0c\u200b\u5b83\u200b\u80fd\u591f\u200b\u5c06\u200b\u4e00\u884c\u200b\u6570\u636e\u200b\u62c6\u6210\u200b\u591a\u884c\u200b\u6570\u636e\u200b\uff0c\u200b\u5728\u200b\u6b64\u57fa\u7840\u200b\u4e0a\u200b\u53ef\u4ee5\u200b\u5bf9\u200b\u62c6\u5206\u200b\u540e\u200b\u7684\u200b\u6570\u636e\u200b\u8fdb\u884c\u200b\u805a\u5408\u200b\u3002</p> <p>lateral view\u200b\u9996\u5148\u200b\u4e3a\u200b\u539f\u59cb\u200b\u8868\u200b\u7684\u200b\u6bcf\u884c\u200b\u8c03\u7528\u200bUDTF\uff0cUDTF\u200b\u4f1a\u200b\u628a\u200b\u4e00\u884c\u200b\u62c6\u200b\u5206\u6210\u200b\u4e00\u200b\u6216\u8005\u200b\u591a\u884c\u200b\uff0clateral view\u200b\u518d\u200b\u628a\u200b\u7ed3\u679c\u200b\u7ec4\u5408\u200b\uff0c\u200b\u4ea7\u751f\u200b\u4e00\u4e2a\u200b\u652f\u6301\u200b\u522b\u540d\u200b\u8868\u200b\u7684\u200b\u865a\u62df\u200b\u8868\u200b\u3002</p> <p>\u200b\u51c6\u5907\u200b\u6570\u636e\u6e90\u200b\u6d4b\u8bd5\u200b</p> movie category \u300a\u200b\u529f\u52cb\u200b\u300b \u200b\u8bb0\u5f55\u200b,\u200b\u5267\u60c5\u200b \u300a\u200b\u6218\u72fc\u200b2\u300b \u200b\u6218\u4e89\u200b,\u200b\u52a8\u4f5c\u200b,\u200b\u707e\u96be\u200b <p>SQL</p> <pre><code>SELECT movie,category_name \nFROM movie_info \nlateral VIEW\nexplode(split(category,\",\")) movie_info_tmp  AS category_name ;\n</code></pre> <p>\u200b\u6d4b\u8bd5\u200b\u7ed3\u679c\u200b <pre><code>\u300a\u200b\u529f\u52cb\u200b\u300b      \u200b\u8bb0\u5f55\u200b\n\u300a\u200b\u529f\u52cb\u200b\u300b      \u200b\u5267\u60c5\u200b\n\u300a\u200b\u6218\u72fc\u200b2\u300b     \u200b\u6218\u4e89\u200b\n\u300a\u200b\u6218\u72fc\u200b2\u300b     \u200b\u52a8\u4f5c\u200b\n\u300a\u200b\u6218\u72fc\u200b2\u300b     \u200b\u707e\u96be\u200b\n</code></pre></p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_22","title":"\u7a97\u53e3\u200b\u51fd\u6570","text":"<p>\uff081\uff09OVER()</p> <p>\u200b\u5b9a\u200b\u5206\u6790\u200b\u51fd\u6570\u200b\u5de5\u4f5c\u200b\u7684\u200b\u6570\u636e\u200b\u7a97\u53e3\u200b\u5927\u5c0f\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u6570\u636e\u200b\u7a97\u53e3\u200b\u5927\u5c0f\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u968f\u7740\u200b\u884c\u200b\u7684\u200b\u53d8\u200b\u800c\u200b\u53d8\u5316\u200b\u3002</p> <p>\uff082\uff09CURRENT ROW\uff08\u200b\u5f53\u524d\u200b\u884c\u200b\uff09</p> <pre><code>n PRECEDING\uff1a\u200b\u5f80\u524d\u200bn\u200b\u884c\u200b\u6570\u636e\u200b\n\nn FOLLOWING\uff1a\u200b\u5f80\u540e\u200bn\u200b\u884c\u200b\u6570\u636e\u200b\n</code></pre> <p>\uff083\uff09UNBOUNDED\uff08\u200b\u65e0\u200b\u8fb9\u754c\u200b\uff09</p> <pre><code>UNBOUNDED PRECEDING \u200b\u524d\u200b\u65e0\u200b\u8fb9\u754c\u200b\uff0c\u200b\u8868\u793a\u200b\u4ece\u200b\u524d\u9762\u200b\u7684\u200b\u8d77\u70b9\u200b\n\nUNBOUNDED FOLLOWING\u200b\u540e\u200b\u65e0\u200b\u8fb9\u754c\u200b\uff0c\u200b\u8868\u793a\u200b\u5230\u200b\u540e\u9762\u200b\u7684\u200b\u7ec8\u70b9\u200b\n</code></pre> <p>SQL\u200b\u6848\u4f8b\u200b\uff1a\u200b\u7531\u200b\u8d77\u70b9\u200b\u5230\u200b\u5f53\u524d\u200b\u884c\u200b\u7684\u200b\u805a\u5408\u200b</p> <pre><code>select \n    sum(money) over(partition by user_id order by pay_time rows between UNBOUNDED PRECEDING and current row) \nfrom or_order;\n</code></pre> <p>SQL\u200b\u6848\u4f8b\u200b\uff1a\u200b\u5f53\u524d\u200b\u884c\u200b\u548c\u200b\u524d\u9762\u200b\u4e00\u884c\u200b\u505a\u200b\u805a\u5408\u200b</p> <pre><code>select \n    sum(money) over(partition by user_id order by pay_time rows between 1 PRECEDING and current row) \nfrom or_order;\n</code></pre> <p>SQL\u200b\u6848\u4f8b\u200b\uff1a\u200b\u5f53\u524d\u200b\u884c\u200b\u548c\u200b\u524d\u9762\u200b\u4e00\u884c\u200b\u548c\u200b\u540e\u200b\u4e00\u884c\u200b\u505a\u200b\u805a\u5408\u200b</p> <pre><code>select \n    sum(money) over(partition by user_id order by pay_time rows between 1 PRECEDING AND 1 FOLLOWING )\nfrom or_order;\n</code></pre> <p>SQL\u200b\u6848\u4f8b\u200b\uff1a\u200b\u5f53\u524d\u200b\u884c\u53ca\u200b\u540e\u9762\u200b\u6240\u6709\u200b\u884c\u200b <pre><code>select \n    sum(money) over(partition by user_id order by pay_time rows between current row and UNBOUNDED FOLLOWING  )\nfrom or_order;\n</code></pre></p> <p>\uff084\uff09LAG(col,n,default_val)</p> <p>\u200b\u5f80\u524d\u200b\u7b2c\u200bn\u200b\u884c\u200b\u6570\u636e\u200b\uff0c\u200b\u6ca1\u6709\u200b\u7684\u8bdd\u200bdefault_val</p> <p>\uff085\uff09LEAD(col,n, default_val)</p> <p>\u200b\u5f80\u540e\u200b\u7b2c\u200bn\u200b\u884c\u200b\u6570\u636e\u200b\uff0c\u200b\u6ca1\u6709\u200b\u7684\u8bdd\u200bdefault_val</p> <p>SQL\u200b\u6848\u4f8b\u200b\uff1a\u200b\u67e5\u8be2\u200b\u7528\u6237\u200b\u8d2d\u4e70\u200b\u660e\u7ec6\u200b\u4ee5\u53ca\u200b\u4e0a\u6b21\u200b\u7684\u200b\u8d2d\u4e70\u200b\u65f6\u95f4\u200b\u548c\u200b\u4e0b\u6b21\u200b\u8d2d\u4e70\u200b\u65f6\u95f4\u200b</p> <pre><code>select \n    user_id,,pay_time,money,\n\n    lag(pay_time,1,'1970-01-01') over(PARTITION by name order by pay_time) prev_time,\n\n    lead(pay_time,1,'1970-01-01') over(PARTITION by name order by pay_time) next_time\nfrom or_order;\n</code></pre> <p>\uff086\uff09FIRST_VALUE(col,true/false)</p> <p>\u200b\u5f53\u524d\u200b\u7a97\u53e3\u200b\u4e0b\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u503c\u200b\uff0c\u200b\u7b2c\u4e8c\u4e2a\u200b\u53c2\u6570\u200b\u4e3a\u200btrue\uff0c\u200b\u8df3\u8fc7\u200b\u7a7a\u503c\u200b\u3002</p> <p>\uff087\uff09LAST_VALUE (col,true/false)</p> <p>\u200b\u5f53\u524d\u200b\u7a97\u53e3\u200b\u4e0b\u200b\u7684\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u503c\u200b\uff0c\u200b\u7b2c\u4e8c\u4e2a\u200b\u53c2\u6570\u200b\u4e3a\u200btrue\uff0c\u200b\u8df3\u8fc7\u200b\u7a7a\u503c\u200b\u3002</p> <p>SQL\u200b\u6848\u4f8b\u200b\uff1a\u200b\u67e5\u8be2\u200b\u7528\u6237\u200b\u6bcf\u4e2a\u200b\u6708\u200b\u7b2c\u4e00\u6b21\u200b\u7684\u200b\u8d2d\u4e70\u200b\u65f6\u95f4\u200b \u200b\u548c\u200b \u200b\u6bcf\u4e2a\u200b\u6708\u200b\u7684\u200b\u6700\u540e\u200b\u4e00\u6b21\u200b\u8d2d\u4e70\u200b\u65f6\u95f4\u200b</p> <pre><code>select\n    FIRST_VALUE(pay_time) \n        over(\n            partition by user_id,month(pay_time) order by pay_time \n            rows between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING\n            ) first_time,\n\n    LAST_VALUE(pay_time) \n        over(partition by user_id,month(pay_time) order by pay_time rows between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING\n        ) last_time\nfrom or_order;\n</code></pre> <p>\uff088\uff09NTILE(n)</p> <p>\u200b\u628a\u200b\u6709\u5e8f\u200b\u7a97\u53e3\u200b\u7684\u200b\u884c\u200b\u5206\u53d1\u200b\u5230\u200b\u6307\u5b9a\u200b\u6570\u636e\u200b\u7684\u200b\u7ec4\u4e2d\u200b\uff0c\u200b\u5404\u4e2a\u200b\u7ec4\u6709\u200b\u7f16\u53f7\u200b\uff0c\u200b\u7f16\u53f7\u200b\u4ece\u200b1\u200b\u5f00\u59cb\u200b\uff0c\u200b\u5bf9\u4e8e\u200b\u6bcf\u200b\u4e00\u884c\u200b\uff0cNTILE\u200b\u8fd4\u56de\u200b\u6b64\u884c\u200b\u6240\u5c5e\u200b\u7684\u200b\u7ec4\u200b\u7684\u200b\u7f16\u53f7\u200b\u3002\uff08\u200b\u7528\u4e8e\u200b\u5c06\u200b\u5206\u7ec4\u200b\u6570\u636e\u200b\u6309\u7167\u200b\u987a\u5e8f\u200b\u5207\u200b\u5206\u6210\u200bn\u200b\u7247\u200b\uff0c\u200b\u8fd4\u56de\u200b\u5f53\u524d\u200b\u5207\u7247\u200b\u503c\u200b\uff09</p> <p>SQL\u200b\u6848\u4f8b\u200b\uff1a\u200b\u67e5\u8be2\u200b\u524d\u200b25%\u200b\u65f6\u95f4\u200b\u7684\u200b\u8ba2\u5355\u200b\u4fe1\u606f\u200b</p> <pre><code>select * from (\n    select User_id,pay_time,money,\n\n    ntile(4) over(order by pay_time) sorted\n\n    from or_order\n) t\nwhere sorted = 1;\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#4by","title":"4\u200b\u4e2a\u200bBy","text":"<p>\uff081\uff09Order By</p> <p>\u200b\u5168\u5c40\u200b\u6392\u5e8f\u200b\uff0c\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200bReducer\u3002</p> <p>\uff082\uff09Sort By</p> <p>\u200b\u5206\u200b\u533a\u5185\u200b\u6709\u5e8f\u200b\u3002</p> <p>\uff083\uff09Distrbute By</p> <p>\u200b\u7c7b\u4f3c\u200bMR\u200b\u4e2d\u200bPartition\uff0c\u200b\u8fdb\u884c\u200b\u5206\u533a\u200b\uff0c\u200b\u7ed3\u5408\u200bsort by\u200b\u4f7f\u7528\u200b\u3002</p> <p>\uff084\uff09 Cluster By</p> <p>\u200b\u5f53\u200bDistribute by\u200b\u548c\u200bSorts by\u200b\u5b57\u200b\u6bb5\u200b\u76f8\u540c\u200b\u65f6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200bCluster by\u200b\u65b9\u5f0f\u200b\u3002Cluster by\u200b\u9664\u4e86\u200b\u5177\u6709\u200bDistribute by\u200b\u7684\u200b\u529f\u80fd\u200b\u5916\u200b\u8fd8\u200b\u517c\u5177\u200bSort by\u200b\u7684\u200b\u529f\u80fd\u200b\u3002\u200b\u4f46\u662f\u200b\u6392\u5e8f\u200b\u53ea\u80fd\u200b\u662f\u200b\u5347\u5e8f\u200b\u6392\u5e8f\u200b\uff0c\u200b\u4e0d\u80fd\u200b\u6307\u5b9a\u200b\u6392\u5e8f\u200b\u89c4\u5219\u200b\u4e3a\u200bASC\u200b\u6216\u8005\u200bDESC\u3002</p> <p>\u200b\u5728\u200b\u751f\u4ea7\u200b\u73af\u5883\u200b\u4e2d\u200bOrder By\u200b\u7528\u200b\u7684\u200b\u6bd4\u8f83\u200b\u5c11\u200b\uff0c\u200b\u5bb9\u6613\u200b\u5bfc\u81f4\u200bOOM\u3002</p> <p>\u200b\u5728\u200b\u751f\u4ea7\u200b\u73af\u5883\u200b\u4e2d\u200bSort By+ Distrbute By\u200b\u7528\u200b\u7684\u200b\u591a\u200b\u3002</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_23","title":"\u6392\u5e8f\u200b\u51fd\u6570","text":"<p>\uff081\uff09RANK() </p> <p>\u200b\u6392\u5e8f\u200b\u76f8\u540c\u200b\u65f6\u4f1a\u200b\u91cd\u590d\u200b\uff0c\u200b\u603b\u6570\u200b\u4e0d\u4f1a\u200b\u53d8\u200b <pre><code>1\n1\n3\n3\n5\n</code></pre> \uff082\uff09DENSE_RANK() </p> <p>\u200b\u6392\u5e8f\u200b\u76f8\u540c\u200b\u65f6\u4f1a\u200b\u91cd\u590d\u200b\uff0c\u200b\u603b\u6570\u200b\u4f1a\u200b\u51cf\u5c11\u200b <pre><code>1\n1\n2\n2\n3\n</code></pre> \uff083\uff09ROW_NUMBER()</p> <p>\u200b\u4f1a\u200b\u6839\u636e\u200b\u987a\u5e8f\u200b\u8ba1\u7b97\u200b <pre><code>1\n2\n3\n4\n5\n</code></pre></p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_24","title":"\u65e5\u671f\u200b\u51fd\u6570","text":"<p>datediff\uff1a\u200b\u8fd4\u56de\u200b\u7ed3\u675f\u200b\u65e5\u671f\u200b\u51cf\u53bb\u200b\u5f00\u59cb\u200b\u65e5\u671f\u200b\u7684\u200b\u5929\u6570\u200b <pre><code>datediff(string enddate, string startdate) \n\nselect datediff('2021-11-20','2021-11-22') \n</code></pre></p> <p>date_add\uff1a\u200b\u8fd4\u56de\u200b\u5f00\u59cb\u200b\u65e5\u671f\u200bstartdate\u200b\u589e\u52a0\u200bdays\u200b\u5929\u540e\u200b\u7684\u200b\u65e5\u671f\u200b <pre><code>date_add(string startdate, int days) \n\nselect date_add('2021-11-20',3) \n</code></pre> date_sub\uff1a\u200b\u8fd4\u56de\u200b\u5f00\u59cb\u200b\u65e5\u671f\u200bstartdate\u200b\u51cf\u5c11\u200bdays\u200b\u5929\u540e\u200b\u7684\u200b\u65e5\u671f\u200b</p> <pre><code>date_sub (string startdate, int days) \n\nselect date_sub('2021-11-22',3)\n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#redis","title":"Redis","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_25","title":"\u542f\u52a8\u200b\u7c7b","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#key","title":"key","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b keys  * \u200b\u67e5\u770b\u200b\u5f53\u524d\u200b\u5e93\u200b\u7684\u200b\u6240\u6709\u200b\u952e\u200b exists  \u200b\u5224\u65ad\u200b\u67d0\u4e2a\u200b\u952e\u200b\u662f\u5426\u200b\u5b58\u5728\u200b type  \u200b\u67e5\u770b\u200b\u952e\u200b\u7684\u200b\u7c7b\u578b\u200b del  \u200b\u5220\u9664\u200b\u67d0\u4e2a\u200b\u952e\u200b expire  \u200b\u4e3a\u200b\u952e\u503c\u200b\u8bbe\u7f6e\u200b\u8fc7\u671f\u200b\u65f6\u95f4\u200b\uff0c\u200b\u5355\u4f4d\u200b\u79d2\u200b ttl  \u200b\u67e5\u770b\u200b\u8fd8\u6709\u200b\u591a\u4e45\u200b\u8fc7\u671f\u200b,-1\u200b\u8868\u793a\u200b\u6c38\u4e0d\u200b\u8fc7\u671f\u200b,-2\u200b\u8868\u793a\u200b\u5df2\u8fc7\u671f\u200b dbsize \u200b\u67e5\u770b\u200b\u5f53\u524d\u200b\u6570\u636e\u5e93\u200b\u4e2d\u200bkey\u200b\u7684\u200b\u6570\u91cf\u200b flushdb \u200b\u6e05\u7a7a\u200b\u5f53\u524d\u200b\u5e93\u200b Flushall \u200b\u901a\u6740\u200b\u5168\u90e8\u200b\u5e93"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#string","title":"String","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b get  \u200b\u67e5\u8be2\u200b\u5bf9\u5e94\u200b\u952e\u503c\u200b set  \u200b\u6dfb\u52a0\u200b\u952e\u503c\u200b\u5bf9\u200b append  \u200b\u5c06\u200b\u7ed9\u5b9a\u200b\u7684\u200b\u8ffd\u52a0\u200b\u5230\u200b\u539f\u503c\u200b\u7684\u200b\u672b\u5c3e\u200b strlen  \u200b\u83b7\u53d6\u200b\u503c\u200b\u7684\u200b\u957f\u5ea6\u200b setnx  \u200b\u53ea\u6709\u200b\u5728\u200bkey \u200b\u4e0d\u200b\u5b58\u5728\u200b\u65f6\u200b\u8bbe\u7f6e\u200bkey\u200b\u7684\u200b\u503c\u200b incr  \u200b\u5c06\u200bkey\u200b\u4e2d\u200b\u5b58\u50a8\u200b\u7684\u200b\u6570\u5b57\u200b\u503c\u589e\u200b1\u200b\u53ea\u80fd\u200b\u5bf9\u200b\u6570\u5b57\u200b\u503c\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u5982\u679c\u200b\u4e3a\u7a7a\u200b\uff0c\u200b\u65b0\u200b\u589e\u503c\u200b\u4e3a\u200b1 decr  \u200b\u5c06\u200bkey\u200b\u4e2d\u200b\u5b58\u50a8\u200b\u7684\u200b\u6570\u5b57\u200b\u503c\u51cf\u200b1\u200b\u53ea\u80fd\u200b\u5bf9\u200b\u6570\u5b57\u200b\u4e4b\u200b\u64cd\u4f5c\u200b\uff0c\u200b\u5982\u679c\u200b\u4e3a\u7a7a\u200b,\u200b\u65b0\u200b\u589e\u503c\u200b\u4e3a\u200b-1 incrby /decrby  \u200b\u6b65\u957f\u200b \u200b\u5c06\u200bkey\u200b\u4e2d\u200b\u5b58\u50a8\u200b\u7684\u200b\u6570\u5b57\u200b\u503c\u200b\u589e\u51cf\u200b\uff0c\u200b\u81ea\u5b9a\u4e49\u200b\u6b65\u957f\u200b mset  \u200b\u540c\u65f6\u200b\u8bbe\u7f6e\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200bkey-value\u200b\u5bf9\u200b mget  \u200b\u540c\u65f6\u200b\u83b7\u53d6\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200bvalue msetnx  \u200b\u540c\u65f6\u200b\u8bbe\u7f6e\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200bkey-value\u200b\u5bf9\u200b\uff0c\u200b\u5f53\u4e14\u200b\u4ec5\u200b\u5f53\u200b\u6240\u6709\u200b\u7ed9\u5b9a\u200b\u7684\u200bkey\u200b\u90fd\u200b\u4e0d\u200b\u5b58\u5728\u200b getrange  &lt;\u200b\u8d77\u59cb\u200b\u4f4d\u7f6e\u200b&gt; &lt;\u200b\u7ed3\u675f\u200b\u4f4d\u7f6e\u200b&gt; \u200b\u83b7\u5f97\u200b\u503c\u200b\u7684\u200b\u8303\u56f4\u200b,\u200b\u7c7b\u4f3c\u200bjava\u200b\u4e2d\u200b\u7684\u200bsubstring setrange  &lt;\u200b\u8d77\u59cb\u200b\u4f4d\u7f6e\u200b&gt;  \u200b\u7528\u200b\u8986\u76d6\u200b\u6240\u200b\u5b58\u50a8\u200b\u7684\u200b\u5b57\u7b26\u4e32\u200b\u503c\u200b\uff0c\u200b\u4ece\u200b&lt;\u200b\u8d77\u59cb\u200b\u4f4d\u7f6e\u200b&gt;\u200b\u5f00\u59cb\u200b setex  &lt;\u200b\u8fc7\u671f\u200b\u65f6\u95f4\u200b&gt;  \u200b\u8bbe\u7f6e\u200b\u952e\u503c\u200b\u7684\u200b\u540c\u65f6\u200b\uff0c\u200b\u8bbe\u7f6e\u200b\u8fc7\u53bb\u200b\u65f6\u95f4\u200b\uff0c\u200b\u5355\u4f4d\u200b\u79d2\u200b getset  \u200b\u4ee5\u65b0\u6362\u200b\u65e7\u200b,\u200b\u8bbe\u7f6e\u200b\u4e86\u200b\u65b0\u503c\u200b\u7684\u200b\u540c\u65f6\u200b\u83b7\u53d6\u200b\u65e7\u503c"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#list","title":"List","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b lpush/rpush   \u200b\u4ece\u200b\u5de6\u8fb9\u200b/\u200b\u53f3\u8fb9\u200b\u63d2\u5165\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b\u503c\u200b\u3002 lpop/rpop   \u200b\u4ece\u200b\u5de6\u8fb9\u200b/\u200b\u53f3\u8fb9\u200b\u5410\u200b\u51fa\u200b\u4e00\u4e2a\u200b\u503c\u200b\u3002\u200b\u503c\u200b\u5728\u200b\u952e\u200b\u5728\u200b\uff0c\u200b\u503c\u5149\u952e\u4ea1\u200b\u3002 rpoplpush   \u200b\u4ece\u200b\u5217\u8868\u200b\u53f3\u8fb9\u200b\u5410\u200b\u51fa\u200b\u4e00\u4e2a\u200b\u503c\u200b\uff0c\u200b\u63d2\u200b\u5230\u200b\u5217\u8868\u200b\u5de6\u8fb9\u200b lrange  \u200b\u6309\u7167\u200b\u7d22\u5f15\u200b\u4e0b\u6807\u200b\u83b7\u5f97\u200b\u5143\u7d20\u200b(\u200b\u4ece\u5de6\u5230\u53f3\u200b) lindex  \u200b\u6309\u7167\u200b\u7d22\u5f15\u200b\u4e0b\u6807\u200b\u83b7\u5f97\u200b\u5143\u7d20\u200b(\u200b\u4ece\u5de6\u5230\u53f3\u200b) llen  \u200b\u83b7\u5f97\u200b\u5217\u8868\u200b\u957f\u5ea6\u200b linsert   before  \u200b\u5728\u200b\u7684\u200b\u540e\u9762\u200b\u63d2\u5165\u200b \u200b\u63d2\u5165\u200b\u503c\u200b lrem  \u200b\u4ece\u200b\u5de6\u8fb9\u200b\u5220\u9664\u200bn\u200b\u4e2a\u200bvalue(\u200b\u4ece\u5de6\u5230\u53f3\u200b)"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#set","title":"Set","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b sadd   .... \u200b\u5c06\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b member \u200b\u5143\u7d20\u200b\u52a0\u5165\u200b\u5230\u200b\u96c6\u5408\u200b key \u200b\u5f53\u4e2d\u200b\uff0c\u200b\u5df2\u7ecf\u200b\u5b58\u5728\u200b\u4e8e\u200b\u96c6\u5408\u200b\u7684\u200b member \u200b\u5143\u7d20\u200b\u5c06\u200b\u88ab\u200b\u5ffd\u7565\u200b\u3002 smembers  \u200b\u53d6\u51fa\u200b\u8be5\u200b\u96c6\u5408\u200b\u7684\u200b\u6240\u6709\u200b\u503c\u200b\u3002 sismember  \u200b\u5224\u65ad\u200b\u96c6\u5408\u200b\u662f\u5426\u200b\u4e3a\u200b\u542b\u6709\u200b\u8be5\u503c\u200b\uff0c\u200b\u6709\u200b\u8fd4\u56de\u200b1\uff0c\u200b\u6ca1\u6709\u200b\u8fd4\u56de\u200b0 scard   \u200b\u8fd4\u56de\u200b\u8be5\u200b\u96c6\u5408\u200b\u7684\u200b\u5143\u7d20\u200b\u4e2a\u6570\u200b\u3002 srem   .... \u200b\u5220\u9664\u200b\u96c6\u5408\u200b\u4e2d\u200b\u7684\u200b\u67d0\u4e2a\u200b\u5143\u7d20\u200b\u3002 spop  \u200b\u968f\u673a\u200b\u4ece\u200b\u8be5\u200b\u96c6\u5408\u200b\u4e2d\u5410\u51fa\u200b\u4e00\u4e2a\u200b\u503c\u200b\u3002 srandmember  \u200b\u968f\u673a\u200b\u4ece\u200b\u8be5\u200b\u96c6\u5408\u200b\u4e2d\u200b\u53d6\u51fa\u200bn\u200b\u4e2a\u503c\u200b\u3002\u200b\u4e0d\u4f1a\u200b\u4ece\u200b\u96c6\u5408\u200b\u4e2d\u200b\u5220\u9664\u200b sinter  \u200b\u8fd4\u56de\u200b\u4e24\u4e2a\u200b\u96c6\u5408\u200b\u7684\u200b\u4ea4\u96c6\u200b\u5143\u7d20\u200b\u3002 sunion  \u200b\u8fd4\u56de\u200b\u4e24\u4e2a\u200b\u96c6\u5408\u200b\u7684\u200b\u5e76\u200b\u96c6\u200b\u5143\u7d20\u200b\u3002 sdiff  \u200b\u8fd4\u56de\u200b\u4e24\u4e2a\u200b\u96c6\u5408\u200b\u7684\u200b\u5dee\u96c6\u200b\u5143\u7d20\u200b\u3002"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#hash","title":"Hash","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b hset  \u200b\u7ed9\u200b\u96c6\u5408\u200b\u4e2d\u200b\u7684\u200b  \u200b\u952e\u200b\u8d4b\u503c\u200b hget  \u200b\u4ece\u200b\u96c6\u5408\u200b \u200b\u53d6\u51fa\u200b value hmset  ... \u200b\u6279\u91cf\u200b\u8bbe\u7f6e\u200bhash\u200b\u7684\u200b\u503c\u200b hexists key   \u200b\u67e5\u770b\u200b\u54c8\u5e0c\u200b\u8868\u200b key \u200b\u4e2d\u200b\uff0c\u200b\u7ed9\u5b9a\u200b\u57df\u200b field \u200b\u662f\u5426\u200b\u5b58\u5728\u200b\u3002 hkeys  \u200b\u5217\u51fa\u200b\u8be5\u200bhash\u200b\u96c6\u5408\u200b\u7684\u200b\u6240\u6709\u200bfield hvals  \u200b\u5217\u51fa\u200b\u8be5\u200bhash\u200b\u96c6\u5408\u200b\u7684\u200b\u6240\u6709\u200bvalue hincrby  \u200b\u4e3a\u200b\u54c8\u5e0c\u200b\u8868\u200b key \u200b\u4e2d\u200b\u7684\u200b\u57df\u200b field \u200b\u7684\u200b\u503c\u200b\u52a0\u4e0a\u200b\u589e\u91cf\u200b increment hsetnx  \u200b\u5c06\u200b\u54c8\u5e0c\u200b\u8868\u200b key \u200b\u4e2d\u200b\u7684\u200b\u57df\u200b field \u200b\u7684\u200b\u503c\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b value \uff0c\u200b\u5f53\u4e14\u200b\u4ec5\u200b\u5f53\u57df\u200b field \u200b\u4e0d\u200b\u5b58\u5728"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#zsetsorted-set","title":"zset(Sorted set)","text":"\u547d\u4ee4\u200b \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b zadd   ... \u200b\u5c06\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b member \u200b\u5143\u7d20\u200b\u53ca\u5176\u200b score \u200b\u503c\u200b\u52a0\u5165\u200b\u5230\u200b\u6709\u5e8f\u200b\u96c6\u200b key \u200b\u5f53\u4e2d\u200b zrange    [WITHSCORES] \u200b\u8fd4\u56de\u200b\u6709\u5e8f\u200b\u96c6\u200b key \u200b\u4e2d\u200b\uff0c\u200b\u4e0b\u6807\u200b\u5728\u200b \u200b\u4e4b\u95f4\u200b\u7684\u200b\u5143\u7d20\u200b\u5e26\u200bWITHSCORES\uff0c\u200b\u53ef\u4ee5\u200b\u8ba9\u200b\u5206\u6570\u200b\u4e00\u8d77\u200b\u548c\u200b\u503c\u200b\u8fd4\u56de\u200b\u5230\u200b\u7ed3\u679c\u200b\u96c6\u200b\u3002 zrangebyscore key min max [withscores] [limit offset count] \u200b\u8fd4\u56de\u200b\u6709\u5e8f\u200b\u96c6\u200b key \u200b\u4e2d\u200b\uff0c\u200b\u6240\u6709\u200b score \u200b\u503c\u200b\u4ecb\u4e8e\u200b min \u200b\u548c\u200b max \u200b\u4e4b\u95f4\u200b(\u200b\u5305\u62ec\u200b\u7b49\u4e8e\u200b min \u200b\u6216\u200b max )\u200b\u7684\u200b\u6210\u5458\u200b\u3002\u200b\u6709\u5e8f\u200b\u96c6\u200b\u6210\u5458\u200b\u6309\u200b score \u200b\u503c\u200b\u9012\u589e\u200b(\u200b\u4ece\u5c0f\u5230\u5927\u200b)\u200b\u6b21\u5e8f\u200b\u6392\u5217\u200b\u3002 zrevrangebyscore key max min [withscores] [limit offset count] \u200b\u540c\u200b\u4e0a\u200b\uff0c\u200b\u6539\u4e3a\u200b\u4ece\u5927\u5230\u200b\u5c0f\u200b\u6392\u5217\u200b\u3002 zincrby  \u200b\u4e3a\u200b\u5143\u7d20\u200b\u7684\u200bscore\u200b\u52a0\u4e0a\u200b\u589e\u91cf\u200b zrem   \u200b\u5220\u9664\u200b\u8be5\u200b\u96c6\u5408\u200b\u4e0b\u200b\uff0c\u200b\u6307\u5b9a\u200b\u503c\u200b\u7684\u200b\u5143\u7d20\u200b zcount  \u200b\u7edf\u8ba1\u200b\u8be5\u200b\u96c6\u5408\u200b\uff0c\u200b\u5206\u6570\u200b\u533a\u95f4\u200b\u5185\u200b\u7684\u200b\u5143\u7d20\u200b\u4e2a\u6570\u200b zrank  \u200b\u8fd4\u56de\u200b\u8be5\u503c\u200b\u5728\u200b\u96c6\u5408\u200b\u4e2d\u200b\u7684\u200b\u6392\u540d\u200b\uff0c\u200b\u4ece\u200b0\u200b\u5f00\u59cb\u200b\u3002"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#flink","title":"Flink","text":""},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#_26","title":"\u542f\u52a8","text":"<pre><code>./start-cluster.sh \n</code></pre>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#run","title":"run","text":"<pre><code>./bin/flink run [OPTIONS]\n\n./bin/flink run -m yarn-cluster -c com.wang.flink.WordCount /opt/app/WordCount.jar\n</code></pre> OPTIONS \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b -d detached \u200b\u662f\u5426\u200b\u4f7f\u7528\u200b\u5206\u79bb\u200b\u6a21\u5f0f\u200b -m jobmanager \u200b\u6307\u5b9a\u200b\u63d0\u4ea4\u200b\u7684\u200bjobmanager -yat \u2013yarnapplicationType \u200b\u8bbe\u7f6e\u200byarn\u200b\u5e94\u7528\u200b\u7684\u200b\u7c7b\u578b\u200b -yD \u200b\u4f7f\u7528\u200b\u7ed9\u5b9a\u200b\u5c5e\u6027\u200b\u7684\u200b\u503c\u200b -yd \u2013yarndetached \u200b\u4f7f\u7528\u200byarn\u200b\u5206\u79bb\u200b\u6a21\u5f0f\u200b -yh \u2013yarnhelp yarn session\u200b\u7684\u200b\u5e2e\u52a9\u200b -yid \u2013yarnapplicationId \u200b\u6302\u5230\u200b\u6b63\u5728\u200b\u8fd0\u884c\u200b\u7684\u200byarnsession\u200b\u4e0a\u200b -yj \u2013yarnjar Flink jar\u200b\u6587\u4ef6\u200b\u7684\u200b\u8def\u5f84\u200b -yjm \u2013yarnjobManagerMemory jobmanager\u200b\u7684\u200b\u5185\u5b58\u200b(\u200b\u5355\u4f4d\u200bM) -ynl \u2013yarnnodeLabel \u200b\u6307\u5b9a\u200b YARN \u200b\u5e94\u7528\u7a0b\u5e8f\u200b YARN \u200b\u8282\u70b9\u200b\u6807\u7b7e\u200b -ynm \u2013yarnname \u200b\u81ea\u5b9a\u4e49\u200byarn\u200b\u5e94\u7528\u200b\u540d\u79f0\u200b -yq \u2013yarnquery \u200b\u663e\u793a\u200byarn\u200b\u7684\u200b\u53ef\u7528\u200b\u8d44\u6e90\u200b -yqu \u2013yarnqueue \u200b\u6307\u5b9a\u200byarn\u200b\u961f\u5217\u200b -ys \u2013yarnslots \u200b\u6307\u5b9a\u200b\u6bcf\u4e2a\u200btaskmanager\u200b\u7684\u200bslots\u200b\u6570\u200b -yt yarnship \u200b\u5728\u200b\u6307\u5b9a\u200b\u76ee\u5f55\u200b\u4e2d\u200b\u4f20\u8f93\u200b\u6587\u4ef6\u200b -ytm \u2013yarntaskManagerMemory \u200b\u6bcf\u4e2a\u200btaskmanager\u200b\u7684\u200b\u5185\u5b58\u200b -yz \u2013yarnzookeeperNamespace \u200b\u7528\u6765\u200b\u521b\u5efa\u200bha\u200b\u7684\u200bzk\u200b\u5b50\u200b\u8def\u5f84\u200b\u7684\u200b\u547d\u540d\u200b\u7a7a\u95f4\u200b -z \u2013zookeeperNamespace \u200b\u7528\u6765\u200b\u521b\u5efa\u200bha\u200b\u7684\u200bzk\u200b\u5b50\u200b\u8def\u5f84\u200b\u7684\u200b\u547d\u540d\u200b\u7a7a\u95f4\u200b -p \u200b\u5e76\u884c\u5ea6\u200b -yn \u200b\u9700\u8981\u200b\u5206\u914d\u200b\u7684\u200bYARN\u200b\u5bb9\u5668\u200b\u4e2a\u6570\u200b(=\u200b\u4efb\u52a1\u200b\u7ba1\u7406\u5668\u200b\u7684\u200b\u6570\u91cf\u200b)"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#info","title":"info","text":"<p><pre><code>./bin/flink info [OPTIONS]\n</code></pre> | OPTIONS | \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b         | | ------- | ---------------- | | -c      | \u200b\u7a0b\u5e8f\u200b\u8fdb\u5165\u200b\u70b9\u200b\uff0c\u200b\u4e3b\u7c7b\u200b | | -p      | \u200b\u5e76\u884c\u5ea6\u200b           |</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#list_1","title":"list","text":"<p><pre><code>./bin/flink list [OPTIONS]\n</code></pre> | OPTIONS | \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b                                                 | | ------- | -------------------------------------------------------- | | -a      | \u2013all \u200b\u663e\u793a\u200b\u6240\u6709\u200b\u5e94\u7528\u200b\u548c\u200b\u5bf9\u5e94\u200b\u7684\u200bjob id                          | | -r      | \u2013running \u200b\u663e\u793a\u200b\u6b63\u5728\u200b\u8fd0\u884c\u200b\u7684\u200b\u5e94\u7528\u200b\u548c\u200bjob id                      | | -s      | \u2013scheduled \u200b\u663e\u793a\u200b\u8c03\u5ea6\u200b\u7684\u200b\u5e94\u7528\u200b\u548c\u200bjob id                        | | -m      | \u2013jobmanager \u200b\u6307\u5b9a\u200b\u8fde\u63a5\u200b\u7684\u200bjobmanager                         | | -yid    | \u2013yarnapplicationId \u200b\u6302\u5230\u200b\u6307\u5b9a\u200b\u7684\u200byarn id\u200b\u5bf9\u5e94\u200b\u7684\u200byarn session\u200b\u4e0a\u200b | | -z      | \u2013zookeeperNamespace \u200b\u7528\u6765\u200b\u521b\u5efa\u200bha\u200b\u7684\u200bzk\u200b\u5b50\u200b\u8def\u5f84\u200b\u7684\u200b\u547d\u540d\u200b\u7a7a\u95f4\u200b       |</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#stop","title":"stop","text":"<p><pre><code>./bin/flink stop  [OPTIONS] &lt;Job ID&gt;\n</code></pre> | OPTIONS | \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b                                                 | | ------- | -------------------------------------------------------- | | -d      | \u200b\u5728\u200b\u91c7\u53d6\u200b\u4fdd\u5b58\u200b\u70b9\u200b\u548c\u200b\u505c\u6b62\u200b\u7ba1\u9053\u200b\u4e4b\u524d\u200b\uff0c\u200b\u53d1\u9001\u200bMAX_WATERMARK            | | -p      | savepointPath \u200b\u4fdd\u5b58\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b 'xxxxx'                       | | -m      | \u2013jobmanager \u200b\u6307\u5b9a\u200b\u8fde\u63a5\u200b\u7684\u200bjobmanager                         | | -yid    | \u2013yarnapplicationId \u200b\u6302\u5230\u200b\u6307\u5b9a\u200b\u7684\u200byarn id\u200b\u5bf9\u5e94\u200b\u7684\u200byarn session\u200b\u4e0a\u200b | | -z      | \u2013zookeeperNamespace \u200b\u7528\u6765\u200b\u521b\u5efa\u200bha\u200b\u7684\u200bzk\u200b\u5b50\u200b\u8def\u5f84\u200b\u7684\u200b\u547d\u540d\u200b\u7a7a\u95f4\u200b       |</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#cancel","title":"cancel(\u200b\u5f31\u5316\u200b)","text":"<p><pre><code>./bin/flink cancel  [OPTIONS] &lt;Job ID&gt;\n</code></pre> | OPTIONS | \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b                                                 | | ------- | -------------------------------------------------------- | | -s      | \u200b\u4f7f\u7528\u200b \"stop \"\u200b\u4ee3\u66ff\u200b                                         | | -D      | \u200b\u5141\u8bb8\u200b\u6307\u5b9a\u200b\u591a\u4e2a\u200b\u901a\u7528\u200b\u914d\u7f6e\u200b\u9009\u9879\u200b                                 | | -m      | \u200b\u8981\u200b\u8fde\u63a5\u200b\u7684\u200bJobManager\u200b\u7684\u200b\u5730\u5740\u200b                                 | | -yid    | \u2013yarnapplicationId \u200b\u6302\u5230\u200b\u6307\u5b9a\u200b\u7684\u200byarn id\u200b\u5bf9\u5e94\u200b\u7684\u200byarn session\u200b\u4e0a\u200b | | -z      | \u2013zookeeperNamespace \u200b\u7528\u6765\u200b\u521b\u5efa\u200bha\u200b\u7684\u200bzk\u200b\u5b50\u200b\u8def\u5f84\u200b\u7684\u200b\u547d\u540d\u200b\u7a7a\u95f4\u200b       |</p>"},{"location":"bigdata/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A1%86%E6%9E%B6%E5%91%BD%E4%BB%A4/#savepoint","title":"savepoint","text":"<p><pre><code>./bin/flink savepoint  [OPTIONS] &lt;Job ID&gt;\n</code></pre> | OPTIONS | \u200b\u529f\u80fd\u200b\u8bf4\u660e\u200b                                                 | | ------- | -------------------------------------------------------- | | -d      | \u200b\u8981\u200b\u5904\u7406\u200b\u7684\u200b\u4fdd\u5b58\u200b\u70b9\u200b\u7684\u200b\u8def\u5f84\u200b                                     | | -j      | Flink\u200b\u7a0b\u5e8f\u200b\u7684\u200bJAR\u200b\u6587\u4ef6\u200b                                       | | -m      | \u200b\u8981\u200b\u8fde\u63a5\u200b\u7684\u200bJobManager\u200b\u7684\u200b\u5730\u5740\u200b                                 | | -yid    | \u2013yarnapplicationId \u200b\u6302\u5230\u200b\u6307\u5b9a\u200b\u7684\u200byarn id\u200b\u5bf9\u5e94\u200b\u7684\u200byarn session\u200b\u4e0a\u200b | | -z      | \u2013zookeeperNamespace \u200b\u7528\u6765\u200b\u521b\u5efa\u200bha\u200b\u7684\u200bzk\u200b\u5b50\u200b\u8def\u5f84\u200b\u7684\u200b\u547d\u540d\u200b\u7a7a\u95f4\u200b       |</p>"},{"location":"bigdata/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/","title":"\u6570\u636e\u6316\u6398","text":""},{"location":"bigdata/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/#_1","title":"\u6570\u636e\u6316\u6398","text":""},{"location":"bigdata/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/#knn","title":"KNN\u200b\u7b97\u6cd5\u200b\u6d41\u7a0b","text":"<p>\u200b\u4e0b\u9762\u200b\u5bf9\u200b KNN \u200b\u7b97\u6cd5\u200b\u7684\u200b\u6d41\u7a0b\u200b\u505a\u200b\u7b80\u5355\u200b\u4ecb\u7ecd\u200b\u3002KNN \u200b\u5206\u7c7b\u200b\u7b97\u6cd5\u200b\u4e3b\u8981\u200b\u5305\u62ec\u200b\u4ee5\u4e0b\u200b 4 \u200b\u4e2a\u200b\u6b65\u9aa4\u200b\uff1a</p> <ul> <li>\u200b\u51c6\u5907\u200b\u6570\u636e\u200b\uff0c\u200b\u5bf9\u200b\u6570\u636e\u200b\u8fdb\u884c\u200b\u9884\u5904\u7406\u200b \u3002</li> <li>\u200b\u8ba1\u7b97\u200b\u6d4b\u8bd5\u200b\u6837\u672c\u200b\u70b9\u200b\uff08\u200b\u4e5f\u200b\u5c31\u662f\u200b\u5f85\u200b\u5206\u7c7b\u200b\u70b9\u200b\uff09\u200b\u5230\u200b\u5176\u4ed6\u200b\u6bcf\u4e2a\u200b\u6837\u672c\u200b\u70b9\u200b\u7684\u200b\u8ddd\u79bb\u200b\uff08\u200b\u9009\u5b9a\u200b\u5ea6\u91cf\u200b\u8ddd\u79bb\u200b\u7684\u200b\u65b9\u6cd5\u200b\uff09\u3002</li> <li>\u200b\u5bf9\u200b\u6bcf\u4e2a\u200b\u8ddd\u79bb\u200b\u8fdb\u884c\u200b\u6392\u5e8f\u200b\uff0c\u200b\u7136\u540e\u200b\u9009\u62e9\u200b\u51fa\u200b\u8ddd\u79bb\u200b\u6700\u5c0f\u200b\u7684\u200b K \u200b\u4e2a\u70b9\u200b\u3002</li> <li>\u200b\u5bf9\u200b K \u200b\u4e2a\u70b9\u200b\u6240\u5c5e\u200b\u7684\u200b\u7c7b\u522b\u200b\u8fdb\u884c\u200b\u6bd4\u8f83\u200b\uff0c\u200b\u6309\u7167\u200b\u5c11\u6570\u200b\u670d\u4ece\u200b\u591a\u6570\u200b\u7684\u200b\u539f\u5219\u200b\uff08\u200b\u591a\u6570\u200b\u8868\u51b3\u200b\u601d\u60f3\u200b\uff09\uff0c\u200b\u5c06\u200b\u6d4b\u8bd5\u200b\u6837\u672c\u200b\u70b9\u200b\u5f52\u5165\u200b\u5230\u200b K \u200b\u4e2a\u200b\u70b9\u4e2d\u200b\u5360\u200b\u6bd4\u200b\u6700\u9ad8\u200b\u7684\u200b\u4e00\u7c7b\u200b\u4e2d\u200b\u3002</li> </ul> <p></p> <p></p>"},{"location":"bigdata/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/#_2","title":"\u5e38\u89c1\u200b\u5206\u7c7b\u200b\u7b97\u6cd5\u200b\uff1a","text":"<p>KNN</p> <p>\u200b\u51b3\u7b56\u6811\u200b</p> <p>\u200b\u795e\u7ecf\u7f51\u7edc\u200b</p> <p>\u200b\u652f\u6301\u200b\u5411\u91cf\u200b\u673a\u200b</p> <p>\u200b\u5e38\u89c1\u200b\u805a\u7c7b\u200b\u7b97\u200b\uff1a</p> <p>K-Means</p>"},{"location":"bigdata/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/#_3","title":"\u6570\u636e\u6316\u6398\u200b\u7684\u200b\u6b65\u9aa4\u200b\uff1a","text":"<p>(1) \u200b\u786e\u5b9a\u200b\u4e1a\u52a1\u200b\u5bf9\u8c61\u200b</p> <p>(2) \u200b\u6570\u636e\u200b\u51c6\u5907\u200b/\u200b\u6570\u636e\u200b\u96c6\u6210\u200b</p> <p>(3) \u200b\u6570\u636e\u200b\u9884\u5904\u7406\u200b/\u200b\u6e05\u6d17\u200b</p> <p>(4) \u200b\u5efa\u7acb\u200b\u6a21\u578b\u200b/\u200b\u9009\u62e9\u200b\u6a21\u578b\u200b\uff0c\uff08\u200b\u635f\u5931\u200b\u51fd\u6570\u200b\u4f18\u5316\u200b\u5668\u200b\uff09</p> <p>(5) \u200b\u8bc4\u4ef7\u200b\u6a21\u578b\u200b/\u200b\u8c03\u4f18\u200b\uff0c\u200b\u65b9\u5411\u200b\u4f20\u64ad\u200b</p> <p>(6) \u200b\u77e5\u8bc6\u200b\u8fd0\u7528\u200b/\u200b\u4e1a\u52a1\u200b\u5e94\u7528\u200b</p>"},{"location":"bigdata/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8D%87%E7%BA%A7/","title":"hadoop\u200b\u5347\u7ea7","text":"<p>\u200b\u8bb0\u5f55\u200b\u4e00\u4e0b\u200b\u670d\u52a1\u5668\u200b\u5347\u7ea7\u200b\u914d\u7f6e\u200b,hadoop\u200b\u542f\u505c\u200b\u7684\u200b\u64cd\u4f5c\u200b\u3002</p>"},{"location":"bigdata/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8D%87%E7%BA%A7/#1hadoop","title":"1\u3001hadoop\u200b\u96c6\u7fa4","text":"<p>worker01\u3001worker02\u3001worker03\u200b\u5347\u7ea7\u200b</p> <pre><code># \u200b\u91cd\u542f\u200bHadoop\n# \u200b\u505c\u6b62\u200b\n./zkServer.sh stop # \nsbin/stop-dfs.sh #df\u200b\u7684\u200bmaster\u200b\u6267\u884c\u200b\nsbin/stop-yarn.sh #yarn\u200b\u7684\u200bmaster\u200b\u6267\u884c\u200b\n# \u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\u5df2\u7ecf\u200b\u5305\u542b\u200b\u5728\u200bstop-dfs.sh\u200b\u4e2d\u200b\uff0c\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\u505c\u6b62\u200b\u5219\u200b\u5355\u72ec\u200b\u6267\u884c\u200b\nhdfs --daemon stop zkfc \nhdfs --daemon stop journalnode  \nps -ef|grep node_exporter\nkill -9 $xx\n\njps #\u200b\u68c0\u67e5\u200bHadoop\u200b\u96c6\u7fa4\u200b\u7684\u200b\u72b6\u6001\u200b\n\n# \u200b\u542f\u52a8\u200b\n./zkServer.sh start    \nsbin/start-dfs.sh \nsbin/start-yarn.sh \n# \u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\u5df2\u7ecf\u200b\u5305\u542b\u200b\u5728\u200bstart-dfs.sh\u200b\u4e2d\u200b\uff0c\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\u505c\u6b62\u200b\u5219\u200b\u5355\u72ec\u200b\u6267\u884c\u200b\nhdfs --daemon start zkfc \nhdfs --daemon start journalnode  \n./node_exporter\n\njps #\u200b\u68c0\u67e5\u200bHadoop\u200b\u96c6\u7fa4\u200b\u7684\u200b\u72b6\u6001\u200b\n</code></pre> <p>2\u3001Dolphin</p> <pre><code># \u200b\u542f\u505c\u200b Master\nbash ./bin/dolphinscheduler-daemon.sh stop master-server\nbash ./bin/dolphinscheduler-daemon.sh start master-server\n\n# \u200b\u542f\u505c\u200b Worker\nbash ./bin/dolphinscheduler-daemon.sh start worker-server\nbash ./bin/dolphinscheduler-daemon.sh stop worker-server\n\n# \u200b\u542f\u505c\u200b Api\nbash ./bin/dolphinscheduler-daemon.sh start api-server\nbash ./bin/dolphinscheduler-daemon.sh stop api-server\n\n# \u200b\u542f\u505c\u200b Alert\nbash ./bin/dolphinscheduler-daemon.sh start alert-server\nbash ./bin/dolphinscheduler-daemon.sh stop alert-server\n</code></pre> <p>3\u3001Clickhouse</p> <pre><code># \u200b\u67e5\u770b\u200bZookeeper\u200b\u547d\u4ee4\u200b\uff1a\nzkServer.sh status\n\n# \u200b\u505c\u6b62\u200b\uff1a\nzkServer.sh stop\nsystemctl status clickhouse-server\nsystemctl stop clickhouse-server\nps -ef | grep chproxy | grep -v grep | awk '{print $2}' | xargs kill -9\nkill -9 $chproxy_pid\n\n\n# \u200b\u542f\u52a8\u200b\nzkServer.sh start\nsystemctl start clickhouse-server\nnohup ./chproxy -config=./config/config.yml &gt;&gt; ./logs/chproxy.out 2&gt;&amp;1 &amp;\n\n\n\n./zkServer.sh start    # \u200b\u9700\u8981\u200b\u5728\u200b\u6bcf\u200b\u4e00\u53f0\u200b\u673a\u5668\u200b\u4e0a\u200b\u6267\u884c\u200b\u6b64\u200b\u547d\u4ee4\u200b\n</code></pre>"},{"location":"blog/","title":"Blog","text":""},{"location":"blog/2023/10/26/%E8%83%96%E8%99%8E%E7%8C%AB/","title":"\u8fd9\u200b\u662f\u200b\u6211\u200b\u7684\u200b\u732b","text":"<p>   \u200b\u5b83\u200b\u7684\u200b\u540d\u5b57\u200b\u53eb\u200b\u80d6\u200b\u864e\u732b\u200b,\u200b\u5c0f\u200b\u540d\u53eb\u200b\u5434\u516d\u200b,\u200b\u53c8\u540d\u200b56,\u200b\u5927\u6982\u200b\u662f\u56e0\u4e3a\u200b\u6211\u59d3\u200b\u5434\u200b,\u200b\u559c\u6b22\u200b\u52a8\u6f2b\u200b\u523a\u5ba2\u200b\u4e94\u200b\u516d\u4e03\u200b\u3002\u200b\u5b83\u200b\u51fa\u200b\u751f\u4e8e\u200b2019\u200b\u5e74\u200b2\u200b\u6708\u200b\uff1f(3\u200b\u6708\u200b1\u200b\u53f7\u200b\u9886\u517b\u200b\u5e26\u56de\u5bb6\u200b\u7684\u200b)\u3002</p> <p>   \u200b\u8fd9\u200b2\u200b\u5f20\u200b\u7167\u7247\u200b\u662f\u200b\u521a\u200b\u9886\u517b\u200b\u65f6\u5019\u200b\u7684\u200b\u7167\u7247\u200b,\u200b\u4e00\u5171\u200b\u6709\u200b3\u200b\u53ea\u200b\u5c0f\u732b\u200b,\u200b\u53e6\u5916\u200b2\u200b\u53ea\u200b\u7ed9\u200b\u4e86\u200b\u522b\u7684\u200b\u540c\u4e8b\u200b\u9886\u517b\u200b,\u200b\u80d6\u200b\u864e\u732b\u200b\u662f\u200b3\u200b\u53ea\u200b\u5c0f\u732b\u200b\u91cc\u9762\u200b\u6700\u5c0f\u200b\u53ea\u200b\u6700\u200b\u5f31\u5c0f\u200b\u7684\u200b,\u200b\u56e0\u4e3a\u200b\u62c5\u5fc3\u200b\u522b\u7684\u200b\u540c\u4e8b\u200b\u517b\u200b\u4e0d\u597d\u200b,\u200b\u6240\u4ee5\u200b\u6211\u200b\u5c31\u200b\u9009\u62e9\u200b\u4e86\u200b\u5b83\u200b\u3002   \u200b\u6709\u7a7a\u200b\u6211\u4f1a\u200b\u5206\u4eab\u200b\u66f4\u200b\u591a\u200b\u7167\u7247\u200b~</p>"},{"location":"blog/2022/05/05/chinese-search-support/","title":"Chinese search support \u2013 \u200b\u4e2d\u6587\u641c\u7d22\u200b\u652f\u6301","text":"<p>Insiders adds experimental Chinese language support for the built-in search plugin \u2013 a feature that has been requested for a long time given the large number of Chinese users.</p> <p>After the United States and Germany, the third-largest country of origin of Material for MkDocs users is China. For a long time, the built-in search plugin didn't allow for proper segmentation of Chinese characters, mainly due to missing support in lunr-languages which is used for search tokenization and stemming. The latest Insiders release adds long-awaited Chinese language support for the built-in search plugin, something that has been requested by many users.</p> <p>Material for MkDocs\u200b\u7d42\u65bc\u200b\u200b\u200b\u652f\u6301\u200b\u200b\u200b\u4e2d\u6587\u200b\u200b\u200b\u4e86\u200b\uff01\u200b\u6587\u672c\u200b\u200b\u200b\u88ab\u200b\u200b\u200b\u6b63\u78ba\u200b\u200b\u200b\u5206\u5272\u200b\u200b\u200b\u4e26\u4e14\u200b\u200b\u200b\u66f4\u200b\u200b\u200b\u5bb9\u6613\u200b\u200b\u200b\u627e\u5230\u200b\u3002</p> <p>This article explains how to set up Chinese language support for the built-in search plugin in a few minutes.</p>"},{"location":"blog/2022/05/05/chinese-search-support/#configuration","title":"Configuration","text":"<p>Chinese language support for Material for MkDocs is provided by jieba, an excellent Chinese text segmentation library. If jieba is installed, the built-in search plugin automatically detects Chinese characters and runs them through the segmenter. You can install jieba with:</p> <pre><code>pip install jieba\n</code></pre> <p>The next step is only required if you specified the <code>separator</code> configuration in <code>mkdocs.yml</code>. Text is segmented with zero-width whitespace characters, so it renders exactly the same in the search modal. Adjust <code>mkdocs.yml</code> so that the <code>separator</code> includes the <code>\\u200b</code> character:</p> <pre><code>plugins:\n  - search:\n      separator: '[\\s\\u200b\\-]'\n</code></pre> <p>That's all that is necessary.</p>"},{"location":"blog/2022/05/05/chinese-search-support/#usage","title":"Usage","text":"<p>If you followed the instructions in the configuration guide, Chinese words will now be tokenized using jieba. Try searching for  \u200b\u652f\u6301\u200b to see how it integrates with the built-in search plugin.</p> <p>Note that this is an experimental feature, and I, @squidfunk, am not proficient in Chinese (yet?). If you find a bug or think something can be improved, please open an issue.</p>"},{"location":"share/recommend/","title":"\u5206\u4eab\u200b\u4e00\u4e9b\u200b\u597d\u7528\u200b\u7684\u200b\u7f51\u7ad9","text":""},{"location":"share/recommend/#ai","title":"AI","text":"<ol> <li>https://chat.openai.com/</li> <li>https://claude.ai/</li> <li>https://www.phind.com/</li> <li>https://app.getmerlin.in/ \u200b\u76ee\u524d\u200b\u6bd4\u8f83\u200b\u597d\u7528\u200b\u7684\u200bLLM\u200b\u4eba\u5de5\u667a\u80fd\u200b\u7f51\u7ad9\u200b</li> </ol>"},{"location":"share/recommend/#ai-draw","title":"AI draw","text":"<ol> <li>https://scribblediffusion.com/</li> </ol>"},{"location":"share/recommend/#draw","title":"draw","text":"<ol> <li>https://app.diagrams.net</li> </ol> <p>\u200b\u5728\u7ebf\u200b\u56fe\u5f62\u200b\u7f16\u8f91\u200b\u5de5\u5177\u200b\uff0c\u200b\u5b83\u200b\u5141\u8bb8\u200b\u7528\u6237\u200b\u521b\u5efa\u200b\u548c\u200b\u7f16\u8f91\u200b\u5404\u79cd\u7c7b\u578b\u200b\u7684\u200b\u56fe\u5f62\u200b\uff0c\u200b\u5982\u200b\u6d41\u7a0b\u56fe\u200b\u3001\u200b\u7ec4\u7ec7\u200b\u7ed3\u6784\u56fe\u200b\u3001\u200b\u7f51\u7edc\u56fe\u200b\u3001\u200b\u601d\u7ef4\u200b\u5bfc\u56fe\u200b\u3001UML\u200b\u56fe\u200b\u7b49\u200b</p>"},{"location":"share/recommend/#icons-or-wallhaven","title":"Icons or wallhaven","text":"<ol> <li>https://www.freepik.com/</li> </ol> <p>\u200b\u63d0\u4f9b\u200b\u4e30\u5bcc\u200b\u7684\u200b\u56fe\u7247\u200b,\u200b\u56fe\u6807\u200b\u6216\u8005\u200b\u58c1\u7eb8\u200b</p>"},{"location":"share/recommend/#itools","title":"itools","text":"<ol> <li>https://developer.aliyun.com/mvn/guide</li> <li>https://sparkbyexamples.com/</li> <li>https://dlcdn.apache.org/</li> <li>https://www.toptal.com/developers/gitignore/</li> <li>https://www.receivesms.io/All/page/1</li> <li>https://www.alipansou.com/</li> <li>https://www.meiguodizhi.com/</li> <li>https://www.suijidaquan.com/credit-card-generator</li> </ol> <p>\u200b\u4e00\u4e9b\u200b\u5f00\u53d1\u200b\u4e2d\u200b\u6709\u65f6\u200b\u4f1a\u200b\u7528\u5230\u200b\u7684\u200b\u5de5\u5177\u200b\u7f51\u7ad9\u200b</p>"},{"location":"share/recommend/#game","title":"game","text":"<ol> <li>https://www.crazygames.com/</li> </ol>"},{"location":"blog/category/cat/","title":"Cat","text":""},{"location":"blog/category/search/","title":"Search","text":""}]}